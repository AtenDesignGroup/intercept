(function(e,t){if('object'==typeof exports&&'object'==typeof module)module.exports=t();else if('function'==typeof define&&define.amd)define([],t);else{var r=t();for(var a in r)('object'==typeof exports?exports:e)[a]=r[a]}})('undefined'==typeof self?this:self,function(){return function(e){function t(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(r,'a',r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=30)}([function(e,t,r){'use strict';var a=r(33);r.d(t,'h',function(){return a.a});var o=r(34);r.d(t,'a',function(){return o.a});var i=r(35),s=r(36);r.d(t,'g',function(){return s.a});var n=r(37);r.d(t,'c',function(){return n.a}),r.d(t,'e',function(){return n.b}),r.d(t,'f',function(){return n.c}),r.d(t,'i',function(){return n.d}),r.d(t,'j',function(){return n.e}),r.d(t,'k',function(){return n.f}),r.d(t,'l',function(){return n.g}),r.d(t,'m',function(){return n.h}),r.d(t,'n',function(){return n.i});var d=r(38);r.d(t,'b',function(){return d.a}),r.d(t,'d',function(){return d.b});var l=r(39);r.d(t,'o',function(){return l.a})},function(e,t,r){'use strict';var a=r(3);r.d(t,'o',function(){return a.a});var o=r(17);r.d(t,'a',function(){return o.a}),r.d(t,'b',function(){return o.c}),r.d(t,'d',function(){return o.d}),r.d(t,'e',function(){return o.e}),r.d(t,'g',function(){return o.f}),r.d(t,'j',function(){return o.g});var i=r(43),s=r(44);r.d(t,'n',function(){return s.a}),r.d(t,'z',function(){return s.b});var n=r(19);r.d(t,'c',function(){return n.a});var d=r(9),l=r(10);r.d(t,'k',function(){return l.a});var c=r(18);r.d(t,'m',function(){return c.a}),r.d(t,'p',function(){return c.b}),r.d(t,'v',function(){return c.c});var p=r(45);r.d(t,'f',function(){return p.a});var u=r(5);r.d(t,'h',function(){return u.a});var y=r(11);r.d(t,'l',function(){return y.a});var h=r(20);r.d(t,'i',function(){return h.a});var _=r(46);r.d(t,'w',function(){return _.a}),r.d(t,'q',function(){return _.b});var f=r(47);r.d(t,'x',function(){return f.a}),r.d(t,'r',function(){return f.b});var m=r(48);r.d(t,'y',function(){return m.a}),r.d(t,'s',function(){return m.b});var g=r(49);r.d(t,'A',function(){return g.a}),r.d(t,'t',function(){return g.b});var b=r(50);r.d(t,'B',function(){return b.a}),r.d(t,'u',function(){return b.b})},function(e,t,r){'use strict';var a=r(4);r.d(t,'d',function(){return a.a});var o=r(40);r.d(t,'c',function(){return o.a});var i=r(14),s=r(41),n=r(6);r.d(t,'e',function(){return n.a}),r.d(t,'g',function(){return n.c}),r.d(t,'f',function(){return n.b});var d=r(16);r.d(t,'a',function(){return d.a});var l=r(15),c=r(42);r.d(t,'b',function(){return c.a})},function(e,t,r){'use strict';var a=r(2);r.d(t,'a',function(){return a.d})},function(e,t,r){'use strict';(function(e){var a=r(0),o='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},i='object'==('undefined'==typeof self?'undefined':o(self))&&self.self===self&&self||'object'==('undefined'==typeof e?'undefined':o(e))&&e.global===e&&e||this||{},s={globals:i,Promise:i.Promise,uuid:a.o};t.a=s}).call(t,r(32))},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return u});var o=r(3),i=r(2),s=r(19),n=r(20),d=r(0),l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),p='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},c=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':p(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n},u=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._schema=r.schema,this._keyMap=r.keyMap;var o=this._name=r.name,s=this._bucket=r.bucket;this._queryBuilder=r.queryBuilder,this._transformBuilder=r.transformBuilder,s&&Object(d.a)('TransformLog requires a name if it has a bucket',!!o),this._transformLog=new i.b({name:o?o+'-log':void 0,bucket:s}),this._requestQueue=new i.c(this,{name:o?o+'-requests':void 0,bucket:s}),this._syncQueue=new i.c(this,{name:o?o+'-sync':void 0,bucket:s}),this._schema&&(void 0===r.autoUpgrade||r.autoUpgrade)&&this._schema.on('upgrade',function(){return t.upgrade()})}return l(e,[{key:'perform',value:function(e){var t='__'+e.type+'__';return this[t].call(this,e.data)}},{key:'upgrade',value:function(){return o.a.Promise.resolve()}},{key:'_transformed',value:function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t._transformLog.contains(r.id)?o.a.Promise.resolve():t._transformLog.append(r.id).then(function(){return Object(i.g)(t,'transform',r)})})},o.a.Promise.resolve()).then(function(){return e})}},{key:'_enqueueRequest',value:function(e,t){return this._requestQueue.push({type:e,data:t})}},{key:'_enqueueSync',value:function(e,t){return this._syncQueue.push({type:e,data:t})}},{key:'name',get:function(){return this._name}},{key:'schema',get:function(){return this._schema}},{key:'keyMap',get:function(){return this._keyMap}},{key:'bucket',get:function(){return this._bucket}},{key:'transformLog',get:function(){return this._transformLog}},{key:'requestQueue',get:function(){return this._requestQueue}},{key:'syncQueue',get:function(){return this._syncQueue}},{key:'queryBuilder',get:function(){var e=this._queryBuilder;return void 0===e&&(e=this._queryBuilder=new s.a),e}},{key:'transformBuilder',get:function(){var e=this._transformBuilder;return void 0===e&&(e=this._transformBuilder=new n.a({recordInitializer:this._schema})),e}}]),e}();u=c([i.e],u)},function(e,t,r){'use strict';function a(e){return Array.isArray(e)?e:Array.from(e)}function o(e){return!!e[p]}function i(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];void 0===e._eventedNotifiers&&(e._eventedNotifiers={});var a=e._eventedNotifiers[t];return!a&&r&&(a=e._eventedNotifiers[t]=new l.a),a}function s(e,t){e._eventedNotifiers&&e._eventedNotifiers[t]&&delete e._eventedNotifiers[t]}function n(e,t,r,o){if(0===e.length)r();else{var i=e,s=a(i),l;l=s[0],e=s.slice(1);var p=l,u=c(p,2),y=u[0],h=u[1],_=y.apply(h,t);if(_)return d.a.Promise.resolve(_).then(function(){return n(e,t,r,o)}).catch(function(e){return o(e)});n(e,t,r,o)}}t.a=function(e){var t=e.prototype;o(t)||(t[p]=!0,t.on=function(e,t,r){var a=r||this;i(this,e,!0).addListener(t,a)},t.off=function(e,t,r){var a=r||this,o=i(this,e);o&&(t?o.removeListener(t,a):s(this,e))},t.one=function(e,t,r){var a=r||this,o,s;s=i(this,e,!0),o=function(){t.apply(a,arguments),s.removeListener(o,a)},s.addListener(o,a)},t.emit=function(e){var t=i(this,e);if(t){for(var r=arguments.length,a=Array(1<r?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];t.emit.apply(t,a)}},t.listeners=function(e){var t=i(this,e);return t?t.listeners:[]})},t.c=function(e,t){for(var r=arguments.length,a=Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var i=e.listeners(t);return i.reduce(function(e,t){var r=c(t,2),o=r[0],i=r[1];return e.then(function(){return o.apply(i,a)}).catch(function(){})},d.a.Promise.resolve())},t.b=function(e,t){for(var r=arguments.length,a=Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var i=e.listeners(t);return new d.a.Promise(function(e,t){n(i,a,e,t)})};var d=r(4),l=r(15),c=function(){function e(e,t){var r=[],a=!0,o=!1,i;try{for(var s=e[Symbol.iterator](),n;!(a=(n=s.next()).done)&&(r.push(n.value),!(t&&r.length===t));a=!0);}catch(e){o=!0,i=e}finally{try{!a&&s['return']&&s['return']()}finally{if(o)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),p='__evented__'},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return i});var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(){function e(t){a(this,e),this._cache=t}return o(e,[{key:'cache',get:function(){return this._cache}}]),o(e,[{key:'reset',value:function(){}},{key:'upgrade',value:function(){}},{key:'validate',value:function(){}},{key:'before',value:function(){return[]}},{key:'after',value:function(){return[]}},{key:'immediate',value:function(){}},{key:'finally',value:function(){return[]}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return n});var o=r(1),i=r(0),s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),Object(i.a)('Strategy requires a name',!!t.name),this._name=t.name,this._sourceNames=t.sources,this._logPrefix=t.logPrefix||'['+this._name+']',this._logLevel=this._customLogLevel=t.logLevel}return s(e,[{key:'activate',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this._coordinator=e,void 0===this._customLogLevel&&(this._logLevel=t.logLevel),this._sources=this._sourceNames?this._sourceNames.map(function(t){return e.getSource(t)}):e.sources,o.o.Promise.resolve()}},{key:'deactivate',value:function(){return this._coordinator=null,o.o.Promise.resolve()}},{key:'name',get:function(){return this._name}},{key:'coordinator',get:function(){return this._coordinator}},{key:'sources',get:function(){return this._sources}},{key:'logPrefix',get:function(){return this._logPrefix}},{key:'logLevel',get:function(){return this._logLevel}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function s(e){if(Object(l.k)(e)){var t=e;return t.kind=t.kind||'attribute',t.op=t.op||'equal',t}}function n(e){if(Object(l.k)(e)){var t=e;return t.kind=t.kind||'attribute',t.order=t.order||'ascending',t}if('string'==typeof e)return d(e);throw new Error('Sort expression must be either an object or a string.')}function d(e){var t,r;return'-'===e[0]?(t=e.slice(1),r='descending'):(t=e,r='ascending'),{kind:'attribute',attribute:t,order:r}}r.d(t,'e',function(){return p}),r.d(t,'a',function(){return u}),r.d(t,'c',function(){return y}),r.d(t,'d',function(){return h}),r.d(t,'b',function(){return _});var l=r(0),c=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),p=function(){function e(t){i(this,e),this.expression=t}return c(e,[{key:'toQueryExpression',value:function(){return this.expression}}]),e}(),u=function(e){function t(e){i(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRecord',record:e}))}return o(t,e),t}(p),y=function(e){function t(e,r){i(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRelatedRecord',record:e,relationship:r}))}return o(t,e),t}(p),h=function(e){function t(e,r){i(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRelatedRecords',record:e,relationship:r}))}return o(t,e),t}(p),_=function(e){function t(e){i(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRecords',type:e}))}return o(t,e),c(t,[{key:'sort',value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=t.map(n);return this.expression.sort=(this.expression.sort||[]).concat(a),this}},{key:'page',value:function(e){return this.expression.page=e,this}},{key:'filter',value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];t.map(s);return this.expression.filter=(this.expression.filter||[]).concat(t),this}}]),t}(p)},function(e,t,r){'use strict';function a(e,t,r,n){if('function'==typeof e)return a(e(n),t,r);var d=e,l,c;if(Object(s.k)(d)&&d.expression){if(d.id&&!t&&!r)return d;l=d.expression,c=t||d.options}else l=e instanceof i.e?e.toQueryExpression():e,c=t;var p=r||o.a.uuid();return{expression:l,options:c,id:p}}t.a=a;var o=r(3),i=r(9),s=r(0)},function(e,t,r){'use strict';function a(e,t,r,s){if('function'==typeof e)return a(e(s),t,r);var n=e,d,l;if(Object(i.k)(n)&&n.operations){if(n.id&&!t&&!r)return n;d=n.operations,l=t||n.options}else d=Object(i.i)(e)?e:[e],l=t;var c=r||o.a.uuid();return{operations:d,options:l,id:c}}t.a=a;var o=r(3),i=r(0)},function(e,t,r){'use strict';var a=r(56);r.d(t,'a',function(){return a.a})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return c});var s=r(8),n=r(0),d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=function e(t,r,a){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(o===void 0){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,a)}if('value'in o)return o.value;var s=o.get;return void 0===s?void 0:s.call(a)},c=function(e){function t(e){a(this,t),Object(n.a)('A `source` must be specified for a ConnectionStrategy',!!e.source),Object(n.a)('`source` should be a Source name specified as a string','string'==typeof e.source),Object(n.a)('`on` should be specified as the name of the event a ConnectionStrategy listens for','string'==typeof e.on),e.sources=[e.source];var r=e.source+':'+e.on;delete e.source,e.target&&(Object(n.a)('`target` should be a Source name specified as a string','string'==typeof e.target),e.sources.push(e.target),r+=' -> '+e.target,'string'==typeof e.action&&(r+=':'+e.action),delete e.target),e.name=e.name||r;var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._event=e.on,i._action=e.action,i._catch=e.catch,i._filter=e.filter,i._blocking=!!e.blocking,i}return i(t,e),d(t,[{key:'activate',value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'activate',this).call(this,e,a).then(function(){r._listener=r._generateListener(),r.source.on(r._event,r._listener,r)})}},{key:'deactivate',value:function(){var e=this;return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'deactivate',this).call(this).then(function(){e.source.off(e._event,e._listener,e),e._listener=null})}},{key:'_generateListener',value:function(){var t=this,e=this.target;return function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];var o;if(!t._filter||t._filter.apply(t,r)){if('string'==typeof t._action){var i;o=(i=t.target)[t._action].apply(i,r)}else o=t._action.apply(t,r);if(t._catch&&o&&o.catch&&(o=o.catch(function(a){return r.unshift(a),t._catch.apply(t,r)})),t._blocking)return o}}}},{key:'source',get:function(){return this._sources[0]}},{key:'target',get:function(){return this._sources[1]}},{key:'blocking',get:function(){return this._blocking}}]),t}(s.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return s});var o=r(4),i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=function(){function e(t,r){a(this,e),this.target=t,this.task=r,this.reset()}return i(e,[{key:'reset',value:function(){var t=this;this._started=!1,this._settled=!1,this._settlement=new o.a.Promise(function(e,r){t._success=function(a){t._settled=!0,e(a)},t._fail=function(a){t._settled=!0,r(a)}})}},{key:'settle',value:function(){return this._settlement}},{key:'process',value:function(){return this._started||(this._started=!0,this.target.perform(this.task).then(this._success,this._fail)),this.settle()}},{key:'started',get:function(){return this._started}},{key:'settled',get:function(){return this._settled}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return i});var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(){function e(){a(this,e),this.listeners=[]}return o(e,[{key:'addListener',value:function(e,t){t=t||this,this.listeners.push([e,t])}},{key:'removeListener',value:function(e,t){var r=this.listeners,a;t=t||this;for(var o=0,i=r.length;o<i;o++)if(a=r[o],a&&a[0]===e&&a[1]===t)return void r.splice(o,1)}},{key:'emit',value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.listeners.slice(0).forEach(function(e){e[0].apply(e[1],t)})}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return s}),r.d(t,'b',function(){return n}),r.d(t,'c',function(){return d});var s=function e(t){i(this,e),this.message=t,this.error=new Error(this.message),this.stack=this.error.stack},n=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Action not logged: '+e));return r.id=e,r}return o(t,e),t}(s),d=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Out of range: '+e));return r.value=e,r}return o(t,e),t}(s)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return n}),r.d(t,'f',function(){return d}),r.d(t,'c',function(){return l}),r.d(t,'d',function(){return c}),r.d(t,'g',function(){return u}),r.d(t,'b',function(){return h}),r.d(t,'e',function(){return f});var s=r(2),n=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Client error: '+e));return r.description=e,r}return i(t,e),t}(s.a),d=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Server error: '+e));return r.description=e,r}return i(t,e),t}(s.a),l=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Network error: '+e));return r.description=e,r}return i(t,e),t}(s.a),c=function(e){function t(e,r){a(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Query expression parse error: '+e));return i.description=e,i.expression=r,i}return i(t,e),t}(s.a),p=function(e){function t(e,r){a(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Query not allowed: '+e));return i.description=e,i.query=r,i}return i(t,e),t}(s.a),u=function(e){function t(e,r){a(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Transform not allowed: '+e));return i.description=e,i.transform=r,i}return i(t,e),t}(s.a),y=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Schema error: '+e));return r.description=e,r}return i(t,e),t}(s.a),h=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Model definition for '+e+' not found'))}return i(t,e),t}(y),_=function(e){function t(e,r,i,s){a(this,t);var n=e+': '+r+':'+i;s&&(n+='/'+s);var d=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return d.description=e,d.type=r,d.id=i,d.relationship=s,d}return i(t,e),t}(s.a),f=function(e){function t(e,r){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Record not found',e,r))}return i(t,e),t}(_),m=function(e){function t(e,r,i){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Relationship not found',e,r,i))}return i(t,e),t}(_),g=function(e){function t(e,r){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Record already exists',e,r))}return i(t,e),t}(_)},function(e,t,r){'use strict';function a(e){var t=e.type,r=e.id;return{type:t,id:r}}t.a=a,t.b=function(e,t){return Object(o.j)(e)&&Object(o.j)(t)||Object(o.k)(e)&&Object(o.k)(t)&&e.type===t.type&&e.id===t.id},t.c=function(e,t){if(e){var r=a(e);return['attributes','keys','relationships'].forEach(function(a){e[a]&&t[a]?r[a]=Object(o.l)({},e[a],t[a]):e[a]?r[a]=Object(o.l)({},e[a]):t[a]&&(r[a]=Object(o.l)({},t[a]))}),r}return t};var o=r(0)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return s});var o=r(9),i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=function(){function e(){a(this,e)}return i(e,[{key:'findRecord',value:function(e){return new o.a(e)}},{key:'findRecords',value:function(e){return new o.b(e)}},{key:'findRelatedRecord',value:function(e,t){return new o.c(e,t)}},{key:'findRelatedRecords',value:function(e,t){return new o.d(e,t)}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return i});var o=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._recordInitializer=t.recordInitializer}return o(e,[{key:'addRecord',value:function(e){return this._recordInitializer&&this._recordInitializer.initializeRecord(e),{op:'addRecord',record:e}}},{key:'replaceRecord',value:function(e){return{op:'replaceRecord',record:e}}},{key:'removeRecord',value:function(e){return{op:'removeRecord',record:e}}},{key:'replaceKey',value:function(e,t,r){return{op:'replaceKey',record:e,key:t,value:r}}},{key:'replaceAttribute',value:function(e,t,r){return{op:'replaceAttribute',record:e,attribute:t,value:r}}},{key:'addToRelatedRecords',value:function(e,t,r){return{op:'addToRelatedRecords',record:e,relationship:t,relatedRecord:r}}},{key:'removeFromRelatedRecords',value:function(e,t,r){return{op:'removeFromRelatedRecords',record:e,relationship:t,relatedRecord:r}}},{key:'replaceRelatedRecords',value:function(e,t,r){return{op:'replaceRelatedRecords',record:e,relationship:t,relatedRecords:r}}},{key:'replaceRelatedRecord',value:function(e,t,r){return{op:'replaceRelatedRecord',record:e,relationship:t,relatedRecord:r}}},{key:'recordInitializer',get:function(){return this._recordInitializer}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(0),i=r(2),s=r(1),n=r(22),d=r(23),l=r(25),c=r(53),p=r(54),u=r(55),y=r(12),h=r(58),_=r(59),f=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),m='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},g=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':m(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n},b=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._schema=r.schema,this._keyMap=r.keyMap,this._queryBuilder=r.queryBuilder||new s.c,this._transformBuilder=r.transformBuilder||new s.i({recordInitializer:this._schema});var o=r.processors?r.processors:[l.a,d.a,n.a];this._processors=o.map(function(e){return new e(t)}),this.reset(r.base)}return f(e,[{key:'records',value:function(e){return this._records[e]}},{key:'query',value:function(e,t,r){var a=Object(s.k)(e,t,r,this._queryBuilder);return this._query(a.expression)}},{key:'reset',value:function(e){var t=this;this._records={},Object.keys(this._schema.models).forEach(function(r){var a=e&&e.records(r);t._records[r]=new y.a(a)}),this._relationships=new h.a(this,e&&e.relationships),this._inverseRelationships=new _.a(this,e&&e.inverseRelationships),this._processors.forEach(function(t){return t.reset(e)}),this.emit('reset')}},{key:'upgrade',value:function(){var e=this;Object.keys(this._schema.models).forEach(function(t){e._records[t]||(e._records[t]=new y.a)}),this._relationships.upgrade(),this._inverseRelationships.upgrade(),this._processors.forEach(function(e){return e.upgrade()})}},{key:'patch',value:function(e){'function'==typeof e&&(e=e(this._transformBuilder));var t={inverse:[],data:[]};return Object(o.i)(e)?this._applyOperations(e,t,!0):this._applyOperation(e,t,!0),t}},{key:'_applyOperations',value:function(e,t){var r=this,a=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e.forEach(function(e){return r._applyOperation(e,t,a)})}},{key:'_applyOperation',value:function(e,t){var r=this,a=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._processors.forEach(function(t){return t.validate(e)});var o=u.a[e.op],i=o(this,e);if(i){t.inverse.unshift(i),this._processors.map(function(t){return t.before(e)}).forEach(function(e){return r._applyOperations(e,t)});var s=this._processors.map(function(t){return t.after(e)}),n=p.a[e.op],d=n(this,e);a&&t.data.push(d),this._processors.forEach(function(t){return t.immediate(e)}),this.emit('patch',e,d),s.forEach(function(e){return r._applyOperations(e,t)}),this._processors.map(function(t){return t.finally(e)}).forEach(function(e){return r._applyOperations(e,t)})}else a&&t.data.push(null)}},{key:'_query',value:function(e){var t=c.a[e.op];if(!t)throw new Error('Unable to find operator: '+e.op);return t(this,e)}},{key:'keyMap',get:function(){return this._keyMap}},{key:'schema',get:function(){return this._schema}},{key:'queryBuilder',get:function(){return this._queryBuilder}},{key:'transformBuilder',get:function(){return this._transformBuilder}},{key:'relationships',get:function(){return this._relationships}},{key:'inverseRelationships',get:function(){return this._inverseRelationships}}]),e}();b=g([i.e],b),t.a=b},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return l});var s=r(1),n=r(7),d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),d(t,[{key:'after',value:function(e){switch(e.op){case'replaceRelatedRecord':return this.cache.inverseRelationships.relatedRecordRemoved(e.record,e.relationship),[];case'replaceRelatedRecords':return this.cache.inverseRelationships.relatedRecordsRemoved(e.record,e.relationship),[];case'removeFromRelatedRecords':return this.cache.inverseRelationships.relatedRecordRemoved(e.record,e.relationship,e.relatedRecord),[];case'removeRecord':var t=this.clearInverseRelationshipOps(e.record);return this.cache.inverseRelationships.recordRemoved(e.record),t;case'replaceRecord':return this.cache.inverseRelationships.recordRemoved(e.record),[];default:return[];}}},{key:'immediate',value:function(e){switch(e.op){case'replaceRelatedRecord':return void this.cache.relationships.replaceRelatedRecord(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecords':return void this.cache.relationships.replaceRelatedRecords(e.record,e.relationship,e.relatedRecords);case'addToRelatedRecords':return void this.cache.relationships.addToRelatedRecords(e.record,e.relationship,e.relatedRecord);case'removeFromRelatedRecords':return void this.cache.relationships.removeFromRelatedRecords(e.record,e.relationship,e.relatedRecord);case'addRecord':return void this.cache.relationships.addRecord(e.record);case'replaceRecord':return void this.cache.relationships.replaceRecord(e.record);case'removeRecord':return void this.cache.relationships.clearRecord(e.record);}}},{key:'finally',value:function(e){switch(e.op){case'replaceRelatedRecord':return this.cache.inverseRelationships.relatedRecordAdded(e.record,e.relationship,e.relatedRecord),[];case'replaceRelatedRecords':return this.cache.inverseRelationships.relatedRecordsAdded(e.record,e.relationship,e.relatedRecords),[];case'addToRelatedRecords':return this.cache.inverseRelationships.relatedRecordAdded(e.record,e.relationship,e.relatedRecord),[];case'addRecord':return this.cache.inverseRelationships.recordAdded(e.record),[];case'replaceRecord':return this.cache.inverseRelationships.recordAdded(e.record),[];default:return[];}}},{key:'clearInverseRelationshipOps',value:function(e){var t=this,r=[],a=this.cache.inverseRelationships.all(e);if(0<a.length){var o=Object(s.m)(e);a.forEach(function(e){var a=t.cache.schema.getModel(e.record.type).relationships[e.relationship];'hasMany'===a.type?r.push({op:'removeFromRelatedRecords',record:e.record,relationship:e.relationship,relatedRecord:o}):r.push({op:'replaceRelatedRecord',record:e.record,relationship:e.relationship,relatedRecord:null})})}return r}}]),t}(n.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return Object(n.i)(e)?e:e?[e]:[]}r.d(t,'a',function(){return u});var n=r(0),d=r(1),l=r(7),c=r(24),p=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),u=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),p(t,[{key:'after',value:function(e){switch(e.op){case'addRecord':return this._recordAdded(e.record);case'addToRelatedRecords':return this._relatedRecordAdded(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecord':return this._relatedRecordReplaced(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecords':return this._relatedRecordsReplaced(e.record,e.relationship,e.relatedRecords);case'removeFromRelatedRecords':return this._relatedRecordRemoved(e.record,e.relationship,e.relatedRecord);case'removeRecord':return this._recordRemoved(e.record);case'replaceRecord':return this._recordReplaced(e.record);default:return[];}}},{key:'_relatedRecordAdded',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],i=o.inverse;return i&&r&&a.push(this._addRelationshipOp(r,i,e)),a}},{key:'_relatedRecordsAdded',value:function(e,t,r){var a=this,o=[],i=this.cache.schema.getModel(e.type).relationships[t],s=i.inverse;return s&&r&&0<r.length&&r.forEach(function(t){o.push(a._addRelationshipOp(t,s,e))}),o}},{key:'_relatedRecordRemoved',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],i=o.inverse;if(i){if(void 0===r){var s=this.cache.records(e.type).get(e.id);r=s&&Object(n.e)(s,['relationships',t,'data'])}r&&a.push(this._removeRelationshipOp(r,i,e))}return a}},{key:'_relatedRecordReplaced',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],i=o.inverse;if(i){var s=this.cache.relationships.relatedRecord(e,t);Object(d.p)(r,s)||(s&&a.push(this._removeRelationshipOp(s,i,e)),r&&a.push(this._addRelationshipOp(r,i,e)))}return a}},{key:'_relatedRecordsRemoved',value:function(e,t,r){var a=this,o=[],i=this.cache.schema.getModel(e.type).relationships[t],s=i.inverse;return s&&(void 0===r&&(r=this.cache.relationships.relatedRecords(e,t)),r&&r.forEach(function(t){return o.push(a._removeRelationshipOp(t,s,e))})),o}},{key:'_relatedRecordsReplaced',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],i=this.cache.relationships.relatedRecordsMap(e,t),s;if(i){var n=new c.a;r.forEach(function(e){return n.add(e)});var d=i.exclusiveOf(n);Array.prototype.push.apply(a,this._removeRelatedRecordsOps(e,o,d)),s=n.exclusiveOf(i)}else s=r;return Array.prototype.push.apply(a,this._addRelatedRecordsOps(e,o,s)),a}},{key:'_recordAdded',value:function(e){var t=this,r=[],a=e.relationships;if(a){var o=this.cache.schema.getModel(e.type),i=Object(d.m)(e);Object.keys(a).forEach(function(e){var n=o.relationships[e],d=a[e]&&a[e].data,l=s(d);Array.prototype.push.apply(r,t._addRelatedRecordsOps(i,n,l))})}return r}},{key:'_recordRemoved',value:function(e){var t=this,r=[],a=this.cache.records(e.type).get(e.id),o=a&&a.relationships;if(o){var i=this.cache.schema.getModel(e.type),n=Object(d.m)(e);Object.keys(o).forEach(function(e){var a=i.relationships[e],d=o[e]&&o[e].data,l=s(d);Array.prototype.push.apply(r,t._removeRelatedRecordsOps(n,a,l))})}return r}},{key:'_recordReplaced',value:function(e){var t=[];if(e.relationships){var r=this.cache.schema.getModel(e.type),a=Object(d.m)(e);for(var o in e.relationships){var i=r.relationships[o],s=e&&Object(n.e)(e,['relationships',o,'data']);'hasMany'===i.type?Array.prototype.push.apply(t,this._relatedRecordsReplaced(a,o,s)):Array.prototype.push.apply(t,this._relatedRecordReplaced(a,o,s))}}return t}},{key:'_addRelatedRecordsOps',value:function(e,t,r){var a=this;return 0<r.length&&t.inverse?r.map(function(r){return a._addRelationshipOp(r,t.inverse,e)}):[]}},{key:'_removeRelatedRecordsOps',value:function(e,t,r){var a=this;if(0<r.length){if('remove'===t.dependent)return this._removeDependentRecords(r);if(t.inverse)return r.map(function(r){return a._removeRelationshipOp(r,t.inverse,e)})}return[]}},{key:'_addRelationshipOp',value:function(e,t,r){var a=this.cache.schema.getModel(e.type).relationships[t],o='hasMany'===a.type;return{op:o?'addToRelatedRecords':'replaceRelatedRecord',record:e,relationship:t,relatedRecord:r}}},{key:'_removeRelationshipOp',value:function(e,t,r){var a=this.cache.schema.getModel(e.type).relationships[t],o='hasMany'===a.type;return{op:o?'removeFromRelatedRecords':'replaceRelatedRecord',record:e,relationship:t,relatedRecord:o?r:null}}},{key:'_removeDependentRecords',value:function(e){return e.map(function(e){return{op:'removeRecord',record:e}})}}]),t}(l.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e){return e.type+':'+e.id}function i(e){var t=e.split(':'),r=n(t,2),a=r[0],o=r[1];return{type:a,id:o}}r.d(t,'a',function(){return d});var s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(e,t){var r=[],a=!0,o=!1,i;try{for(var s=e[Symbol.iterator](),n;!(a=(n=s.next()).done)&&(r.push(n.value),!(t&&r.length===t));a=!0);}catch(e){o=!0,i=e}finally{try{!a&&s['return']&&s['return']()}finally{if(o)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),d=function(){function e(t){a(this,e);var r=this.identities={};t&&Object.keys(t.identities).forEach(function(e){r[e]=!0})}return s(e,[{key:'add',value:function(e){this.identities[o(e)]=!0}},{key:'remove',value:function(e){delete this.identities[o(e)]}},{key:'has',value:function(e){return!!e&&!!this.identities[o(e)]}},{key:'exclusiveOf',value:function(e){return Object.keys(this.identities).filter(function(t){return!e.identities[t]}).map(function(e){return i(e)})}},{key:'equals',value:function(e){return 0===this.exclusiveOf(e).length&&0===e.exclusiveOf(this).length}},{key:'values',get:function(){return Object.keys(this.identities).map(function(e){return i(e)})}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return d});var s=r(7),n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),n(t,[{key:'validate',value:function(e){switch(e.op){case'addRecord':return this._recordAdded(e.record);case'replaceRecord':return this._recordReplaced(e.record);case'removeRecord':return this._recordRemoved(e.record);case'replaceKey':return this._keyReplaced(e.record);case'replaceAttribute':return this._attributeReplaced(e.record);case'addToRelatedRecords':return this._relatedRecordAdded(e.record,e.relationship,e.relatedRecord);case'removeFromRelatedRecords':return this._relatedRecordRemoved(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecords':return this._relatedRecordsReplaced(e.record,e.relationship,e.relatedRecords);case'replaceRelatedRecord':return this._relatedRecordReplaced(e.record,e.relationship,e.relatedRecord);default:}}},{key:'_recordAdded',value:function(e){this._validateRecord(e)}},{key:'_recordReplaced',value:function(e){this._validateRecord(e)}},{key:'_recordRemoved',value:function(e){this._validateRecordIdentity(e)}},{key:'_keyReplaced',value:function(e){this._validateRecordIdentity(e)}},{key:'_attributeReplaced',value:function(e){this._validateRecordIdentity(e)}},{key:'_relatedRecordAdded',value:function(e,t,r){this._validateRecordIdentity(e),this._validateRecordIdentity(r)}},{key:'_relatedRecordRemoved',value:function(e,t,r){this._validateRecordIdentity(e),this._validateRecordIdentity(r)}},{key:'_relatedRecordsReplaced',value:function(e,t,r){var a=this;this._validateRecordIdentity(e),r.forEach(function(e){a._validateRecordIdentity(e)})}},{key:'_relatedRecordReplaced',value:function(e,t,r){this._validateRecordIdentity(e),r&&this._validateRecordIdentity(r)}},{key:'_validateRecord',value:function(e){this._validateRecordIdentity(e)}},{key:'_validateRecordIdentity',value:function(e){this.cache.schema.getModel(e.type)}}]),t}(s.a)},function(e,t,r){'use strict';var a=r(27);r.d(t,'d',function(){return a.b});var o=r(8),i=r(60),s=r(61);r.d(t,'a',function(){return s.a});var n=r(13),d=r(62);r.d(t,'b',function(){return d.a});var l=r(63);r.d(t,'c',function(){return l.a})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return n}),r.d(t,'b',function(){return d});var o=r(1),i=r(0),s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n;(function(e){e[e.None=0]='None',e[e.Errors=1]='Errors',e[e.Warnings=2]='Warnings',e[e.Info=3]='Info'})(n||(n={}));var d=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._sources={},this._strategies={},r.sources&&r.sources.forEach(function(e){return t.addSource(e)}),r.strategies&&r.strategies.forEach(function(e){return t.addStrategy(e)}),this._defaultActivationOptions=r.defaultActivationOptions||{},void 0===this._defaultActivationOptions.logLevel&&(this._defaultActivationOptions.logLevel=n.Info)}return s(e,[{key:'addSource',value:function(e){var t=e.name;Object(i.a)('Sources require a \'name\' to be added to a coordinator.',!!t),Object(i.a)('A source named \''+t+'\' has already been added to this coordinator.',!this._sources[t]),Object(i.a)('A coordinator\'s sources can not be changed while it is active.',!this._activated),this._sources[t]=e}},{key:'removeSource',value:function(e){var t=this._sources[e];Object(i.a)('Source \''+e+'\' has not been added to this coordinator.',!!t),Object(i.a)('A coordinator\'s sources can not be changed while it is active.',!this._activated),delete this._sources[e]}},{key:'getSource',value:function(e){return this._sources[e]}},{key:'addStrategy',value:function(e){var t=e.name;Object(i.a)('A strategy named \''+t+'\' has already been added to this coordinator.',!this._strategies[t]),Object(i.a)('A coordinator\'s strategies can not be changed while it is active.',!this._activated),this._strategies[t]=e}},{key:'removeStrategy',value:function(e){var t=this._strategies[e];Object(i.a)('Strategy \''+e+'\' has not been added to this coordinator.',!!t),Object(i.a)('A coordinator\'s strategies can not be changed while it is active.',!this._activated),delete this._strategies[e]}},{key:'getStrategy',value:function(e){return this._strategies[e]}},{key:'activate',value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._activated||(void 0===t.logLevel&&(t.logLevel=this._defaultActivationOptions.logLevel),this._currentActivationOptions=t,this._activated=this.strategies.reduce(function(r,a){return r.then(function(){return a.activate(e,t)})},o.o.Promise.resolve())),this._activated}},{key:'deactivate',value:function(){var e=this;return this._activated?this._activated.then(function(){return e.strategies.reverse().reduce(function(e,t){return e.then(function(){return t.deactivate()})},o.o.Promise.resolve())}).then(function(){e._activated=null}):o.o.Promise.resolve()}},{key:'sources',get:function(){return Object(i.m)(this._sources)}},{key:'sourceNames',get:function(){return Object.keys(this._sources)}},{key:'strategies',get:function(){return Object(i.m)(this._strategies)}},{key:'strategyNames',get:function(){return Object.keys(this._strategies)}},{key:'activated',get:function(){return this._activated}}]),e}()},function(e,t,r){'use strict';function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return n});var i=r(0),s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){o(this,e),this._schema=t.schema,this._keyMap=t.keyMap}return s(e,[{key:'resourceKey',value:function(){return'id'}},{key:'resourceType',value:function(e){return Object(i.d)(this.schema.pluralize(e))}},{key:'resourceRelationship',value:function(e,t){return Object(i.d)(t)}},{key:'resourceAttribute',value:function(e,t){return Object(i.d)(t)}},{key:'resourceIdentity',value:function(e){return{type:this.resourceType(e.type),id:this.resourceId(e.type,e.id)}}},{key:'resourceIds',value:function(e,t){var r=this;return t.map(function(t){return r.resourceId(e,t)})}},{key:'resourceId',value:function(e,t){var r=this.resourceKey(e);return'id'===r?t:this.keyMap.idToKey(e,r,t)}},{key:'recordId',value:function(e,t){var r=this.resourceKey(e);if('id'===r)return t;var a=this.keyMap.keyToId(e,r,t);return a?a:this._generateNewId(e,r,t)}},{key:'recordType',value:function(e){return Object(i.b)(this.schema.singularize(e))}},{key:'recordIdentity',value:function(e){var t=this.recordType(e.type),r=this.recordId(t,e.id);return{type:t,id:r}}},{key:'recordAttribute',value:function(e,t){return Object(i.b)(t)}},{key:'recordRelationship',value:function(e,t){return Object(i.b)(t)}},{key:'serializeDocument',value:function(e){return{data:Object(i.i)(e)?this.serializeRecords(e):this.serializeRecord(e)}}},{key:'serializeRecords',value:function(e){var t=this;return e.map(function(e){return t.serializeRecord(e)})}},{key:'serializeRecord',value:function(e){var t={type:this.resourceType(e.type)};return this.serializeId(t,e),this.serializeAttributes(t,e),this.serializeRelationships(t,e),t}},{key:'serializeId',value:function(e,t){var r=this.resourceId(t.type,t.id);void 0!==r&&(e.id=r)}},{key:'serializeAttributes',value:function(e,t){var r=this;t.attributes&&Object.keys(t.attributes).forEach(function(a){r.serializeAttribute(e,t,a)})}},{key:'serializeAttribute',value:function(e,t,r){var a=t.attributes[r];void 0!==a&&Object(i.f)(e,['attributes',this.resourceAttribute(t.type,r)],a)}},{key:'serializeRelationships',value:function(e,t){var r=this;t.relationships&&Object.keys(t.relationships).forEach(function(a){r.serializeRelationship(e,t,a)})}},{key:'serializeRelationship',value:function(e,t,r){var a=this,o=t.relationships[r].data;if(void 0!==o){var s=Object(i.i)(o)?o.map(function(e){return a.resourceIdentity(e)}):null===o?null:this.resourceIdentity(o);var n=this.resourceRelationship(t.type,r);Object(i.f)(e,['relationships',n,'data'],s)}}},{key:'deserializeDocument',value:function(e){var t=e.data,r;return r=Object(i.i)(t)?{data:t.map(this.deserializeResource,this)}:{data:this.deserializeResource(t)},e.included&&(r.included=e.included.map(this.deserializeResource,this)),r}},{key:'deserializeResource',value:function(e){var t=this.recordType(e.type),r=this.resourceKey(t),o;if('id'===r)o={type:t,id:e.id};else{var i,s;e.id?(s=a({},r,e.id),i=this.keyMap.idFromKeys(t,s)||this.schema.generateId(t)):i=this.schema.generateId(t),o={type:t,id:i},s&&(o.keys=s)}return this.deserializeAttributes(o,e),this.deserializeRelationships(o,e),this.keyMap&&this.keyMap.pushRecord(o),o}},{key:'deserializeAttributes',value:function(e,t){var r=this;t.attributes&&Object.keys(t.attributes).forEach(function(a){var o=r.recordAttribute(e.type,a);if(r.schema.hasAttribute(e.type,o)){var i=t.attributes[a];r.deserializeAttribute(e,o,i)}})}},{key:'deserializeAttribute',value:function(e,t,r){e.attributes=e.attributes||{},e.attributes[t]=r}},{key:'deserializeRelationships',value:function(e,t){var r=this;t.relationships&&Object.keys(t.relationships).forEach(function(a){var o=r.recordRelationship(e.type,a);if(r.schema.hasRelationship(e.type,o)){var i=t.relationships[a];r.deserializeRelationship(e,o,i)}})}},{key:'deserializeRelationship',value:function(e,t,r){var a=this,o=r.data;if(void 0!==o){var s;s=null===o?null:Object(i.i)(o)?o.map(function(e){return a.recordIdentity(e)}):this.recordIdentity(o),e.relationships=e.relationships||{},e.relationships[t]={data:s}}}},{key:'_generateNewId',value:function(e,t,r){var o=this.schema.generateId(e);return this.keyMap.pushRecord({type:e,id:o,keys:a({},t,r)}),o}},{key:'schema',get:function(){return this._schema}},{key:'keyMap',get:function(){return this._keyMap}}]),e}()},function(e,t,r){'use strict';t.a=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=['filter','include','page','sort'],o=0,i;o<r.length;o++)i=r[o],e[i]&&Object(a.f)(t,['params',i],e[i]);return e.timeout&&(t.timeout=e.timeout),t};var a=r(0)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(31),o=r(26),i=new a.a({host:''});i.coordinator.addStrategy(new o.a),i.coordinator.activate(),window.interceptClient=i,t['default']=i},function(e,t,r){'use strict';function a(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'===('undefined'==typeof t?'undefined':y(t))||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof t?'undefined':y(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var s=r(1),n=r(51),d=r(26),l=r(64),c=r(71),p=r.n(c),u=r(73),y='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e};s.o.fetch=window.fetch.bind(window);var h=function(e){function t(e){i(this,t);var r=Object.assign({schema:u.a,namespace:'jsonapi'},e),o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r)),s=new l.a({schema:r.schema,name:'remote',namespace:r.namespace,host:r.host});return o.coordinator.addSource(s),o.coordinator.addStrategy(new d.b({source:'store',on:'beforeQuery',target:'remote',action:'pull',blocking:!0})),o.coordinator.addStrategy(new d.b({source:'store',on:'beforeUpdate',target:'remote',action:'push',blocking:!1})),o.coordinator.addStrategy(new d.c({source:'remote',target:'store',blocking:!0})),o}return o(t,e),t}(function e(t){i(this,e),this.schema=t.schema,this.strategies=t.strategies||[];var r=new n.a({schema:u.a});this.store=r;var a=t.sources||[r],o=new d.d({sources:a});this.strategies.forEach(function(e){o.addStrategy(e)}),this.coordinator=o});t.a=h},function(e){var t='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},r;r=function(){return this}();try{r=r||Function('return this')()||(1,eval)('this')}catch(a){'object'===('undefined'==typeof window?'undefined':t(window))&&(r=window)}e.exports=r},function(e,t){'use strict';t.a=function(e,t){for(var r=-1,a=e.length;++r<a;){var o=t(e[r],r);if(o)return o}}},function(e,t){'use strict';t.a=function(e,t){if(!t)throw new Error('Assertion failed: '+e)}},function(){'use strict'},function(e,t){'use strict';function r(e,t){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;var s=Object.prototype.toString.call(e);if(s!==Object.prototype.toString.call(t))return!1;switch(s){case'[object String]':return e==t+'';case'[object Number]':return e==+e?0==e?1/e==1/t:e==+t:t!=+t;case'[object Date]':case'[object Boolean]':return+e==+t;case'[object RegExp]':return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase;}if('object'!=('undefined'==typeof e?'undefined':o(e))||'object'!=('undefined'==typeof t?'undefined':o(t)))return!1;if('[object Array]'===s&&e.length!==t.length)return!1;for(var n in t)if(t.hasOwnProperty(n)&&!r(e[n],t[n]))return!1;for(n in e)if(e.hasOwnProperty(n)&&!r(e[n],t[n]))return!1;return!0}t.a=r;var o='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e}},function(e,t){'use strict';function r(e){if(e===void 0||null===e||'object'!==('undefined'==typeof e?'undefined':s(e)))return e;var t=Object.prototype.toString.call(e),a;if('[object Date]'===t)a=new Date,a.setTime(e.getTime());else if('[object RegExp]'===t)a=e.constructor(e);else if('[object Array]'===t){a=[];for(var o=0,i=e.length;o<i;o++)e.hasOwnProperty(o)&&a.push(r(e[o]))}else{var n;for(var d in a={},e)e.hasOwnProperty(d)&&(n=e[d],'object'===('undefined'==typeof n?'undefined':s(n))&&(n=r(n)),a[d]=n)}return a}function a(e){return'[object Array]'===Object.prototype.toString.call(e)}function o(e){return e===void 0||null===e}t.a=r,t.d=a,t.i=function(e){return o(e)?[]:a(e)?e:[e]},t.f=function(e){return null!==e&&'object'===('undefined'==typeof e?'undefined':s(e))},t.e=o,t.g=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.forEach(function(t){Object.keys(t).forEach(function(r){if(t.hasOwnProperty(r)){var a=t[r];void 0===a&&void 0!==e[r]||(e[r]=a)}})}),e},t.b=function(e,t){for(var r=-1,a=e;++r<t.length;)if(a=a[t[r]],!a)return a;return a},t.c=function(e,t,r){for(var a=e,o=t.pop(),s=void 0,n=0,i=t.length;n<i;n++)s=t[n],void 0===a[s]&&(a[s]='number'==typeof s?[]:{}),a=a[s];return a[o]!==r&&(a[o]=r,!0)},t.h=function(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})};var s='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e}},function(e,t){'use strict';function r(e){return e.replace(/([a-z\d])([A-Z])/g,'$1_$2').toLowerCase()}t.a=function(e){return e.replace(/(\-|\_|\.|\s)+(.)?/g,function(e,t,r){return r?r.toUpperCase():''}).replace(/(^|\/)([A-Z])/g,function(e){return e.toLowerCase()})},t.b=function(e){return r(e).replace(/[ _]/g,'-')}},function(e,t){'use strict';t.a=function(){var e=0|4294967295*Math.random(),t=0|4294967295*Math.random(),a=0|4294967295*Math.random(),o=0|4294967295*Math.random();return r[255&e]+r[255&e>>8]+r[255&e>>16]+r[255&e>>24]+'-'+r[255&t]+r[255&t>>8]+'-'+r[64|15&t>>16]+r[255&t>>24]+'-'+r[128|63&a]+r[255&a>>8]+'-'+r[255&a>>16]+r[255&a>>24]+r[255&o]+r[255&o>>8]+r[255&o>>16]+r[255&o>>24]};/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/for(var r=[],a=0;256>a;a++)r[a]=(16>a?'0':'')+a.toString(16)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(4),i=r(14),s=r(6),n=r(0),d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},c=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':l(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n},p=function(){function e(t){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a(this,e),Object(n.a)('TaskQueue requires Orbit.Promise to be defined',o.a.Promise),this._performer=t,this._name=i.name,this._bucket=i.bucket,this.autoProcess=void 0===i.autoProcess||i.autoProcess,this._bucket&&Object(n.a)('TaskQueue requires a name if it has a bucket',!!this._name),this._reify().then(function(){0<r.length&&r.autoProcess&&r.process()})}return d(e,[{key:'push',value:function(e){var t=this,r=new i.a(this._performer,e);return this._reified.then(function(){return t._tasks.push(e),t._processors.push(r),t._persist()}).then(function(){return t.autoProcess?t.process().then(function(){return r.settle()}):r.settle()})}},{key:'retry',value:function(){var e=this;return this._reified.then(function(){return e._cancel(),e.currentProcessor.reset(),e._persist()}).then(function(){return e.process()})}},{key:'skip',value:function(){var e=this;return this._reified.then(function(){return e._cancel(),e._tasks.shift(),e._processors.shift(),e._persist()}).then(function(){return e.process()})}},{key:'clear',value:function(){var e=this;return this._reified.then(function(){return e._cancel(),e._tasks=[],e._processors=[],e._persist()}).then(function(){return e.process()})}},{key:'shift',value:function(){var e=this,t;return this._reified.then(function(){return e._cancel(),t=e._tasks.shift(),e._processors.shift(),e._persist()}).then(function(){return t})}},{key:'unshift',value:function(e){var t=this;return this._reified.then(function(){return t._cancel(),t._tasks.unshift(e),t._processors.unshift(new i.a(t._performer,e)),t._persist()})}},{key:'process',value:function(){var e=this;return this._reified.then(function(){var t=e._resolution;return t||(0===e._tasks.length?(t=o.a.Promise.resolve(),e._complete()):(e._error=null,e._resolution=t=new o.a.Promise(function(t,r){e._resolve=t,e._reject=r}),e._settleEach(t))),t})}},{key:'_complete',value:function(){this._resolve&&this._resolve(),this._resolve=null,this._reject=null,this._error=null,this._resolution=null,this.emit('complete')}},{key:'_fail',value:function(t,r){this._reject&&this._reject(r),this._resolve=null,this._reject=null,this._error=r,this._resolution=null,this.emit('fail',t,r)}},{key:'_cancel',value:function(){this._error=null,this._resolution=null}},{key:'_settleEach',value:function(t){var r=this;if(0===this._tasks.length)this._complete();else{var a=this._tasks[0],e=this._processors[0];this.emit('beforeTask',a),e.process().then(function(){t===r._resolution&&(r._tasks.shift(),r._processors.shift(),r._persist().then(function(){r.emit('task',a),r._settleEach(t)}))}).catch(function(o){t===r._resolution&&r._fail(a,o)})}}},{key:'_reify',value:function(){var e=this;return this._tasks=[],this._processors=[],this._reified=this._bucket?this._bucket.getItem(this._name).then(function(t){t&&(e._tasks=t,e._processors=t.map(function(t){return new i.a(e._performer,t)}))}):o.a.Promise.resolve(),this._reified}},{key:'_persist',value:function(){return this.emit('change'),this._bucket?this._bucket.setItem(this._name,this._tasks):o.a.Promise.resolve()}},{key:'name',get:function(){return this._name}},{key:'performer',get:function(){return this._performer}},{key:'bucket',get:function(){return this._bucket}},{key:'length',get:function(){return this._tasks?this._tasks.length:0}},{key:'entries',get:function(){return this._tasks}},{key:'current',get:function(){return this._tasks&&this._tasks[0]}},{key:'currentProcessor',get:function(){return this._processors&&this._processors[0]}},{key:'error',get:function(){return this._error}},{key:'empty',get:function(){return 0===this.length}},{key:'processing',get:function(){var e=this.currentProcessor;return void 0!==e&&e.started&&!e.settled}},{key:'reified',get:function(){return this._reified}}]),e}();p=c([s.a],p),t.a=p},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(4),i=r(6),s=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},d=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':n(Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l},l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),void 0===t.version&&(t.version=1),t.namespace=t.namespace||'orbit-bucket',this._applySettings(t)}return s(e,[{key:'upgrade',value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.version&&(t.version=this._version+1),this._applySettings(t).then(function(){return e.emit('upgrade',e._version)})}},{key:'_applySettings',value:function(e){return e.name&&(this._name=e.name),e.namespace&&(this._namespace=e.namespace),this._version=e.version,o.a.Promise.resolve()}},{key:'name',get:function(){return this._name}},{key:'namespace',get:function(){return this._namespace}},{key:'version',get:function(){return this._version}}]),e}();l=d([i.a],l)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(0),i=r(4),s=r(6),n=r(16),d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},c=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':l(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n},p=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._name=t.name,this._bucket=t.bucket,this._bucket&&Object(o.a)('Log requires a name if it has a bucket',!!this._name),this._reify(t.data)}return d(e,[{key:'append',value:function(){for(var e=this,t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.reified.then(function(){return Array.prototype.push.apply(e._data,r),e._persist()}).then(function(){e.emit('append',r)})}},{key:'before',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this._data.indexOf(e);if(-1===r)throw new n.b(e);var a=r+t;if(0>a||a>=this._data.length)throw new n.c(a);return this._data.slice(0,a)}},{key:'after',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this._data.indexOf(e);if(-1===r)throw new n.b(e);var a=r+1+t;if(0>a||a>this._data.length)throw new n.c(a);return this._data.slice(a)}},{key:'truncate',value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a;return this.reified.then(function(){var o=t._data.indexOf(e);if(-1===o)throw new n.b(e);var i=o+r;if(0>i||i>t._data.length)throw new n.c(i);return i===t._data.length?(a=t._data,t._data=[]):(a=t._data.slice(0,i),t._data=t._data.slice(i)),t._persist()}).then(function(){t.emit('truncate',e,r,a)})}},{key:'rollback',value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a;return this.reified.then(function(){var o=t._data.indexOf(e);if(-1===o)throw new n.b(e);var i=o+1+r;if(0>i||i>t._data.length)throw new n.c(i);return a=t._data.slice(i),t._data=t._data.slice(0,i),t._persist()}).then(function(){t.emit('rollback',e,r,a)})}},{key:'clear',value:function(){var e=this,t;return this.reified.then(function(){return t=e._data,e._data=[],e._persist()}).then(function(){return e.emit('clear',t)})}},{key:'contains',value:function(e){return-1<this._data.indexOf(e)}},{key:'_persist',value:function(){return this.emit('change'),this.bucket?this._bucket.setItem(this.name,this._data):i.a.Promise.resolve()}},{key:'_reify',value:function(e){var t=this;!e&&this._bucket?this.reified=this._bucket.getItem(this._name).then(function(e){return t._initData(e)}):(this._initData(e),this.reified=i.a.Promise.resolve())}},{key:'_initData',value:function(e){this._data=e?e:[]}},{key:'name',get:function(){return this._name}},{key:'bucket',get:function(){return this._bucket}},{key:'head',get:function(){return this._data[this._data.length-1]}},{key:'entries',get:function(){return this._data}},{key:'length',get:function(){return this._data.length}}]),e}();p=c([s.a],p),t.a=p},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(0),i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=function(){function e(){a(this,e),this.reset()}return i(e,[{key:'reset',value:function(){this._idsToKeys={},this._keysToIds={}}},{key:'idToKey',value:function(e,t,r){return Object(o.e)(this._idsToKeys,[e,t,r])}},{key:'keyToId',value:function(e,t,r){return Object(o.e)(this._keysToIds,[e,t,r])}},{key:'pushRecord',value:function(e){var t=this,r=e.type,a=e.id,i=e.keys;i&&a&&Object.keys(i).forEach(function(e){var s=i[e];s&&(Object(o.f)(t._idsToKeys,[r,e,a],s),Object(o.f)(t._keysToIds,[r,e,s],a))})}},{key:'idFromKeys',value:function(e,t){var r=this,a=Object.keys(t);return Object(o.h)(a,function(a){var o=t[a];if(o)return r.keyToId(e,a,o)})}}]),e}()},function(e,t,r){'use strict';function a(e){e._deleted=!0}function s(e){return!0===e._deleted}function o(e,t,r){Object(u.b)(e.record,t.record)&&('removeRecord'===t.op?(a(e),'addRecord'===e.op&&a(t)):!s(t)&&(r||'replaceAttribute'===t.op)&&(i(e.op)&&i(t.op)?'replaceAttribute'===e.op&&'replaceAttribute'===t.op&&e.attribute===t.attribute?a(e):'replaceRelatedRecord'===e.op&&'replaceRelatedRecord'===t.op&&e.relationship===t.relationship?a(e):'replaceRelatedRecords'===e.op&&'replaceRelatedRecords'===t.op&&e.relationship===t.relationship?a(e):('replaceAttribute'===e.op?(n(e.record,e.attribute,e.value),delete e.attribute,delete e.value):'replaceRelatedRecord'===e.op?(d(e.record,e.relationship,e.relatedRecord),delete e.relationship,delete e.relatedRecord):'replaceRelatedRecords'===e.op&&(l(e.record,e.relationship,e.relatedRecords),delete e.relationship,delete e.relatedRecords),'replaceAttribute'===t.op?n(e.record,t.attribute,t.value):'replaceRelatedRecord'===t.op?d(e.record,t.relationship,t.relatedRecord):'replaceRelatedRecords'===t.op&&l(e.record,t.relationship,t.relatedRecords),e.op='replaceRecord',a(t)):('addRecord'===e.op||'replaceRecord'===e.op)&&i(t.op)?('replaceAttribute'===t.op?n(e.record,t.attribute,t.value):'replaceRelatedRecord'===t.op?d(e.record,t.relationship,t.relatedRecord):'replaceRelatedRecords'===t.op&&l(e.record,t.relationship,t.relatedRecords),a(t)):'addToRelatedRecords'===t.op?'addRecord'===e.op?(c(e.record,t.relationship,t.relatedRecord),a(t)):'replaceRecord'===e.op&&e.record.relationships&&e.record.relationships[t.relationship]&&e.record.relationships[t.relationship].data&&(c(e.record,t.relationship,t.relatedRecord),a(t)):'removeFromRelatedRecords'===t.op&&('addToRelatedRecords'===e.op&&e.relationship===t.relationship&&Object(u.b)(e.relatedRecord,t.relatedRecord)?(a(e),a(t)):('addRecord'===e.op||'replaceRecord'===e.op)&&e.record.relationships&&e.record.relationships[t.relationship]&&e.record.relationships[t.relationship].data&&(p(e.record,t.relationship,t.relatedRecord),a(t)))))}function i(e){return'replaceAttribute'===e||'replaceRelatedRecord'===e||'replaceRelatedRecords'===e}function n(e,t,r){e.attributes=e.attributes||{},e.attributes[t]=r}function d(e,t,r){Object(y.f)(e,['relationships',t,'data'],Object(u.a)(r))}function l(e,t,r){Object(y.f)(e,['relationships',t,'data'],r.map(u.a))}function c(e,t,r){var a=Object(y.e)(e,['relationships',t,'data'])||[];a.push(Object(u.a)(r)),Object(y.f)(e,['relationships',t,'data'],a)}function p(e,t,a){var o=Object(y.e)(e,['relationships',t,'data']);if(o)for(var s=0,i=o.length,n;s<i;s++)if(n=o[s],Object(u.b)(n,a)){o.splice(s,1);break}}t.a=function(e){for(var t=0,r=e.length;t<r;t++)for(var a=e[t],i=!0,n=t+1,d;n<r&&(d=e[n],o(a,d,i),!s(a));n++)s(d)||(i=!1);return e.filter(function(e){return!s(e)})},t.b=function(e,t){var r=[];if(e&&t){var a=Object(u.a)(e);t.attributes&&Object.keys(t.attributes).forEach(function(o){var i=t.attributes[o];if(e.attributes===void 0||!Object(y.g)(e.attributes[o],i)){r.push({op:'replaceAttribute',record:a,attribute:o,value:i})}}),t.keys&&Object.keys(t.keys).forEach(function(o){var i=t.keys[o];if(e.keys===void 0||!Object(y.g)(e.keys[o],i)){r.push({op:'replaceKey',record:a,key:o,value:i})}})}return r};var u=r(18),y=r(0)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=r(3),i=r(17),s=r(2),n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},d=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':l(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n},c=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),void 0===t.version&&(t.version=1),void 0===t.models&&(t.models={}),this._applySettings(t)}return n(e,[{key:'upgrade',value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};void 0===e.version&&(e.version=this._version+1),this._applySettings(e),this.emit('upgrade',this._version)}},{key:'_applySettings',value:function(e){this._version=e.version,e.generateId&&(this.generateId=e.generateId),e.pluralize&&(this.pluralize=e.pluralize),e.singularize&&(this.singularize=e.singularize),e.models&&(this._models=e.models)}},{key:'generateId',value:function(){return o.a.uuid()}},{key:'pluralize',value:function(e){return e+'s'}},{key:'singularize',value:function(e){return e.lastIndexOf('s')===e.length-1?e.substr(0,e.length-1):e}},{key:'initializeRecord',value:function(e){void 0===e.id&&(e.id=this.generateId(e.type))}},{key:'getModel',value:function(e){var t=this.models[e];if(t)return t;throw new i.b(e)}},{key:'hasAttribute',value:function(e,t){var r=this.getModel(e);return r.attributes&&r.attributes[t]}},{key:'hasRelationship',value:function(e,t){var r=this.getModel(e);return r.relationships&&r.relationships[t]}},{key:'version',get:function(){return this._version}},{key:'models',get:function(){return this._models}}]),e}();c=d([s.e],c),t.a=c},function(e,t,r){'use strict';function a(e){return!!e[d]}t.b=a,t.a=function(e){var t=e.prototype;a(t)||(Object(o.a)('Pullable interface can only be applied to a Source',t instanceof s.a),t[d]=!0,t.pull=function(e,t,r){var a=Object(n.a)(e,t,r,this.queryBuilder);return this._enqueueRequest('pull',a)},t.__pull__=function(e){var t=this;return Object(i.f)(this,'beforePull',e).then(function(){return t._pull(e)}).then(function(e){return t._transformed(e)}).then(function(r){return Object(i.g)(t,'pull',e,r).then(function(){return r})}).catch(function(r){return Object(i.g)(t,'pullFail',e,r).then(function(){throw r})})})};var o=r(0),i=r(2),s=r(5),n=r(10),d='__pullable__'},function(e,t,r){'use strict';function a(e){return!!e[l]}t.b=a,t.a=function(e){var t=e.prototype;a(t)||(Object(i.a)('Pushable interface can only be applied to a Source',t instanceof n.a),t[l]=!0,t.push=function(e,t,r){var a=Object(d.a)(e,t,r,this.transformBuilder);return this.transformLog.contains(a.id)?o.a.Promise.resolve([]):this._enqueueRequest('push',a)},t.__push__=function(e){var t=this;return this.transformLog.contains(e.id)?o.a.Promise.resolve([]):Object(s.f)(this,'beforePush',e).then(function(){return t.transformLog.contains(e.id)?o.a.Promise.resolve([]):t._push(e).then(function(r){return t._transformed(r).then(function(){return Object(s.g)(t,'push',e,r)}).then(function(){return r})})}).catch(function(r){return Object(s.g)(t,'pushFail',e,r).then(function(){throw r})})})};var o=r(3),i=r(0),s=r(2),n=r(5),d=r(11),l='__pushable__'},function(e,t,r){'use strict';function a(e){return!!e[d]}t.b=a,t.a=function(e){var t=e.prototype;a(t)||(Object(o.a)('Queryable interface can only be applied to a Source',t instanceof n.a),t[d]=!0,t.query=function(e,t,r){var a=Object(s.a)(e,t,r,this.queryBuilder);return this._enqueueRequest('query',a)},t.__query__=function(e){var t=this;return Object(i.f)(this,'beforeQuery',e).then(function(){return t._query(e)}).then(function(r){return Object(i.g)(t,'query',e,r).then(function(){return r})}).catch(function(r){return Object(i.g)(t,'queryFail',e,r).then(function(){throw r})})})};var o=r(0),i=r(2),s=r(10),n=r(5),d='__queryable__'},function(e,t,r){'use strict';function a(e){return!!e[d]}t.b=a,t.a=function(e){var t=e.prototype;a(t)||(Object(i.a)('Syncable interface can only be applied to a Source',t instanceof n.a),t[d]=!0,t.sync=function(e){var t=this;if(Object(i.i)(e)){return e.reduce(function(e,r){return e.then(function(){return t.sync(r)})},o.a.Promise.resolve())}var r=e;return this.transformLog.contains(r.id)?o.a.Promise.resolve():this._enqueueSync('sync',r)},t.__sync__=function(e){var t=this;return this.transformLog.contains(e.id)?o.a.Promise.resolve():Object(s.f)(this,'beforeSync',e).then(function(){return t.transformLog.contains(e.id)?o.a.Promise.resolve():t._sync(e).then(function(){return t._transformed([e])}).then(function(){return Object(s.g)(t,'sync',e)})}).catch(function(r){return Object(s.g)(t,'syncFail',e,r).then(function(){throw r})})})};var o=r(3),i=r(0),s=r(2),n=r(5),d='__syncable__'},function(e,t,r){'use strict';function a(e){return!!e[l]}t.b=a,t.a=function(e){var t=e.prototype;a(t)||(Object(i.a)('Updatable interface can only be applied to a Source',t instanceof n.a),t[l]=!0,t.update=function(e,t,r){var a=Object(d.a)(e,t,r,this.transformBuilder);return this.transformLog.contains(a.id)?o.a.Promise.resolve():this._enqueueRequest('update',a)},t.__update__=function(e){var t=this;return this.transformLog.contains(e.id)?o.a.Promise.resolve():Object(s.f)(this,'beforeUpdate',e).then(function(){return t.transformLog.contains(e.id)?o.a.Promise.resolve():t._update(e).then(function(r){return t._transformed([e]).then(function(){return Object(s.g)(t,'update',e,r)}).then(function(){return r})})}).catch(function(r){return Object(s.g)(t,'updateFail',e,r).then(function(){throw r})})})};var o=r(3),i=r(0),s=r(2),n=r(5),d=r(11),l='__updatable__'},function(e,t,r){'use strict';var a=r(52);r.d(t,'a',function(){return a.a});var o=r(21),i=r(7),s=r(22),n=r(23),d=r(25)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=r(1),n=r(0),d=r(21),l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),p='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},c=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':p(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n},u=y=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,t),Object(n.a)('Store\'s `schema` must be specified in `settings.schema` constructor argument',!!e.schema);var r=e.keyMap,i=e.schema;e.name=e.name||'store';var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));s._transforms={},s._transformInverses={},s.transformLog.on('clear',s._logCleared,s),s.transformLog.on('truncate',s._logTruncated,s),s.transformLog.on('rollback',s._logRolledback,s);var l=e.cacheSettings||{};return l.schema=i,l.keyMap=r,l.queryBuilder=l.queryBuilder||s.queryBuilder,l.transformBuilder=l.transformBuilder||s.transformBuilder,e.base&&(s._base=e.base,s._forkPoint=s._base.transformLog.head,l.base=s._base.cache),s._cache=new d.a(l),s}return i(t,e),l(t,[{key:'upgrade',value:function(){return this._cache.upgrade(),s.o.Promise.resolve()}},{key:'_sync',value:function(e){return this._applyTransform(e),s.o.Promise.resolve()}},{key:'_update',value:function(e){var t=this._applyTransform(e);return s.o.Promise.resolve(1===t.length?t[0]:t)}},{key:'_query',value:function(e){return s.o.Promise.resolve(this._cache.query(e))}},{key:'fork',value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.schema=this._schema,e.cacheSettings=e.cacheSettings||{},e.keyMap=this._keyMap,e.queryBuilder=this.queryBuilder,e.transformBuilder=this.transformBuilder,e.base=this,new y(e)}},{key:'merge',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r;r=t.sinceTransformId?e.transformsSince(t.sinceTransformId):e.allTransforms();var a=[],o;return r.forEach(function(e){Array.prototype.push.apply(a,e.operations)}),!1!==t.coalesce&&(a=Object(s.n)(a)),o=Object(s.l)(a,t.transformOptions),this.update(o)}},{key:'rollback',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.transformLog.rollback(e,t)}},{key:'transformsSince',value:function(e){var t=this;return this.transformLog.after(e).map(function(e){return t._transforms[e]})}},{key:'allTransforms',value:function(){var e=this;return this.transformLog.entries.map(function(t){return e._transforms[t]})}},{key:'getTransform',value:function(e){return this._transforms[e]}},{key:'getInverseOperations',value:function(e){return this._transformInverses[e]}},{key:'_applyTransform',value:function(e){var t=this.cache.patch(e.operations);return this._transforms[e.id]=e,this._transformInverses[e.id]=t.inverse,t.data}},{key:'_clearTransformFromHistory',value:function(e){delete this._transforms[e],delete this._transformInverses[e]}},{key:'_logCleared',value:function(){this._transforms={},this._transformInverses={}}},{key:'_logTruncated',value:function(e,t,r){var a=this;r.forEach(function(e){return a._clearTransformFromHistory(e)})}},{key:'_logRolledback',value:function(e,t,r){var a=this;r.reverse().forEach(function(e){var t=a._transformInverses[e];t&&a.cache.patch(t),a._clearTransformFromHistory(e)})}},{key:'cache',get:function(){return this._cache}},{key:'base',get:function(){return this._base}},{key:'forkPoint',get:function(){return this._forkPoint}}]),t}(s.h);u=y=c([s.A,s.y,s.B],u),t.a=u;var y},function(e,t,r){'use strict';function a(e,t){return e.filter(function(e){for(var r=0,a=t.length;r<a;r++)if(!o(e,t[r]))return!1;return!0})}function o(e,t){if('attribute'===t.kind){var r=Object(n.e)(e,['attributes',t.attribute]),a=t.value;switch(t.op){case'equal':return r===a;case'gt':return r>a;case'gte':return r>=a;case'lt':return r<a;case'lte':return r<=a;default:throw new d.d('Filter operation ${filter.op} not recognized for Store.',t);}}return!1}function i(e,t){var r=new Map;e.forEach(function(e){r.set(e,t.map(function(t){if('attribute'===t.kind)return Object(n.e)(e,['attributes',t.attribute]);throw new d.d('Sort specifier ${sortSpecifier.kind} not recognized for Store.',t)}))});var a=t.map(function(e){return'descending'===e.order?-1:1});return e.sort(function(e,o){for(var s=r.get(e),d=r.get(o),l=0;l<t.length;l++){if(s[l]<d[l])return-a[l];if(s[l]>d[l])return a[l];if(Object(n.j)(s[l])&&!Object(n.j)(d[l]))return a[l];if(Object(n.j)(d[l])&&!Object(n.j)(s[l]))return-a[l]}return 0})}function s(e,t){if(t.limit!==void 0){var r=t.offset===void 0?0:t.offset,a=t.limit;return e.slice(r,r+a)}throw new d.d('Pagination options not recognized for Store. Please specify `offset` and `limit`.',t)}r.d(t,'a',function(){return l});var n=r(0),d=r(1),l={findRecord:function(e,t){var r=t.record,a=r.type,o=r.id,i=e.records(a).get(o);if(!i)throw new d.e(a,o);return i},findRecords:function(e,t){var r=Array.from(e.records(t.type).values());return t.filter&&(r=a(r,t.filter)),t.sort&&(r=i(r,t.sort)),t.page&&(r=s(r,t.page)),r},findRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=r.type,i=r.id,s=e.records(o).get(i),d=s&&Object(n.e)(s,['relationships',a,'data']);return d?d.map(function(t){return e.records(t.type).get(t.id)}):[]},findRelatedRecord:function(e,t){var a=t.record,o=t.relationship,i=a.type,s=a.id,d=e.records(i).get(s),l=d&&Object(n.e)(d,['relationships',o,'data']);if(!l)return null;var c=l;return e.records(c.type).get(c.id)}}},function(e,t,r){'use strict';var a=r(1),o=r(0);t.a={addRecord:function(e,t){var r=t.record,a=e.records(r.type);return a.set(r.id,r),e.keyMap&&e.keyMap.pushRecord(r),r},replaceRecord:function(e,t){var r=t.record,o=e.records(r.type),i=o.get(r.id),s=Object(a.v)(i,r);return o.set(s.id,s),e.keyMap&&e.keyMap.pushRecord(s),s},removeRecord:function(e,t){var r=t.record,a=r.type,o=r.id,i=e.records(a),s=i.get(o);return s?(i.remove(o),s):null},replaceKey:function(e,t){var r=t.record,a=r.type,i=r.id,s=e.records(a),n=s.get(i);return n=n?Object(o.c)(n):{type:a,id:i},Object(o.f)(n,['keys',t.key],t.value),s.set(i,n),e.keyMap&&e.keyMap.pushRecord(n),n},replaceAttribute:function(e,t){var r=t.record,a=r.type,i=r.id,s=e.records(a),n=s.get(i);return n=n?Object(o.c)(n):{type:a,id:i},Object(o.f)(n,['attributes',t.attribute],t.value),s.set(i,n),n},addToRelatedRecords:function(e,t){var r=t.record,a=r.type,i=r.id,s=e.records(a),n=s.get(i);n=n?Object(o.c)(n):{type:a,id:i};var d=Object(o.e)(n,['relationships',t.relationship,'data'])||[];return d.push(t.relatedRecord),Object(o.f)(n,['relationships',t.relationship,'data'],d),s.set(i,n),n},removeFromRelatedRecords:function(e,t){var r=t.record,i=r.type,s=r.id,n=e.records(i),d=n.get(s);if(d){d=Object(o.c)(d);var l=Object(o.e)(d,['relationships',t.relationship,'data']);return l&&(l=l.filter(function(e){return!Object(a.p)(e,t.relatedRecord)}),Object(o.f)(d,['relationships',t.relationship,'data'],l)&&n.set(s,d)),d}return null},replaceRelatedRecords:function(e,t){var r=t.record,a=r.type,i=r.id,s=e.records(a),n=s.get(i);return n=n?Object(o.c)(n):{type:a,id:i},Object(o.f)(n,['relationships',t.relationship,'data'],t.relatedRecords)&&s.set(i,n),n},replaceRelatedRecord:function(e,t){var r=t.record,a=r.type,i=r.id,s=e.records(a),n=s.get(i);return n=n?Object(o.c)(n):{type:a,id:i},Object(o.f)(n,['relationships',t.relationship,'data'],t.relatedRecord)&&s.set(i,n),n}}},function(e,t,r){'use strict';var a=r(0);t.a={addRecord:function(e,t){var r=t.record,o=r.type,i=r.id,s=e.records(o).get(i);return void 0===s?{op:'removeRecord',record:{type:o,id:i}}:Object(a.g)(s,t.record)?void 0:{op:'replaceRecord',record:s}},replaceRecord:function(e,t){var r=t.record,o=r.type,i=r.id,s=e.records(o).get(i);if(void 0===s)return{op:'removeRecord',record:{type:o,id:i}};var n={type:o,id:i},d=!1;if(['attributes','keys'].forEach(function(e){r[e]&&Object.keys(r[e]).forEach(function(t){var o=r[e][t],i=Object(a.e)(s,[e,t]);Object(a.g)(o,i)||(d=!0,Object(a.f)(n,[e,t],void 0===i?null:i))})}),r.relationships&&Object.keys(r.relationships).forEach(function(o){var i=Object(a.e)(s,['relationships',o]),l=r.relationships[o],c=l&&l.data,p;p=Object(a.i)(c)?e.relationships.relatedRecordsMatch(t.record,o,c):Object(a.g)(l,i),p||(d=!0,Object(a.f)(n,['relationships',o],void 0===i?null:i))}),d)return{op:'replaceRecord',record:n}},removeRecord:function(e,t){var r=t.record,a=r.type,o=r.id,i=e.records(a).get(o);if(i!==void 0)return{op:'replaceRecord',record:i}},replaceKey:function(e,t){var r=t.record,o=r.type,i=r.id,s=e.records(o).get(i),n=s&&Object(a.e)(s,['keys',t.key]);if(!Object(a.g)(n,t.value))return{op:'replaceKey',record:{type:o,id:i},key:t.key,value:n}},replaceAttribute:function(e,t){var r=t.record,o=r.type,i=r.id,s=t.attribute,n=e.records(o).get(i),d=n&&Object(a.e)(n,['attributes',s]);if(!Object(a.g)(d,t.value))return{op:'replaceAttribute',record:{type:o,id:i},attribute:s,value:d}},addToRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecord;if(!e.relationships.relationshipExists(r,a,o))return{op:'removeFromRelatedRecords',record:r,relationship:a,relatedRecord:o}},removeFromRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecord;if(e.relationships.relationshipExists(r,a,o))return{op:'addToRelatedRecords',record:r,relationship:a,relatedRecord:o}},replaceRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecords;if(!e.relationships.relatedRecordsMatch(r,a,o))return{op:'replaceRelatedRecords',record:r,relationship:a,relatedRecords:e.relationships.relatedRecords(r,a)}},replaceRelatedRecord:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecord;if(!e.relationships.relationshipExists(r,a,o))return{op:'replaceRelatedRecord',record:r,relationship:a,relatedRecord:e.relationships.relatedRecord(r,a)||null}}}},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return s});var o=r(57),i=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=function(){function e(t){a(this,e),this._data=t?t.data:new o.a}return i(e,[{key:'get',value:function(e){return this._data.get(e)}},{key:'set',value:function(e,t){this._data=this._data.set(e,t)}},{key:'remove',value:function(e){this._data=this._data.remove(e)}},{key:'has',value:function(e){return void 0!==this.get(e)}},{key:'keys',value:function(){return this._data.keys()}},{key:'values',value:function(){return this._data.values()}},{key:'size',get:function(){return this._data.size}},{key:'data',get:function(){return this._data}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e){return e&&'undefined'!=typeof Symbol&&e.constructor===Symbol?'symbol':'undefined'==typeof e?'undefined':oe(e)}function i(e){return function(){return e}}function s(e){var t='undefined'==typeof e?'undefined':o(e);if('number'===t)return e;'string'!==t&&(e+='');for(var r=0,a=0,i=e.length,s;a<i;++a)s=e.charCodeAt(a),r=0|(r<<5)-r+s;return r}function n(e){return e-=1431655765&e>>1,e=(858993459&e)+(858993459&e>>2),e=252645135&e+(e>>4),e+=e>>8,e+=e>>16,127&e}function d(e,t){return t>>>e&ne}function l(e){return 1<<e}function c(e,t){return n(e&t-1)}function p(e,t,r,a){var o=a;if(!e){var s=a.length;o=Array(s);for(var n=0;n<s;++n)o[n]=a[n]}return o[t]=r,o}function u(e,t,r){var a=r.length,o=0,i=0,s=r;if(e)o=i=t;else{for(s=Array(a-1);o<t;)s[i++]=r[o++];++o}for(;o<a;)s[i++]=r[o++];return s}function y(e,t,r,a){var o=a.length;if(e){for(var s=o;s>=t;)a[s--]=a[s];return a[t]=r,a}for(var n=0,i=0,d=Array(o+1);n<t;)d[i++]=a[n++];for(d[t]=r;n<o;)d[++i]=a[n++];return d}function _(e){return e===_e||e&&e.__hamt_isEmpty}function m(e,t,r,a){return{type:pe,edit:e,hash:t,key:r,value:a,_modify:j}}function h(e,t,r){return{type:ue,edit:e,hash:t,children:r,_modify:x}}function b(e,t,r){return{type:ye,edit:e,mask:t,children:r,_modify:E}}function g(e,t,r){return{type:he,edit:e,size:t,children:r,_modify:A}}function f(e){return e===_e||e.type===pe||e.type===ue}function v(e,t,r,a,o){for(var s=[],n=a,d=0,l=0;n;++l)1&n&&(s[l]=o[d++]),n>>>=1;return s[t]=r,g(e,d+1,s)}function k(e,t,r,a){for(var o=Array(t-1),s=0,n=0,d=0,i=a.length;d<i;++d)if(d!==r){var l=a[d];l&&!_(l)&&(o[s++]=l,n|=1<<d)}return b(e,n,o)}function R(e,t,r,a,o,i){if(r===o)return h(e,r,[i,a]);var s=d(t,r),n=d(t,o);return b(e,l(s)|l(n),s===n?[R(e,t+ie,r,a,o,i)]:s<n?[a,i]:[i,a])}function P(e,t,r,a,o,s,n,d){for(var l=o.length,c=0,i;c<l;++c)if(i=o[c],r(n,i.key)){var y=i.value,h=s(y);return h===y?o:h===ce?(--d.value,u(e,c,o)):p(e,c,m(t,a,n,h),o)}var _=s();return _===ce?o:(++d.value,p(e,l,m(t,a,n,_),o))}function O(e,t){return e===t.edit}function j(e,t,r,a,o,i,s){if(t(i,this.key)){var n=a(this.value);return n===this.value?this:n===ce?(--s.value,_e):O(e,this)?(this.value=n,this):m(e,o,i,n)}var d=a();return d===ce?this:(++s.value,R(e,r,this.hash,this,o,m(e,o,i,d)))}function x(e,t,r,a,o,i,s){if(o===this.hash){var n=O(e,this),d=P(n,e,t,this.hash,this.children,a,i,s);return d===this.children?this:1<d.length?h(e,this.hash,d):d[0]}var l=a();return l===ce?this:(++s.value,R(e,r,this.hash,this,o,m(e,o,i,l)))}function E(e,t,r,a,o,i,s){var n=this.mask,h=this.children,m=d(r,o),g=l(m),k=c(n,g),R=n&g,P=R?h[k]:_e,j=P._modify(e,t,r+ie,a,o,i,s);if(P===j)return this;var x=O(e,this),E=n,A;if(R&&_(j)){if(E&=~g,!E)return _e;if(2>=h.length&&f(h[1^k]))return h[1^k];A=u(x,k,h)}else if(!R&&!_(j)){if(h.length>=de)return v(e,m,j,n,h);E|=g,A=y(x,k,j,h)}else A=p(x,k,j,h);return x?(this.mask=E,this.children=A,this):b(e,E,A)}function A(e,t,r,a,o,i,s){var n=this.size,l=this.children,c=d(r,o),u=l[c],y=(u||_e)._modify(e,t,r+ie,a,o,i,s);if(u===y)return this;var h=O(e,this),f;if(_(u)&&!_(y))++n,f=p(h,c,y,l);else if(!_(u)&&_(y)){if(--n,n<=le)return k(e,n,c,l);f=p(h,c,_e,l)}else f=p(h,c,y,l);return h?(this.size=n,this.children=f,this):g(e,n,f)}function S(e,t,r,a){for(var o=a._root,s=0,n=a._config.keyEq;;)switch(o.type){case pe:return n(r,o.key)?o.value:e;case ue:{if(t===o.hash)for(var p=o.children,u=0,i=p.length,y;u<i;++u)if(y=p[u],n(r,y.key))return y.value;return e}case ye:{var h=d(s,t),_=l(h);if(o.mask&_){o=o.children[c(o.mask,_)],s+=ie;break}return e}case he:{if(o=o.children[d(s,t)],o){s+=ie;break}return e}default:return e;}}function T(e,t,r){return S(e,r._config.hash(t),t,r)}function I(e,t,r){return S(void 0,e,t,r)}function w(e,t,r){return S(ce,e,t,r)!==ce}function L(e,t){return w(t._config.hash(e),e,t)}function q(e,t){return e===t}function z(e){return e&&!!_(e._root)}function M(e,t,r,a){var o={value:a._size},i=a._root._modify(a._editable?a._edit:NaN,a._config.keyEq,0,e,t,r,o);return a.setTree(i,o.value)}function B(e,t,r){return M(e,r._config.hash(t),t,r)}function C(e,t,r,a){return M(i(r),e,t,a)}function F(e,t,r){return C(r._config.hash(e),e,t,r)}function U(e,t,r){return M(fe,e,t,r)}function D(e,t){return U(t._config.hash(e),e,t)}function N(e){return new be(e._editable+1,e._edit+1,e._config,e._root,e._size)}function H(e){return e._editable=e._editable&&e._editable-1,e}function Q(e,t){var r=N(t);return e(r),H(r)}function K(e){return e&&G(e[0],e[1],e[2],e[3],e[4])}function G(e,t,r,a,o){for(;r<e;){var i=t[r++];if(i&&!_(i))return $(i,a,[e,t,r,a,o])}return K(o)}function $(e,t,r){switch(e.type){case pe:return{value:t(e),rest:r};case ue:case he:case ye:var a=e.children;return G(a.length,a,0,t,r);default:return K(r);}}function J(e,t){return new ge($(e._root,t))}function Y(e){return[e.key,e.value]}function V(e){return J(e,Y)}function W(e){return e.key}function X(e){return J(e,W)}function Z(e){return e.value}function ee(e){return J(e,Z)}function te(e,t,r){var a=r._root;if(a.type===pe)return e(t,a.value,a.key);for(var o=[a.children],s;s=o.pop();)for(var n=0,i=s.length,d;n<i;)d=s[n++],d&&d.type&&(d.type===pe?t=e(t,d.value,d.key):o.push(d.children));return t}function re(e,t){return te(function(r,a,o){return e(a,o,t)},null,t)}r.d(t,'a',function(){return be});var ae=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),oe='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},ie=5,se=32,ne=se-1,de=se/2,le=se/4,ce={},pe=1,ue=2,ye=3,he=4,_e={__hamt_isEmpty:!0,_modify:function(e,t,r,a,o,i,s){var n=a();return n===ce?_e:(++s.value,m(e,o,i,n))}};var fe=i(ce);var me={done:!0};var ge=function(){function e(t){a(this,e),this[Symbol.iterator]=function(){return this},this.v=t}return ae(e,[{key:'next',value:function(){if(!this.v)return me;var e=this.v;return this.v=K(e.rest),e}}]),e}(),be=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:_e,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;a(this,e),this.isEmpty=function(){return z(this)},this[Symbol.iterator]=function(){return V(this)},this._editable=t,this._edit=r,this._config={keyEq:o&&o.keyEq||q,hash:o&&o.hash||s},this._root=i,this._size=n}return ae(e,[{key:'setTree',value:function(t,r){return this._editable?(this._root=t,this._size=r,this):t===this._root?this:new e(this._editable,this._edit,this._config,t,r)}},{key:'tryGetHash',value:function(e,t,r){return S(e,t,r,this)}},{key:'tryGet',value:function(e,t){return T(e,t,this)}},{key:'getHash',value:function(e,t){return I(e,t,this)}},{key:'get',value:function(e,t){return T(t,e,this)}},{key:'hasHash',value:function(e,t){return w(e,t,this)}},{key:'has',value:function(e){return L(e,this)}},{key:'modifyHash',value:function(e,t,r){return M(r,e,t,this)}},{key:'modify',value:function(e,t){return B(t,e,this)}},{key:'setHash',value:function(e,t,r){return C(e,t,r,this)}},{key:'set',value:function(e,t){return F(e,t,this)}},{key:'deleteHash',value:function(e,t){return U(e,t,this)}},{key:'removeHash',value:function(e,t){return U(e,t,this)}},{key:'remove',value:function(e){return D(e,this)}},{key:'beginMutation',value:function(){return N(this)}},{key:'endMutation',value:function(){return H(this)}},{key:'mutate',value:function(e){return Q(e,this)}},{key:'entries',value:function(){return V(this)}},{key:'keys',value:function(){return X(this)}},{key:'values',value:function(){return ee(this)}},{key:'fold',value:function(e,t){return te(e,t,this)}},{key:'forEach',value:function(e){return re(e,this)}},{key:'size',get:function(){return this._size}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e){var t={};return e&&Object.keys(e).forEach(function(r){var a=e[r];t[r]=a instanceof d.a?new d.a(a):a}),t}r.d(t,'a',function(){return c});var i=r(0),s=r(1),n=r(12),d=r(24),l=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),c=function(){function e(t,r){a(this,e),this._cache=t,this.reset(r)}return l(e,[{key:'reset',value:function(e){var t={};Object.keys(this._cache.schema.models).forEach(function(r){var a=e&&e._relationships[r];t[r]=new n.a(a)}),this._relationships=t}},{key:'upgrade',value:function(){var e=this;Object.keys(this._cache.schema.models).forEach(function(t){e._relationships[t]||(e._relationships[t]=new n.a)})}},{key:'relationshipExists',value:function(e,t,r){var a=this._relationships[e.type].get(e.id);if(a){var o=a[t];if(o)return o instanceof d.a?o.has(r):Object(s.p)(r,o)}return!r}},{key:'relatedRecord',value:function(e,t){var r=this._relationships[e.type].get(e.id);if(r)return r[t]}},{key:'relatedRecords',value:function(e,t){var r=this._relationships[e.type].get(e.id),a=r&&r[t];if(a)return Array.from(a.values)}},{key:'relatedRecordsMap',value:function(e,t){var r=this._relationships[e.type].get(e.id);if(r)return r[t]}},{key:'relatedRecordsMatch',value:function(e,t,r){var a=this.relatedRecordsMap(e,t);if(a){var o=new d.a;return r.forEach(function(e){return o.add(e)}),a.equals(o)}return 0===r.length}},{key:'addRecord',value:function(e){if(e.relationships){var t={};Object.keys(e.relationships).forEach(function(r){var a=e.relationships[r];if(void 0!==a.data)if(Object(i.i)(a.data)){var o=t[r]=new d.a;a.data.forEach(function(e){return o.add(e)})}else t[r]=a.data}),this._relationships[e.type].set(e.id,t)}}},{key:'replaceRecord',value:function(e){this.addRecord(e)}},{key:'clearRecord',value:function(e){this._relationships[e.type].remove(e.id)}},{key:'addToRelatedRecords',value:function(e,t,r){var a=this._relationships[e.type].get(e.id),i=a?o(a):{},s=i[t];s||(s=i[t]=new d.a),s.add(r),this._relationships[e.type].set(e.id,i)}},{key:'removeFromRelatedRecords',value:function(e,t,r){var a=this._relationships[e.type].get(e.id);if(a&&a[t]){var i=o(a),s=i[t];s.remove(r),this._relationships[e.type].set(e.id,i)}}},{key:'replaceRelatedRecords',value:function(e,t,r){var a=this._relationships[e.type].get(e.id),i=a?o(a):{},s=i[t];s||(s=i[t]=new d.a),r.forEach(function(e){return s.add(e)}),this._relationships[e.type].set(e.id,i)}},{key:'replaceRelatedRecord',value:function(e,t,r){var a=this._relationships[e.type].get(e.id);if(a&&a[t]||r){var i=a?o(a):{};i[t]=r,this._relationships[e.type].set(e.id,i)}}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}r.d(t,'a',function(){return d});var o=r(0),i=r(1),s=r(12),n=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),d=function(){function e(t,r){a(this,e),this._cache=t,this.reset(r)}return n(e,[{key:'reset',value:function(e){var t={};Object.keys(this._cache.schema.models).forEach(function(r){var a=e&&e._relationships[r];t[r]=new s.a(a)}),this._relationships=t}},{key:'upgrade',value:function(){var e=this;Object.keys(this._cache.schema.models).forEach(function(t){e._relationships[t]||(e._relationships[t]=new s.a)})}},{key:'all',value:function(e){return this._relationships[e.type].get(e.id)||[]}},{key:'recordAdded',value:function(e){var t=this,r=e.relationships,a=Object(i.m)(e);r&&Object.keys(r).forEach(function(e){var i=r[e]&&r[e].data;if(i)if(Object(o.i)(i)){i.forEach(function(r){t.add(r,{record:a,relationship:e})})}else{t.add(i,{record:a,relationship:e})}})}},{key:'recordRemoved',value:function(e){var t=this,r=this._cache.records(e.type).get(e.id),a=r&&r.relationships;a&&Object.keys(a).forEach(function(r){var i=a[r]&&a[r].data;if(i)if(Object(o.i)(i)){i.forEach(function(a){t.remove(a,{record:e,relationship:r})})}else{t.remove(i,{record:e,relationship:r})}}),this._relationships[e.type].remove(e.id)}},{key:'relatedRecordAdded',value:function(e,t,r){if(r){var a=this._cache.schema.getModel(e.type).relationships[t];if(a.inverse){var o=Object(i.m)(e);this.add(r,{record:o,relationship:t})}}}},{key:'relatedRecordsAdded',value:function(e,t,r){var a=this;if(r&&0<r.length){var o=this._cache.schema.getModel(e.type).relationships[t];if(o.inverse){var s=Object(i.m)(e);r.forEach(function(e){a.add(e,{record:s,relationship:t})})}}}},{key:'relatedRecordRemoved',value:function(e,t,r){var a=this._cache.schema.getModel(e.type).relationships[t];if(a.inverse){if(void 0===r){var i=this._cache.records(e.type).get(e.id);r=i&&Object(o.e)(i,['relationships',t,'data'])}r&&this.remove(r,{record:e,relationship:t})}}},{key:'relatedRecordsRemoved',value:function(e,t,r){var a=this,i=this._cache.schema.getModel(e.type).relationships[t];if(i.inverse){if(void 0===r){var s=this._cache.records(e.type).get(e.id);r=s&&Object(o.e)(s,['relationships',t,'data'])}r&&r.forEach(function(r){return a.remove(r,{record:e,relationship:t})})}}},{key:'add',value:function(e,t){var r=this._relationships[e.type].get(e.id);r=r?Object(o.c)(r):[],r.push(t),this._relationships[e.type].set(e.id,r)}},{key:'remove',value:function(e,t){var r=this._relationships[e.type].get(e.id);if(r){var a=r.filter(function(e){return e.record.type!==t.record.type||e.record.id!==t.record.id||e.relationship!==t.relationship});this._relationships[e.type].set(e.id,a)}}}]),e}()},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=r(8),n=r(1),d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=function e(t,r,a){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(o===void 0){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,a)}if('value'in o)return o.value;var s=o.get;return void 0===s?void 0:s.call(a)},c=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a(this,t),e.name=e.name||'log-truncation',o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),d(t,[{key:'activate',value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'activate',this).call(this,e,a).then(function(){return r._reifySources()}).then(function(){r._transformListeners={},r._sources.forEach(function(e){return r._activateSource(e)})})}},{key:'deactivate',value:function(){var e=this;return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'deactivate',this).call(this).then(function(){e._sources.forEach(function(t){return e._deactivateSource(t)}),e._transformListeners=null})}},{key:'_reifySources',value:function(){return this._sources.reduce(function(e,t){return e.then(function(){return t.transformLog.reified})},n.o.Promise.resolve())}},{key:'_review',value:function(e,t){var r=this._sources,a=!0;if(1<r.length)for(var o=0,i;o<r.length;o++)if(i=r[o],i!==e&&!i.transformLog.contains(t)){a=!1;break}return a?this._truncateSources(t,0):n.o.Promise.resolve()}},{key:'_truncateSources',value:function(e,t){return this._sources.reduce(function(r,a){return r.then(function(){return a.transformLog.truncate(e,t)})},n.o.Promise.resolve())}},{key:'_activateSource',value:function(e){var t=this,r=this._transformListeners[e.name]=function(r){return t._review(e,r.id)};e.on('transform',r)}},{key:'_deactivateSource',value:function(e){var t=this._transformListeners[e.name];e.off('transform',t),delete this._transformListeners[e.name]}}]),t}(s.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return u});var s=r(27),n=r(8),d=r(1),l=r(0),c=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),p=function e(t,r,a){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(o===void 0){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,a)}if('value'in o)return o.value;var s=o.get;return void 0===s?void 0:s.call(a)},u=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,t),e.name=e.name||'event-logging';var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._events=e.events,r._interfaces=e.interfaces,r._logPrefix=e.logPrefix||'[source-event]',r}return i(t,e),c(t,[{key:'activate',value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'activate',this).call(this,e,a).then(function(){r._eventListeners={},r._sources.forEach(function(e){return r._activateSource(e)})})}},{key:'deactivate',value:function(){var e=this;return p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'deactivate',this).call(this).then(function(){e._sources.forEach(function(t){return e._deactivateSource(t)}),e._eventListeners=null})}},{key:'_activateSource',value:function(e){var t=this;this._sourceEvents(e).forEach(function(r){t._addListener(e,r)})}},{key:'_deactivateSource',value:function(e){var t=this;this._sourceEvents(e).forEach(function(r){t._removeListener(e,r)})}},{key:'_sourceEvents',value:function(e){var t=this;if(this._events)return this._events;var r=[],a=this._interfaces||this._sourceInterfaces(e);return a.forEach(function(e){Array.prototype.push.apply(r,t._interfaceEvents(e))}),r}},{key:'_sourceInterfaces',value:function(e){var t=['transformable'];return Object(d.q)(e)&&t.push('pullable'),Object(d.r)(e)&&t.push('pushable'),Object(d.s)(e)&&t.push('queryable'),Object(d.t)(e)&&t.push('syncable'),Object(d.u)(e)&&t.push('updatable'),t}},{key:'_interfaceEvents',value:function(e){if(this._logLevel===s.a.Info)switch(e){case'pullable':return['beforePull','pull','pullFail'];case'pushable':return['beforePush','push','pushFail'];case'queryable':return['beforeQuery','query','queryFail'];case'updatable':return['beforeUpdate','update','updateFail'];case'syncable':return['beforeSync','sync','syncFail'];case'transformable':return['transform'];}else if(this._logLevel>s.a.None)switch(e){case'pullable':return['pullFail'];case'pushable':return['pushFail'];case'queryable':return['queryFail'];case'syncable':return['syncFail'];case'updatable':return['updateFail'];}}},{key:'_addListener',value:function(e,t){var r=this._generateListener(e,t);Object(l.f)(this._eventListeners,[e.name,t],r),e.on(t,r,this)}},{key:'_removeListener',value:function(e,t){var r=Object(l.e)(this._eventListeners,[e.name,t]);e.off(t,r,this),this._eventListeners[e.name][t]=null}},{key:'_generateListener',value:function(e,t){var r=this;return function(){for(var a=arguments.length,o=Array(a),i=0,s;i<a;i++)o[i]=arguments[i];(s=console).log.apply(s,[r._logPrefix,e.name,t].concat(o))}}}]),t}(n.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return n});var s=r(13),n=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),t}(s.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return d});var s=r(13),n=r(0),d=function(e){function t(e){a(this,t);var r=e;return Object(n.a)('A `source` must be specified for a SyncStrategy',!!r.source),Object(n.a)('A `target` must be specified for a SyncStrategy',!!r.target),Object(n.a)('`source` should be a Source name specified as a string','string'==typeof r.source),Object(n.a)('`target` should be a Source name specified as a string','string'==typeof r.target),r.on=r.on||'transform',r.action=r.action||'sync',o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r))}return i(t,e),t}(s.a)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'===('undefined'==typeof t?'undefined':n(t))||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof t?'undefined':n(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=r(65),n='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),d(t,[{key:'resourceRelationship',value:function(e,t){return t}},{key:'resourceAttribute',value:function(e,t){return t}},{key:'recordType',value:function(e){return e}},{key:'recordAttribute',value:function(e,t){return t}},{key:'recordRelationship',value:function(e,t){return t}}]),t}(s.a),c=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Object.assign({},e,{SerializerClass:l})))}return i(t,e),d(t,[{key:'resourcePath',value:function(e,t){var r=e.split('--');if(t){var a=this.serializer.resourceId(e,t);a&&r.push(a)}return r.join('/')}}]),t}(s.b);t.a=c},function(e,t,r){'use strict';var a=r(66);r.d(t,'b',function(){return a.a});var o=r(28);r.d(t,'a',function(){return o.a})},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=r(1),n=r(0),d=r(28),l=r(67),c=r(68),p=r(69),u=r(70),y=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),h='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},_=this&&this.__decorate||function(e,t,a,o){var s=arguments.length,n=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':h(Reflect))&&'function'==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(n=(3>s?r(n):3<s?r(t,a,n):r(t,a))||n);return 3<s&&n&&Object.defineProperty(t,a,n),n};'undefined'!=typeof s.o.globals.fetch&&s.o.fetch===void 0&&(s.o.fetch=s.o.globals.fetch);var f=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,t),Object(n.a)('JSONAPISource\'s `schema` must be specified in `settings.schema` constructor argument',!!e.schema),Object(n.a)('JSONAPISource requires Orbit.Promise be defined',s.o.Promise),Object(n.a)('JSONAPISource requires Orbit.fetch be defined',s.o.fetch),e.name=e.name||'jsonapi';var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.namespace=e.namespace,r.host=e.host,r.defaultFetchHeaders=e.defaultFetchHeaders||{Accept:'application/vnd.api+json'},r.defaultFetchTimeout=e.defaultFetchTimeout||5e3,r.maxRequestsPerTransform=e.maxRequestsPerTransform;var i=e.SerializerClass||d.a;return r.serializer=new i({schema:e.schema,keyMap:e.keyMap}),r}return i(t,e),y(t,[{key:'_push',value:function(e){var t=this,r=Object(p.b)(this,e);return this.maxRequestsPerTransform&&r.length>this.maxRequestsPerTransform?s.o.Promise.resolve().then(function(){throw new s.j('This transform requires '+r.length+' requests, which exceeds the specified limit of '+t.maxRequestsPerTransform+' requests per transform.',e)}):this._processRequests(r,p.a).then(function(t){return t.unshift(e),t})}},{key:'_pull',value:function(e){var t=c.a[e.expression.op];if(!t)throw new Error('JSONAPISource does not support the `${query.expression.op}` operator for queries.');return t(this,e)}},{key:'fetch',value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r.headers=r.headers||this.defaultFetchHeaders;var a=r.headers,o=r.method||'GET',i=r.timeout||this.defaultFetchTimeout;return r.timeout&&delete r.timeout,r.json&&(Object(n.a)('`json` and `body` can\'t both be set for fetch requests.',!r.body),r.body=JSON.stringify(r.json),delete r.json),r.body&&'GET'!==o&&(a['Content-Type']=a['Content-Type']||'application/vnd.api+json; charset=utf-8'),r.params&&(e+=-1===e.indexOf('?')?'?':'&',e+=Object(l.a)(r.params),delete r.params),i?new s.o.Promise(function(a,o){var n=s.o.globals.setTimeout(function(){d=!0,o(new s.b('No fetch response within '+i+'ms.'))},i),d;s.o.fetch(e,r).catch(function(r){if(s.o.globals.clearTimeout(n),!d)return t.handleFetchError(r)}).then(function(e){if(s.o.globals.clearTimeout(n),!d)return t.handleFetchResponse(e)}).then(a,o)}):s.o.fetch(e,r).catch(function(r){return t.handleFetchError(r)}).then(function(e){return t.handleFetchResponse(e)})}},{key:'handleFetchResponse',value:function(e){var t=this;if(201===e.status){if(this.responseHasContent(e))return e.json();throw new u.a('Server responses with a '+e.status+' status should return content with a Content-Type that includes \'application/vnd.api+json\'.')}else{if(!(200<=e.status&&300>e.status))return this.responseHasContent(e)?e.json().then(function(r){return t.handleFetchResponseError(e,r)}):this.handleFetchResponseError(e);if(this.responseHasContent(e))return e.json()}return s.o.Promise.resolve()}},{key:'handleFetchResponseError',value:function(e,t){var r;return r=400<=e.status&&500>e.status?new s.a(e.statusText):new s.g(e.statusText),r.response=e,r.data=t,s.o.Promise.reject(r)}},{key:'handleFetchError',value:function(t){var e=new s.b(t);return s.o.Promise.reject(e)}},{key:'responseHasContent',value:function(e){var t=e.headers.get('Content-Type');return t&&-1<t.indexOf('application/vnd.api+json')}},{key:'resourceNamespace',value:function(){return this.namespace}},{key:'resourceHost',value:function(){return this.host}},{key:'resourcePath',value:function(e,t){var r=[this.serializer.resourceType(e)];if(t){var a=this.serializer.resourceId(e,t);a&&r.push(a)}return r.join('/')}},{key:'resourceURL',value:function(e,t){var r=this.resourceHost(e),a=this.resourceNamespace(e),o=[];return r&&o.push(r),a&&o.push(a),o.push(this.resourcePath(e,t)),r||o.unshift(''),o.join('/')}},{key:'resourceRelationshipURL',value:function(e,t,r){return this.resourceURL(e,t)+'/relationships/'+this.serializer.resourceRelationship(e,r)}},{key:'relatedResourceURL',value:function(e,t,r){return this.resourceURL(e,t)+'/'+this.serializer.resourceRelationship(e,r)}},{key:'_processRequests',value:function(e,t){var r=this,a=[],o=s.o.Promise.resolve();return e.forEach(function(e){var i=t[e.op];o=o.then(function(){return i(r,e).then(function(e){e&&Array.prototype.push.apply(a,e)})})}),o.then(function(){return a})}}]),t}(s.h);f=_([s.w,s.x],f),t.a=f},function(e,t){'use strict';function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],o=[];return Object.keys(e).forEach(function(i){if(e.hasOwnProperty(i)){var s=t.slice();s.push(i),'object'===a(e[i])?Array.prototype.push.apply(o,r(e[i],s)):o.push({path:s,val:e[i]})}}),o}t.a=function(e){return r(e).map(function(e){if(1===e.path.length)e.path=e.path[0];else{var t=e.path[0],r=e.path.slice(1);e.path=t+'['+r.join('][')+']'}return e}).map(function(e){return encodeURIComponent(e.path)+'='+encodeURIComponent(e.val)}).join('&')};var a='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e}},function(e,t,r){'use strict';function a(e,t){var r=e.serializer.deserializeDocument(t),a=Object(n.n)(r.data);r.included&&Array.prototype.push.apply(a,r.included);var o=a.map(function(e){return{op:'replaceRecord',record:e}});return[Object(d.l)(o)]}function o(e,t){var r={},a=Object(n.e)(t,['options','sources',e.name])||{};return a.include&&(r.include=a.include.join(',')),a.timeout&&(r.timeout=a.timeout),r}function i(e,t){var r={};return t.forEach(function(t){if('attribute'===t.kind&&'equal'===t.op){var a=t,o=e.serializer.resourceAttribute(null,a.attribute);r[o]=a.value}else throw new d.d('Filter operation ${specifier.op} not recognized for JSONAPISource.',t)}),r}function s(e,t){return t.map(function(t){if('attribute'===t.kind){var r=e.serializer.resourceAttribute(null,t.attribute);return('descending'===t.order?'-':'')+r}throw new d.d('Sort specifier ${sortSpecifier.kind} not recognized for JSONAPISource.',t)}).join(',')}r.d(t,'a',function(){return c});var n=r(0),d=r(1),l=r(29),c={findRecord:function(e,t){var r=t.expression,i=r.record,s=o(e,t),n=Object(l.a)(s);return e.fetch(e.resourceURL(i.type,i.id),n).then(function(t){return a(e,t)})},findRecords:function(e,t){var r=t.expression,d=r.type,c={};r.filter&&(c.filter=i(e,r.filter)),r.sort&&(c.sort=s(e,r.sort)),r.page&&(c.page=r.page),c=Object(n.l)(c,o(e,t));var p=Object(l.a)(c);return e.fetch(e.resourceURL(d),p).then(function(t){return a(e,t)})},findRelatedRecord:function(e,t){var r=t.expression,i=r.record,s=r.relationship,n=o(e,t),d=Object(l.a)(n);return e.fetch(e.relatedResourceURL(i.type,i.id,s),d).then(function(t){return a(e,t)})},findRelatedRecords:function(e,t){var r=t.expression,i=r.record,s=r.relationship,n=o(e,t),d=Object(l.a)(n);return e.fetch(e.relatedResourceURL(i.type,i.id,s),d).then(function(t){return a(e,t)})}}},function(e,t,r){'use strict';function a(e,t,r){Object(n.f)(e,['attributes',t],r)}function o(e,t,r){Object(n.f)(e,['relationships',t,'data'],r?Object(s.m)(r):null)}function i(e,t,r){Object(n.f)(e,['relationships',t,'data'],r.map(function(e){return Object(s.m)(e)}))}r.d(t,'a',function(){return l}),t.b=function(e,t){var r=t.operations,n=[],d=t.options&&t.options.sources&&t.options.sources[e.name]||{},l;return t.operations.forEach(function(e){var t=!0,r;l&&Object(s.p)(l.record,e.record)&&('removeRecord'===e.op?(t=!1,'removeRecord'!==l.op&&(l=null,n.pop())):'addRecord'===l.op||'replaceRecord'===l.op?'replaceAttribute'===e.op?(t=!1,a(l.record,e.attribute,e.value)):'replaceRelatedRecord'===e.op?(t=!1,o(l.record,e.relationship,e.relatedRecord)):'replaceRelatedRecords'===e.op&&(t=!1,i(l.record,e.relationship,e.relatedRecords)):'addToRelatedRecords'===l.op&&'addToRelatedRecords'===e.op&&l.relationship===e.relationship&&(t=!1,l.relatedRecords.push(Object(s.m)(e.relatedRecord)))),t&&(r=c[e.op](e)),r&&(d.include&&(r.include=d.include.join(',')),d.timeout&&(r.timeout=d.timeout),n.push(r),l=r)}),n};var s=r(1),n=r(0),d=r(29),l={addRecord:function(e,t){var r=e.serializer,a=t.record,o=r.serializeDocument(a),i=Object(d.a)(t,{method:'POST',json:o});return e.fetch(e.resourceURL(a.type),i).then(function(e){var t=r.deserializeDocument(e),o=t.data,i=Object(s.z)(a,o);if(0<i.length)return[Object(s.l)(i)]})},removeRecord:function(e,t){var r=t.record,a=r.type,o=r.id,i=Object(d.a)(t,{method:'DELETE'});return e.fetch(e.resourceURL(a,o),i).then(function(){return[]})},replaceRecord:function(e,t){var r=t.record,a=r.type,o=r.id,i=e.serializer.serializeDocument(r),s=Object(d.a)(t,{method:'PATCH',json:i});return e.fetch(e.resourceURL(a,o),s).then(function(){return[]})},addToRelatedRecords:function(e,t){var r=t.record,a=r.type,o=r.id,i=t.relationship,s={data:t.relatedRecords.map(function(t){return e.serializer.resourceIdentity(t)})},n=Object(d.a)(t,{method:'POST',json:s});return e.fetch(e.resourceRelationshipURL(a,o,i),n).then(function(){return[]})},removeFromRelatedRecords:function(e,t){var r=t.record,a=r.type,o=r.id,i=t.relationship,s={data:t.relatedRecords.map(function(t){return e.serializer.resourceIdentity(t)})},n=Object(d.a)(t,{method:'DELETE',json:s});return e.fetch(e.resourceRelationshipURL(a,o,i),n).then(function(){return[]})},replaceRelatedRecord:function(e,t){var r=t.record,a=r.type,o=r.id,i=t.relationship,s=t.relatedRecord,n={data:s?e.serializer.resourceIdentity(s):null},l=Object(d.a)(t,{method:'PATCH',json:n});return e.fetch(e.resourceRelationshipURL(a,o,i),l).then(function(){return[]})},replaceRelatedRecords:function(e,t){var r=t.record,a=r.type,o=r.id,i=t.relationship,s=t.relatedRecords,n={data:s.map(function(t){return e.serializer.resourceIdentity(t)})},l=Object(d.a)(t,{method:'PATCH',json:n});return e.fetch(e.resourceRelationshipURL(a,o,i),l).then(function(){return[]})}},c={addRecord:function(e){return{op:'addRecord',record:Object(n.c)(e.record)}},removeRecord:function(e){return{op:'removeRecord',record:Object(s.m)(e.record)}},replaceAttribute:function(e){var t=Object(s.m)(e.record);return a(t,e.attribute,e.value),{op:'replaceRecord',record:t}},replaceRecord:function(e){return{op:'replaceRecord',record:Object(n.c)(e.record)}},addToRelatedRecords:function(e){return{op:'addToRelatedRecords',record:Object(s.m)(e.record),relationship:e.relationship,relatedRecords:[Object(s.m)(e.relatedRecord)]}},removeFromRelatedRecords:function(e){return{op:'removeFromRelatedRecords',record:Object(s.m)(e.record),relationship:e.relationship,relatedRecords:[Object(s.m)(e.relatedRecord)]}},replaceRelatedRecord:function(e){var t={type:e.record.type,id:e.record.id};return Object(n.f)(t,['relationships',e.relationship,'data'],e.relatedRecord),{op:'replaceRecord',record:t}},replaceRelatedRecords:function(e){var t=Object(s.m)(e.record);return Object(n.f)(t,['relationships',e.relationship,'data'],e.relatedRecords),{op:'replaceRecord',record:t}}}},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.d(t,'a',function(){return n});var s=r(2),n=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Invalid server response: '+e));return r.response=e,r}return i(t,e),t}(s.a)},function(e,t,r){r(72),e.exports=self.fetch.bind(self)},function(){(function(e){'use strict';function t(e){if('string'!=typeof e&&(e+=''),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError('Invalid character in header field name');return e.toLowerCase()}function r(e){return'string'!=typeof e&&(e+=''),e}function a(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function i(e){return e.bodyUsed?Promise.reject(new TypeError('Already read')):void(e.bodyUsed=!0)}function s(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function n(e){var t=new FileReader,r=s(t);return t.readAsArrayBuffer(e),r}function d(e){var t=new FileReader,r=s(t);return t.readAsText(e),r}function l(e){for(var t=new Uint8Array(e),r=Array(t.length),a=0;a<t.length;a++)r[a]=String.fromCharCode(t[a]);return r.join('')}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,!e)this._bodyText='';else if('string'==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(m.arrayBuffer&&m.blob&&b(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(m.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||v(e)))this._bodyArrayBuffer=c(e);else throw new Error('unsupported BodyInit type');this.headers.get('content-type')||('string'==typeof e?this.headers.set('content-type','text/plain;charset=UTF-8'):this._bodyBlob&&this._bodyBlob.type?this.headers.set('content-type',this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set('content-type','application/x-www-form-urlencoded;charset=UTF-8'))},m.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error('could not read FormData body as blob');else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(n)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return d(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error('could not read FormData body as text');else return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(e){var t=e.toUpperCase();return-1<k.indexOf(t)?t:e}function y(e,t){t=t||{};var r=t.body;if(e instanceof y){if(e.bodyUsed)throw new TypeError('Already read');this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=e+'';if(this.credentials=t.credentials||this.credentials||'omit',(t.headers||!this.headers)&&(this.headers=new o(t.headers)),this.method=u(t.method||this.method||'GET'),this.mode=t.mode||this.mode||null,this.referrer=null,('GET'===this.method||'HEAD'===this.method)&&r)throw new TypeError('Body not allowed for GET or HEAD requests');this._initBody(r)}function h(e){var t=new FormData;return e.trim().split('&').forEach(function(e){if(e){var r=e.split('='),a=r.shift().replace(/\+/g,' '),o=r.join('=').replace(/\+/g,' ');t.append(decodeURIComponent(a),decodeURIComponent(o))}}),t}function _(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var r=e.split(':'),a=r.shift().trim();if(a){var o=r.join(':').trim();t.append(a,o)}}),t}function f(e,t){t||(t={}),this.type='default',this.status='status'in t?t.status:200,this.ok=200<=this.status&&300>this.status,this.statusText='statusText'in t?t.statusText:'OK',this.headers=new o(t.headers),this.url=t.url||'',this._initBody(e)}if(!e.fetch){var m={searchParams:'URLSearchParams'in e,iterable:'Symbol'in e&&'iterator'in Symbol,blob:'FileReader'in e&&'Blob'in e&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:'FormData'in e,arrayBuffer:'ArrayBuffer'in e};if(m.arrayBuffer)var g=['[object Int8Array]','[object Uint8Array]','[object Uint8ClampedArray]','[object Int16Array]','[object Uint16Array]','[object Int32Array]','[object Uint32Array]','[object Float32Array]','[object Float64Array]'],b=function(e){return e&&DataView.prototype.isPrototypeOf(e)},v=ArrayBuffer.isView||function(e){return e&&-1<g.indexOf(Object.prototype.toString.call(e))};o.prototype.append=function(e,a){e=t(e),a=r(a);var o=this.map[e];this.map[e]=o?o+','+a:a},o.prototype['delete']=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,a){this.map[t(e)]=r(a)},o.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),a(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),a(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),a(e)},m.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var k=['DELETE','GET','HEAD','OPTIONS','POST','PUT'];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},p.call(y.prototype),p.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},f.error=function(){var e=new f(null,{status:0,statusText:''});return e.type='error',e};var R=[301,302,303,307,308];f.redirect=function(e,t){if(-1===R.indexOf(t))throw new RangeError('Invalid status code');return new f(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=y,e.Response=f,e.fetch=function(e,t){return new Promise(function(r,a){var o=new y(e,t),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:_(i.getAllResponseHeaders()||'')};e.url='responseURL'in i?i.responseURL:e.headers.get('X-Request-URL');var t='response'in i?i.response:i.responseText;r(new f(t,e))},i.onerror=function(){a(new TypeError('Network request failed'))},i.ontimeout=function(){a(new TypeError('Network request failed'))},i.open(o.method,o.url,!0),'include'===o.credentials&&(i.withCredentials=!0),'responseType'in i&&m.blob&&(i.responseType='blob'),o.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send('undefined'==typeof o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}})('undefined'==typeof self?this:self)},function(e,t,r){'use strict';var a=r(1),o=r(74),i=r.n(o),s=new a.f(i.a);t.a=s},function(e){e.exports={models:{"evaluation_criteria--evaluation_criteria":{attributes:{id:{type:'integer'},uuid:{type:'string'},text:{type:'string'},evaluation:{type:'integer'},status:{type:'boolean'},created:{type:'number'},changed:{type:'number'}},relationships:{user_id:{type:'hasOne',model:'user--user'}}},"file--file":{attributes:{fid:{type:'integer'},uuid:{type:'string'},filename:{type:'string'},uri:{type:'uri'},filemime:{type:'string'},filesize:{type:'integer'},status:{type:'boolean'},created:{type:'number'},changed:{type:'number'},url:{type:'string'}},relationships:{uid:{type:'hasOne',model:'user--user'}}},"event_recurrence--event_recurrence":{attributes:{id:{type:'integer'},uuid:{type:'string'},created:{type:'number'},changed:{type:'number'}},relationships:{user_id:{type:'hasOne',model:'user--user'}}},"media--file":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'},field_media_file:{type:'hasOne',model:'file--file'}}},"media--image":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'},field_media_caption:{type:'object'},field_media_credit:{type:'object'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'},field_media_image:{type:'hasOne',model:'file--file'}}},"media--slideshow":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'},field_media_slideshow:{type:'hasMany',model:'media--image'}}},"media--web_video":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'},field_media_caption:{type:'object'},field_media_video_embed_field:{type:'string'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'}}},"node--equipment":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_duration_min:{type:'string'},field_text_content:{type:'object'}},relationships:{uid:{type:'hasOne',model:'user--user'},field_equipment_type:{type:'hasOne',model:'taxonomy_term--equipment_type'},field_image_primary:{type:'hasOne',model:'media--image'}}},"node--event":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_capacity_max:{type:'integer'},field_date_time:{type:'object'},field_event_is_template:{type:'boolean'},field_has_waitlist:{type:'boolean'},field_must_register:{type:'boolean'},field_reservation_period:{type:'object'},field_text_content:{type:'object'},field_text_intro:{type:'object'},field_text_teaser:{type:'string'}},relationships:{uid:{type:'hasOne',model:'user--user'},field_event_audience:{type:'hasMany',model:'taxonomy_term--audience'},field_event_recurrence:{type:'hasOne',model:'event_recurrence--event_recurrence'},field_event_series:{type:'hasOne',model:'node--event_series'},field_event_subject_heading:{type:'hasMany',model:'taxonomy_term--lc_subject'},field_event_tags:{type:'hasMany',model:'taxonomy_term--tag'},field_event_type:{type:'hasMany',model:'taxonomy_term--event_type'},field_image_primary:{type:'hasOne',model:'media--image'},field_location:{type:'hasOne',model:'node--location'},field_room:{type:'hasOne',model:'node--room'}}},"node--event_series":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'}},relationships:{type:{type:'hasOne',model:'node_type--node_type'},uid:{type:'hasOne',model:'user--user'}}},"node--location":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_address:{type:'object'},field_affiliated:{type:'boolean'},field_contact_number:{type:'string'},field_location_hours:{type:'array'},field_map_link:{type:'object'},field_text_content:{type:'object'},field_text_intro:{type:'object'}},relationships:{type:{type:'hasOne',model:'node_type--node_type'},uid:{type:'hasOne',model:'user--user'},field_image_primary:{type:'hasOne',model:'media--image'}}},"node--room":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_capacity_max:{type:'integer'},field_capacity_min:{type:'integer'},field_room_fees:{type:'object'},field_room_standard_equipment:{type:'array'},field_staff_use_only:{type:'boolean'},field_text_content:{type:'object'},field_text_intro:{type:'object'},field_text_teaser:{type:'string'}},relationships:{uid:{type:'hasOne',model:'user--user'},field_image_primary:{type:'hasOne',model:'media--image'},field_location:{type:'hasOne',model:'node--location'},field_room_type:{type:'hasOne',model:'taxonomy_term--room_type'}}},"taxonomy_term--audience":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--audience'}}},"taxonomy_term--equipment_type":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--equipment_type'}}},"taxonomy_term--evaluation_criteria":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'},field_evaluation:{type:'integer'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--evaluation_criteria'}}},"taxonomy_term--event_type":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'},field_examples:{type:'string'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--event_type'}}},"taxonomy_term--lc_subject":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--lc_subject'}}},"taxonomy_term--meeting_purpose":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--meeting_purpose'}}},"taxonomy_term--population_segment":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--population_segment'}}},"taxonomy_term--room_type":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--room_type'}}},"taxonomy_term--tag":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--tag'}}},"user--user":{attributes:{uid:{type:'integer'},uuid:{type:'string'},preferred_langcode:{type:'object'},preferred_admin_langcode:{type:'object'},name:{type:'string'},pass:{type:'object'},mail:{type:'string'},timezone:{type:'string'},status:{type:'boolean'},created:{type:'number'},changed:{type:'number'},access:{type:'number'},login:{type:'number'},init:{type:'string'},path:{type:'object'}},relationships:{roles:{type:'hasMany',model:'user_role--user_role'}}},"node_type--node_type":{attributes:{uuid:{type:'string'},name:{type:'string'},type:{type:'string'}}},"user_role--user_role":{attributes:{uuid:{type:'string'},name:{type:'string'}}}}}}])});