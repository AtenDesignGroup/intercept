(function(e,t){if('object'==typeof exports&&'object'==typeof module)module.exports=t();else if('function'==typeof define&&define.amd)define([],t);else{var r=t();for(var a in r)('object'==typeof exports?exports:e)[a]=r[a]}})('undefined'==typeof self?this:self,function(){return function(e){function t(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(r,'a',r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=30)}([function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(33);Object.keys(a).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var o=r(34);Object.keys(o).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var s=r(35);Object.keys(s).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var i=r(36);Object.keys(i).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var l=r(37);Object.keys(l).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var d=r(38);Object.keys(d).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var n=r(39);Object.keys(n).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(3);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}});var o=r(17);Object.keys(o).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var s=r(43);Object.defineProperty(t,'KeyMap',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(s)['default']}});var i=r(44);Object.keys(i).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var l=r(19);Object.defineProperty(t,'QueryBuilder',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(l)['default']}});var d=r(9);Object.keys(d).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var n=r(10);Object.keys(n).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var p=r(18);Object.keys(p).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})});var c=r(45);Object.defineProperty(t,'Schema',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(c)['default']}});var u=r(5);Object.keys(u).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var y=r(11);Object.keys(y).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return y[e]}})});var h=r(20);Object.defineProperty(t,'TransformBuilder',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(h)['default']}});var f=r(46);Object.defineProperty(t,'pullable',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(f)['default']}}),Object.defineProperty(t,'isPullable',{enumerable:!0,get:function(){return f.isPullable}});var _=r(47);Object.defineProperty(t,'pushable',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(_)['default']}}),Object.defineProperty(t,'isPushable',{enumerable:!0,get:function(){return _.isPushable}});var m=r(48);Object.defineProperty(t,'queryable',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(m)['default']}}),Object.defineProperty(t,'isQueryable',{enumerable:!0,get:function(){return m.isQueryable}});var g=r(49);Object.defineProperty(t,'syncable',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(g)['default']}}),Object.defineProperty(t,'isSyncable',{enumerable:!0,get:function(){return g.isSyncable}});var v=r(50);Object.defineProperty(t,'updatable',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(v)['default']}}),Object.defineProperty(t,'isUpdatable',{enumerable:!0,get:function(){return v.isUpdatable}})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(4);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}});var o=r(40);Object.defineProperty(t,'TaskQueue',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(o)['default']}});var s=r(14);Object.defineProperty(t,'TaskProcessor',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(s)['default']}});var i=r(41);Object.defineProperty(t,'Bucket',{enumerable:!0,get:function(){return i.Bucket}});var l=r(6);Object.defineProperty(t,'evented',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(l)['default']}}),Object.defineProperty(t,'isEvented',{enumerable:!0,get:function(){return l.isEvented}}),Object.defineProperty(t,'settleInSeries',{enumerable:!0,get:function(){return l.settleInSeries}}),Object.defineProperty(t,'fulfillInSeries',{enumerable:!0,get:function(){return l.fulfillInSeries}});var d=r(16);Object.keys(d).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var n=r(15);Object.defineProperty(t,'Notifier',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(n)['default']}});var p=r(42);Object.defineProperty(t,'Log',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(p)['default']}})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(2);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}})},function(e,t,r){'use strict';(function(e){Object.defineProperty(t,'__esModule',{value:!0});var a=r(0),o='object'==('undefined'==typeof self?'undefined':babelHelpers['typeof'](self))&&self.self===self&&self||'object'==('undefined'==typeof e?'undefined':babelHelpers['typeof'](e))&&e.global===e&&e||void 0||{},s={globals:o,Promise:o.Promise,uuid:a.uuid};t['default']=s}).call(t,r(32))},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.Source=void 0;var a=r(3),o=babelHelpers.interopRequireDefault(a),s=r(2),i=r(19),l=babelHelpers.interopRequireDefault(i),d=r(20),n=babelHelpers.interopRequireDefault(d),p=r(0),c=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),this._schema=r.schema,this._keyMap=r.keyMap;var a=this._name=r.name,o=this._bucket=r.bucket;this._queryBuilder=r.queryBuilder,this._transformBuilder=r.transformBuilder,o&&(0,p.assert)('TransformLog requires a name if it has a bucket',!!a),this._transformLog=new s.Log({name:a?a+'-log':void 0,bucket:o}),this._requestQueue=new s.TaskQueue(this,{name:a?a+'-requests':void 0,bucket:o}),this._syncQueue=new s.TaskQueue(this,{name:a?a+'-sync':void 0,bucket:o}),this._schema&&(void 0===r.autoUpgrade||r.autoUpgrade)&&this._schema.on('upgrade',function(){return t.upgrade()})}return babelHelpers.createClass(e,[{key:'perform',value:function(e){var t='__'+e.type+'__';return this[t].call(this,e.data)}},{key:'upgrade',value:function(){return o['default'].Promise.resolve()}},{key:'_transformed',value:function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t._transformLog.contains(r.id)?o['default'].Promise.resolve():t._transformLog.append(r.id).then(function(){return(0,s.settleInSeries)(t,'transform',r)})})},o['default'].Promise.resolve()).then(function(){return e})}},{key:'_enqueueRequest',value:function(e,t){return this._requestQueue.push({type:e,data:t})}},{key:'_enqueueSync',value:function(e,t){return this._syncQueue.push({type:e,data:t})}},{key:'name',get:function(){return this._name}},{key:'schema',get:function(){return this._schema}},{key:'keyMap',get:function(){return this._keyMap}},{key:'bucket',get:function(){return this._bucket}},{key:'transformLog',get:function(){return this._transformLog}},{key:'requestQueue',get:function(){return this._requestQueue}},{key:'syncQueue',get:function(){return this._syncQueue}},{key:'queryBuilder',get:function(){var e=this._queryBuilder;return void 0===e&&(e=this._queryBuilder=new l['default']),e}},{key:'transformBuilder',get:function(){var e=this._transformBuilder;return void 0===e&&(e=this._transformBuilder=new n['default']({recordInitializer:this._schema})),e}}]),e}();t.Source=c=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([s.evented],c),t.Source=c},function(e,t,r){'use strict';function a(e){return!!e[c]}function o(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];void 0===e._eventedNotifiers&&(e._eventedNotifiers={});var a=e._eventedNotifiers[t];return!a&&r&&(a=e._eventedNotifiers[t]=new p['default']),a}function s(e,t){e._eventedNotifiers&&e._eventedNotifiers[t]&&delete e._eventedNotifiers[t]}function i(e,t,r,a){if(0===e.length)r();else{var o=e,s=babelHelpers.toArray(o),l;l=s[0],e=s.slice(1);var n=l,p=babelHelpers.slicedToArray(n,2),c=p[0],u=p[1],y=c.apply(u,t);if(y)return d['default'].Promise.resolve(y).then(function(){return i(e,t,r,a)})['catch'](function(e){return a(e)});i(e,t,r,a)}}Object.defineProperty(t,'__esModule',{value:!0}),t.EVENTED=void 0,t.isEvented=a,t['default']=function(e){var t=e.prototype;a(t)||(t[c]=!0,t.on=function(e,t,r){var a=r||this;o(this,e,!0).addListener(t,a)},t.off=function(e,t,r){var a=r||this,i=o(this,e);i&&(t?i.removeListener(t,a):s(this,e))},t.one=function(e,t,r){var a=r||this,s,i;i=o(this,e,!0),s=function(){t.apply(a,arguments),i.removeListener(s,a)},i.addListener(s,a)},t.emit=function(e){var t=o(this,e);if(t){for(var r=arguments.length,a=Array(1<r?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];t.emit.apply(t,a)}},t.listeners=function(e){var t=o(this,e);return t?t.listeners:[]})},t.settleInSeries=function(e,t){for(var r=arguments.length,a=Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var s=e.listeners(t);return s.reduce(function(e,t){var r=babelHelpers.slicedToArray(t,2),o=r[0],s=r[1];return e.then(function(){return o.apply(s,a)})['catch'](function(){})},d['default'].Promise.resolve())},t.fulfillInSeries=function(e,t){for(var r=arguments.length,a=Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var s=e.listeners(t);return new d['default'].Promise(function(e,t){i(s,a,e,t)})};var l=r(4),d=babelHelpers.interopRequireDefault(l),n=r(15),p=babelHelpers.interopRequireDefault(n),c=t.EVENTED='__evented__'},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});t.OperationProcessor=function(){function e(t){babelHelpers.classCallCheck(this,e),this._cache=t}return babelHelpers.createClass(e,[{key:'cache',get:function(){return this._cache}}]),babelHelpers.createClass(e,[{key:'reset',value:function(){}},{key:'upgrade',value:function(){}},{key:'validate',value:function(){}},{key:'before',value:function(){return[]}},{key:'after',value:function(){return[]}},{key:'immediate',value:function(){}},{key:'finally',value:function(){return[]}}]),e}()},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.Strategy=void 0;var a=r(1),o=babelHelpers.interopRequireDefault(a),s=r(0),i=t.Strategy=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),(0,s.assert)('Strategy requires a name',!!t.name),this._name=t.name,this._sourceNames=t.sources,this._logPrefix=t.logPrefix||'['+this._name+']',this._logLevel=this._customLogLevel=t.logLevel}return babelHelpers.createClass(e,[{key:'activate',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this._coordinator=e,void 0===this._customLogLevel&&(this._logLevel=t.logLevel),this._sources=this._sourceNames?this._sourceNames.map(function(t){return e.getSource(t)}):e.sources,o['default'].Promise.resolve()}},{key:'deactivate',value:function(){return this._coordinator=null,o['default'].Promise.resolve()}},{key:'name',get:function(){return this._name}},{key:'coordinator',get:function(){return this._coordinator}},{key:'sources',get:function(){return this._sources}},{key:'logPrefix',get:function(){return this._logPrefix}},{key:'logLevel',get:function(){return this._logLevel}}]),e}()},function(e,t,r){'use strict';function a(e){if((0,l.isObject)(e)){var t=e;return t.kind=t.kind||'attribute',t.op=t.op||'equal',t}}function o(e){if((0,l.isObject)(e)){var t=e;return t.kind=t.kind||'attribute',t.order=t.order||'ascending',t}if('string'==typeof e)return i(e);throw new Error('Sort expression must be either an object or a string.')}function i(e){var t,r;return'-'===e[0]?(t=e.slice(1),r='descending'):(t=e,r='ascending'),{kind:'attribute',attribute:t,order:r}}Object.defineProperty(t,'__esModule',{value:!0}),t.FindRecordsTerm=t.FindRelatedRecordsTerm=t.FindRelatedRecordTerm=t.FindRecordTerm=t.QueryTerm=void 0;var l=r(0),s=t.QueryTerm=function(){function e(t){babelHelpers.classCallCheck(this,e),this.expression=t}return babelHelpers.createClass(e,[{key:'toQueryExpression',value:function(){return this.expression}}]),e}(),d=t.FindRecordTerm=function(e){function t(e){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRecord',record:e}))}return babelHelpers.inherits(t,e),t}(s),n=t.FindRelatedRecordTerm=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRelatedRecord',record:e,relationship:r}))}return babelHelpers.inherits(t,e),t}(s),p=t.FindRelatedRecordsTerm=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRelatedRecords',record:e,relationship:r}))}return babelHelpers.inherits(t,e),t}(s),c=t.FindRecordsTerm=function(e){function t(e){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{op:'findRecords',type:e}))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'sort',value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=t.map(o);return this.expression.sort=(this.expression.sort||[]).concat(a),this}},{key:'page',value:function(e){return this.expression.page=e,this}},{key:'filter',value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];t.map(a);return this.expression.filter=(this.expression.filter||[]).concat(t),this}}]),t}(s)},function(e,t,r){'use strict';function a(e,t,r,o){if('function'==typeof e)return a(e(o),t,r);var d=e,n,p;if((0,l.isObject)(d)&&d.expression){if(d.id&&!t&&!r)return d;n=d.expression,p=t||d.options}else n=e instanceof i.QueryTerm?e.toQueryExpression():e,p=t;var c=r||s['default'].uuid();return{expression:n,options:p,id:c}}Object.defineProperty(t,'__esModule',{value:!0}),t.buildQuery=a;var o=r(3),s=babelHelpers.interopRequireDefault(o),i=r(9),l=r(0)},function(e,t,r){'use strict';function a(e,t,r,o){if('function'==typeof e)return a(e(o),t,r);var l=e,d,n;if((0,i.isObject)(l)&&l.operations){if(l.id&&!t&&!r)return l;d=l.operations,n=t||l.options}else d=(0,i.isArray)(e)?e:[e],n=t;var p=r||s['default'].uuid();return{operations:d,options:n,id:p}}Object.defineProperty(t,'__esModule',{value:!0}),t.buildTransform=a;var o=r(3),s=babelHelpers.interopRequireDefault(o),i=r(0)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(56);Object.defineProperty(t,'ImmutableMap',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.ConnectionStrategy=void 0;var a=r(8),o=r(0),s=t.ConnectionStrategy=function(e){function t(e){babelHelpers.classCallCheck(this,t),(0,o.assert)('A `source` must be specified for a ConnectionStrategy',!!e.source),(0,o.assert)('`source` should be a Source name specified as a string','string'==typeof e.source),(0,o.assert)('`on` should be specified as the name of the event a ConnectionStrategy listens for','string'==typeof e.on),e.sources=[e.source];var r=e.source+':'+e.on;delete e.source,e.target&&((0,o.assert)('`target` should be a Source name specified as a string','string'==typeof e.target),e.sources.push(e.target),r+=' -> '+e.target,'string'==typeof e.action&&(r+=':'+e.action),delete e.target),e.name=e.name||r;var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._event=e.on,a._action=e.action,a._catch=e['catch'],a._filter=e.filter,a._blocking=!!e.blocking,a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'activate',value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'activate',this).call(this,e,a).then(function(){r._listener=r._generateListener(),r.source.on(r._event,r._listener,r)})}},{key:'deactivate',value:function(){var e=this;return babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'deactivate',this).call(this).then(function(){e.source.off(e._event,e._listener,e),e._listener=null})}},{key:'_generateListener',value:function(){var t=this,e=this.target;return function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];var o;if(!t._filter||t._filter.apply(t,r)){if('string'==typeof t._action){var s;o=(s=t.target)[t._action].apply(s,r)}else o=t._action.apply(t,r);if(t._catch&&o&&o['catch']&&(o=o['catch'](function(a){return r.unshift(a),t._catch.apply(t,r)})),t._blocking)return o}}}},{key:'source',get:function(){return this._sources[0]}},{key:'target',get:function(){return this._sources[1]}},{key:'blocking',get:function(){return this._blocking}}]),t}(a.Strategy)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(4),o=babelHelpers.interopRequireDefault(a),s=function(){function e(t,r){babelHelpers.classCallCheck(this,e),this.target=t,this.task=r,this.reset()}return babelHelpers.createClass(e,[{key:'reset',value:function(){var t=this;this._started=!1,this._settled=!1,this._settlement=new o['default'].Promise(function(e,r){t._success=function(a){t._settled=!0,e(a)},t._fail=function(a){t._settled=!0,r(a)}})}},{key:'settle',value:function(){return this._settlement}},{key:'process',value:function(){return this._started||(this._started=!0,this.target.perform(this.task).then(this._success,this._fail)),this.settle()}},{key:'started',get:function(){return this._started}},{key:'settled',get:function(){return this._settled}}]),e}();t['default']=s},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var r=function(){function e(){babelHelpers.classCallCheck(this,e),this.listeners=[]}return babelHelpers.createClass(e,[{key:'addListener',value:function(e,t){t=t||this,this.listeners.push([e,t])}},{key:'removeListener',value:function(e,t){var r=this.listeners,a;t=t||this;for(var o=0,s=r.length;o<s;o++)if(a=r[o],a&&a[0]===e&&a[1]===t)return void r.splice(o,1)}},{key:'emit',value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.listeners.slice(0).forEach(function(e){e[0].apply(e[1],t)})}}]),e}();t['default']=r},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var r=t.Exception=function e(t){babelHelpers.classCallCheck(this,e),this.message=t,this.error=new Error(this.message),this.stack=this.error.stack},a=t.NotLoggedException=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Action not logged: '+e));return r.id=e,r}return babelHelpers.inherits(t,e),t}(r),o=t.OutOfRangeException=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Out of range: '+e));return r.value=e,r}return babelHelpers.inherits(t,e),t}(r)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.RecordAlreadyExistsException=t.RelationshipNotFoundException=t.RecordNotFoundException=t.RecordException=t.ModelNotFound=t.SchemaError=t.TransformNotAllowed=t.QueryNotAllowed=t.QueryExpressionParseError=t.NetworkError=t.ServerError=t.ClientError=void 0;var a=r(2),o=t.ClientError=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Client error: '+e));return r.description=e,r}return babelHelpers.inherits(t,e),t}(a.Exception),s=t.ServerError=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Server error: '+e));return r.description=e,r}return babelHelpers.inherits(t,e),t}(a.Exception),i=t.NetworkError=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Network error: '+e));return r.description=e,r}return babelHelpers.inherits(t,e),t}(a.Exception),l=t.QueryExpressionParseError=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Query expression parse error: '+e));return a.description=e,a.expression=r,a}return babelHelpers.inherits(t,e),t}(a.Exception),d=t.QueryNotAllowed=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Query not allowed: '+e));return a.description=e,a.query=r,a}return babelHelpers.inherits(t,e),t}(a.Exception),n=t.TransformNotAllowed=function(e){function t(e,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Transform not allowed: '+e));return a.description=e,a.transform=r,a}return babelHelpers.inherits(t,e),t}(a.Exception),p=t.SchemaError=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Schema error: '+e));return r.description=e,r}return babelHelpers.inherits(t,e),t}(a.Exception),c=t.ModelNotFound=function(e){function t(e){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Model definition for '+e+' not found'))}return babelHelpers.inherits(t,e),t}(p),u=t.RecordException=function(e){function t(e,r,a,o){babelHelpers.classCallCheck(this,t);var s=e+': '+r+':'+a;o&&(s+='/'+o);var i=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s));return i.description=e,i.type=r,i.id=a,i.relationship=o,i}return babelHelpers.inherits(t,e),t}(a.Exception),y=t.RecordNotFoundException=function(e){function t(e,r){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Record not found',e,r))}return babelHelpers.inherits(t,e),t}(u),h=t.RelationshipNotFoundException=function(e){function t(e,r,a){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Relationship not found',e,r,a))}return babelHelpers.inherits(t,e),t}(u),f=t.RecordAlreadyExistsException=function(e){function t(e,r){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Record already exists',e,r))}return babelHelpers.inherits(t,e),t}(u)},function(e,t,r){'use strict';function a(e){var t=e.type,r=e.id;return{type:t,id:r}}Object.defineProperty(t,'__esModule',{value:!0}),t.cloneRecordIdentity=a,t.equalRecordIdentities=function(e,t){return(0,o.isNone)(e)&&(0,o.isNone)(t)||(0,o.isObject)(e)&&(0,o.isObject)(t)&&e.type===t.type&&e.id===t.id},t.mergeRecords=function(e,t){if(e){var r=a(e);return['attributes','keys','relationships'].forEach(function(a){e[a]&&t[a]?r[a]=(0,o.merge)({},e[a],t[a]):e[a]?r[a]=(0,o.merge)({},e[a]):t[a]&&(r[a]=(0,o.merge)({},t[a]))}),r}return t};var o=r(0)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(9),o=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:'findRecord',value:function(e){return new a.FindRecordTerm(e)}},{key:'findRecords',value:function(e){return new a.FindRecordsTerm(e)}},{key:'findRelatedRecord',value:function(e,t){return new a.FindRelatedRecordTerm(e,t)}},{key:'findRelatedRecords',value:function(e,t){return new a.FindRelatedRecordsTerm(e,t)}}]),e}();t['default']=o},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var r=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),this._recordInitializer=t.recordInitializer}return babelHelpers.createClass(e,[{key:'addRecord',value:function(e){return this._recordInitializer&&this._recordInitializer.initializeRecord(e),{op:'addRecord',record:e}}},{key:'replaceRecord',value:function(e){return{op:'replaceRecord',record:e}}},{key:'removeRecord',value:function(e){return{op:'removeRecord',record:e}}},{key:'replaceKey',value:function(e,t,r){return{op:'replaceKey',record:e,key:t,value:r}}},{key:'replaceAttribute',value:function(e,t,r){return{op:'replaceAttribute',record:e,attribute:t,value:r}}},{key:'addToRelatedRecords',value:function(e,t,r){return{op:'addToRelatedRecords',record:e,relationship:t,relatedRecord:r}}},{key:'removeFromRelatedRecords',value:function(e,t,r){return{op:'removeFromRelatedRecords',record:e,relationship:t,relatedRecord:r}}},{key:'replaceRelatedRecords',value:function(e,t,r){return{op:'replaceRelatedRecords',record:e,relationship:t,relatedRecords:r}}},{key:'replaceRelatedRecord',value:function(e,t,r){return{op:'replaceRelatedRecord',record:e,relationship:t,relatedRecord:r}}},{key:'recordInitializer',get:function(){return this._recordInitializer}}]),e}();t['default']=r},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(0),o=r(2),s=r(1),i=r(22),l=babelHelpers.interopRequireDefault(i),d=r(23),n=babelHelpers.interopRequireDefault(d),p=r(25),c=babelHelpers.interopRequireDefault(p),u=r(53),y=r(54),h=babelHelpers.interopRequireDefault(y),f=r(55),_=babelHelpers.interopRequireDefault(f),m=r(12),g=r(58),v=babelHelpers.interopRequireDefault(g),R=r(59),b=babelHelpers.interopRequireDefault(R),k=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),this._schema=r.schema,this._keyMap=r.keyMap,this._queryBuilder=r.queryBuilder||new s.QueryBuilder,this._transformBuilder=r.transformBuilder||new s.TransformBuilder({recordInitializer:this._schema});var a=r.processors?r.processors:[c['default'],n['default'],l['default']];this._processors=a.map(function(e){return new e(t)}),this.reset(r.base)}return babelHelpers.createClass(e,[{key:'records',value:function(e){return this._records[e]}},{key:'query',value:function(e,t,r){var a=(0,s.buildQuery)(e,t,r,this._queryBuilder);return this._query(a.expression)}},{key:'reset',value:function(e){var t=this;this._records={},Object.keys(this._schema.models).forEach(function(r){var a=e&&e.records(r);t._records[r]=new m.ImmutableMap(a)}),this._relationships=new v['default'](this,e&&e.relationships),this._inverseRelationships=new b['default'](this,e&&e.inverseRelationships),this._processors.forEach(function(t){return t.reset(e)}),this.emit('reset')}},{key:'upgrade',value:function(){var e=this;Object.keys(this._schema.models).forEach(function(t){e._records[t]||(e._records[t]=new m.ImmutableMap)}),this._relationships.upgrade(),this._inverseRelationships.upgrade(),this._processors.forEach(function(e){return e.upgrade()})}},{key:'patch',value:function(e){'function'==typeof e&&(e=e(this._transformBuilder));var t={inverse:[],data:[]};return(0,a.isArray)(e)?this._applyOperations(e,t,!0):this._applyOperation(e,t,!0),t}},{key:'_applyOperations',value:function(e,t){var r=this,a=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e.forEach(function(e){return r._applyOperation(e,t,a)})}},{key:'_applyOperation',value:function(e,t){var r=this,a=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this._processors.forEach(function(t){return t.validate(e)});var o=_['default'][e.op],s=o(this,e);if(s){t.inverse.unshift(s),this._processors.map(function(t){return t.before(e)}).forEach(function(e){return r._applyOperations(e,t)});var i=this._processors.map(function(t){return t.after(e)}),l=h['default'][e.op],d=l(this,e);a&&t.data.push(d),this._processors.forEach(function(t){return t.immediate(e)}),this.emit('patch',e,d),i.forEach(function(e){return r._applyOperations(e,t)}),this._processors.map(function(t){return t['finally'](e)}).forEach(function(e){return r._applyOperations(e,t)})}else a&&t.data.push(null)}},{key:'_query',value:function(e){var t=u.QueryOperators[e.op];if(!t)throw new Error('Unable to find operator: '+e.op);return t(this,e)}},{key:'keyMap',get:function(){return this._keyMap}},{key:'schema',get:function(){return this._schema}},{key:'queryBuilder',get:function(){return this._queryBuilder}},{key:'transformBuilder',get:function(){return this._transformBuilder}},{key:'relationships',get:function(){return this._relationships}},{key:'inverseRelationships',get:function(){return this._inverseRelationships}}]),e}();k=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([o.evented],k),t['default']=k},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(1),o=r(7),s=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'after',value:function(e){switch(e.op){case'replaceRelatedRecord':return this.cache.inverseRelationships.relatedRecordRemoved(e.record,e.relationship),[];case'replaceRelatedRecords':return this.cache.inverseRelationships.relatedRecordsRemoved(e.record,e.relationship),[];case'removeFromRelatedRecords':return this.cache.inverseRelationships.relatedRecordRemoved(e.record,e.relationship,e.relatedRecord),[];case'removeRecord':var t=this.clearInverseRelationshipOps(e.record);return this.cache.inverseRelationships.recordRemoved(e.record),t;case'replaceRecord':return this.cache.inverseRelationships.recordRemoved(e.record),[];default:return[];}}},{key:'immediate',value:function(e){switch(e.op){case'replaceRelatedRecord':return void this.cache.relationships.replaceRelatedRecord(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecords':return void this.cache.relationships.replaceRelatedRecords(e.record,e.relationship,e.relatedRecords);case'addToRelatedRecords':return void this.cache.relationships.addToRelatedRecords(e.record,e.relationship,e.relatedRecord);case'removeFromRelatedRecords':return void this.cache.relationships.removeFromRelatedRecords(e.record,e.relationship,e.relatedRecord);case'addRecord':return void this.cache.relationships.addRecord(e.record);case'replaceRecord':return void this.cache.relationships.replaceRecord(e.record);case'removeRecord':return void this.cache.relationships.clearRecord(e.record);}}},{key:'finally',value:function(e){switch(e.op){case'replaceRelatedRecord':return this.cache.inverseRelationships.relatedRecordAdded(e.record,e.relationship,e.relatedRecord),[];case'replaceRelatedRecords':return this.cache.inverseRelationships.relatedRecordsAdded(e.record,e.relationship,e.relatedRecords),[];case'addToRelatedRecords':return this.cache.inverseRelationships.relatedRecordAdded(e.record,e.relationship,e.relatedRecord),[];case'addRecord':return this.cache.inverseRelationships.recordAdded(e.record),[];case'replaceRecord':return this.cache.inverseRelationships.recordAdded(e.record),[];default:return[];}}},{key:'clearInverseRelationshipOps',value:function(e){var t=this,r=[],o=this.cache.inverseRelationships.all(e);if(0<o.length){var s=(0,a.cloneRecordIdentity)(e);o.forEach(function(e){var a=t.cache.schema.getModel(e.record.type).relationships[e.relationship];'hasMany'===a.type?r.push({op:'removeFromRelatedRecords',record:e.record,relationship:e.relationship,relatedRecord:s}):r.push({op:'replaceRelatedRecord',record:e.record,relationship:e.relationship,relatedRecord:null})})}return r}}]),t}(o.OperationProcessor);t['default']=s},function(e,t,r){'use strict';function a(e){return(0,o.isArray)(e)?e:e?[e]:[]}Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var o=r(0),s=r(1),i=r(7),l=r(24),d=babelHelpers.interopRequireDefault(l),n=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'after',value:function(e){switch(e.op){case'addRecord':return this._recordAdded(e.record);case'addToRelatedRecords':return this._relatedRecordAdded(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecord':return this._relatedRecordReplaced(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecords':return this._relatedRecordsReplaced(e.record,e.relationship,e.relatedRecords);case'removeFromRelatedRecords':return this._relatedRecordRemoved(e.record,e.relationship,e.relatedRecord);case'removeRecord':return this._recordRemoved(e.record);case'replaceRecord':return this._recordReplaced(e.record);default:return[];}}},{key:'_relatedRecordAdded',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],s=o.inverse;return s&&r&&a.push(this._addRelationshipOp(r,s,e)),a}},{key:'_relatedRecordsAdded',value:function(e,t,r){var a=this,o=[],s=this.cache.schema.getModel(e.type).relationships[t],i=s.inverse;return i&&r&&0<r.length&&r.forEach(function(t){o.push(a._addRelationshipOp(t,i,e))}),o}},{key:'_relatedRecordRemoved',value:function(e,t,r){var a=[],s=this.cache.schema.getModel(e.type).relationships[t],i=s.inverse;if(i){if(void 0===r){var l=this.cache.records(e.type).get(e.id);r=l&&(0,o.deepGet)(l,['relationships',t,'data'])}r&&a.push(this._removeRelationshipOp(r,i,e))}return a}},{key:'_relatedRecordReplaced',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],i=o.inverse;if(i){var l=this.cache.relationships.relatedRecord(e,t);(0,s.equalRecordIdentities)(r,l)||(l&&a.push(this._removeRelationshipOp(l,i,e)),r&&a.push(this._addRelationshipOp(r,i,e)))}return a}},{key:'_relatedRecordsRemoved',value:function(e,t,r){var a=this,o=[],s=this.cache.schema.getModel(e.type).relationships[t],i=s.inverse;return i&&(void 0===r&&(r=this.cache.relationships.relatedRecords(e,t)),r&&r.forEach(function(t){return o.push(a._removeRelationshipOp(t,i,e))})),o}},{key:'_relatedRecordsReplaced',value:function(e,t,r){var a=[],o=this.cache.schema.getModel(e.type).relationships[t],s=this.cache.relationships.relatedRecordsMap(e,t),i;if(s){var l=new d['default'];r.forEach(function(e){return l.add(e)});var n=s.exclusiveOf(l);Array.prototype.push.apply(a,this._removeRelatedRecordsOps(e,o,n)),i=l.exclusiveOf(s)}else i=r;return Array.prototype.push.apply(a,this._addRelatedRecordsOps(e,o,i)),a}},{key:'_recordAdded',value:function(e){var t=this,r=[],o=e.relationships;if(o){var i=this.cache.schema.getModel(e.type),l=(0,s.cloneRecordIdentity)(e);Object.keys(o).forEach(function(e){var s=i.relationships[e],d=o[e]&&o[e].data,n=a(d);Array.prototype.push.apply(r,t._addRelatedRecordsOps(l,s,n))})}return r}},{key:'_recordRemoved',value:function(e){var t=this,r=[],o=this.cache.records(e.type).get(e.id),i=o&&o.relationships;if(i){var l=this.cache.schema.getModel(e.type),d=(0,s.cloneRecordIdentity)(e);Object.keys(i).forEach(function(e){var o=l.relationships[e],s=i[e]&&i[e].data,n=a(s);Array.prototype.push.apply(r,t._removeRelatedRecordsOps(d,o,n))})}return r}},{key:'_recordReplaced',value:function(e){var t=[];if(e.relationships){var r=this.cache.schema.getModel(e.type),a=(0,s.cloneRecordIdentity)(e);for(var i in e.relationships){var l=r.relationships[i],d=e&&(0,o.deepGet)(e,['relationships',i,'data']);'hasMany'===l.type?Array.prototype.push.apply(t,this._relatedRecordsReplaced(a,i,d)):Array.prototype.push.apply(t,this._relatedRecordReplaced(a,i,d))}}return t}},{key:'_addRelatedRecordsOps',value:function(e,t,r){var a=this;return 0<r.length&&t.inverse?r.map(function(r){return a._addRelationshipOp(r,t.inverse,e)}):[]}},{key:'_removeRelatedRecordsOps',value:function(e,t,r){var a=this;if(0<r.length){if('remove'===t.dependent)return this._removeDependentRecords(r);if(t.inverse)return r.map(function(r){return a._removeRelationshipOp(r,t.inverse,e)})}return[]}},{key:'_addRelationshipOp',value:function(e,t,r){var a=this.cache.schema.getModel(e.type).relationships[t],o='hasMany'===a.type;return{op:o?'addToRelatedRecords':'replaceRelatedRecord',record:e,relationship:t,relatedRecord:r}}},{key:'_removeRelationshipOp',value:function(e,t,r){var a=this.cache.schema.getModel(e.type).relationships[t],o='hasMany'===a.type;return{op:o?'removeFromRelatedRecords':'replaceRelatedRecord',record:e,relationship:t,relatedRecord:o?r:null}}},{key:'_removeDependentRecords',value:function(e){return e.map(function(e){return{op:'removeRecord',record:e}})}}]),t}(i.OperationProcessor);t['default']=n},function(e,t){'use strict';function r(e){return e.type+':'+e.id}function a(e){var t=e.split(':'),r=babelHelpers.slicedToArray(t,2),a=r[0],o=r[1];return{type:a,id:o}}Object.defineProperty(t,'__esModule',{value:!0});var o=function(){function e(t){babelHelpers.classCallCheck(this,e);var r=this.identities={};t&&Object.keys(t.identities).forEach(function(e){r[e]=!0})}return babelHelpers.createClass(e,[{key:'add',value:function(e){this.identities[r(e)]=!0}},{key:'remove',value:function(e){delete this.identities[r(e)]}},{key:'has',value:function(e){return!!e&&!!this.identities[r(e)]}},{key:'exclusiveOf',value:function(e){return Object.keys(this.identities).filter(function(t){return!e.identities[t]}).map(function(e){return a(e)})}},{key:'equals',value:function(e){return 0===this.exclusiveOf(e).length&&0===e.exclusiveOf(this).length}},{key:'values',get:function(){return Object.keys(this.identities).map(function(e){return a(e)})}}]),e}();t['default']=o},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(7),o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'validate',value:function(e){switch(e.op){case'addRecord':return this._recordAdded(e.record);case'replaceRecord':return this._recordReplaced(e.record);case'removeRecord':return this._recordRemoved(e.record);case'replaceKey':return this._keyReplaced(e.record);case'replaceAttribute':return this._attributeReplaced(e.record);case'addToRelatedRecords':return this._relatedRecordAdded(e.record,e.relationship,e.relatedRecord);case'removeFromRelatedRecords':return this._relatedRecordRemoved(e.record,e.relationship,e.relatedRecord);case'replaceRelatedRecords':return this._relatedRecordsReplaced(e.record,e.relationship,e.relatedRecords);case'replaceRelatedRecord':return this._relatedRecordReplaced(e.record,e.relationship,e.relatedRecord);default:}}},{key:'_recordAdded',value:function(e){this._validateRecord(e)}},{key:'_recordReplaced',value:function(e){this._validateRecord(e)}},{key:'_recordRemoved',value:function(e){this._validateRecordIdentity(e)}},{key:'_keyReplaced',value:function(e){this._validateRecordIdentity(e)}},{key:'_attributeReplaced',value:function(e){this._validateRecordIdentity(e)}},{key:'_relatedRecordAdded',value:function(e,t,r){this._validateRecordIdentity(e),this._validateRecordIdentity(r)}},{key:'_relatedRecordRemoved',value:function(e,t,r){this._validateRecordIdentity(e),this._validateRecordIdentity(r)}},{key:'_relatedRecordsReplaced',value:function(e,t,r){var a=this;this._validateRecordIdentity(e),r.forEach(function(e){a._validateRecordIdentity(e)})}},{key:'_relatedRecordReplaced',value:function(e,t,r){this._validateRecordIdentity(e),r&&this._validateRecordIdentity(r)}},{key:'_validateRecord',value:function(e){this._validateRecordIdentity(e)}},{key:'_validateRecordIdentity',value:function(e){this.cache.schema.getModel(e.type)}}]),t}(a.OperationProcessor);t['default']=o},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(27);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}}),Object.defineProperty(t,'LogLevel',{enumerable:!0,get:function(){return a.LogLevel}});var o=r(8);Object.keys(o).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var s=r(60);Object.keys(s).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var i=r(61);Object.keys(i).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var l=r(13);Object.keys(l).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var d=r(62);Object.keys(d).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var n=r(63);Object.keys(n).forEach(function(e){'default'===e||'__esModule'===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=t.LogLevel=void 0;var a=r(1),o=babelHelpers.interopRequireDefault(a),s=r(0),i=t.LogLevel=void 0;(function(e){e[e.None=0]='None',e[e.Errors=1]='Errors',e[e.Warnings=2]='Warnings',e[e.Info=3]='Info'})(i||(t.LogLevel=i={}));var l=function(){function e(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),this._sources={},this._strategies={},r.sources&&r.sources.forEach(function(e){return t.addSource(e)}),r.strategies&&r.strategies.forEach(function(e){return t.addStrategy(e)}),this._defaultActivationOptions=r.defaultActivationOptions||{},void 0===this._defaultActivationOptions.logLevel&&(this._defaultActivationOptions.logLevel=i.Info)}return babelHelpers.createClass(e,[{key:'addSource',value:function(e){var t=e.name;(0,s.assert)('Sources require a \'name\' to be added to a coordinator.',!!t),(0,s.assert)('A source named \''+t+'\' has already been added to this coordinator.',!this._sources[t]),(0,s.assert)('A coordinator\'s sources can not be changed while it is active.',!this._activated),this._sources[t]=e}},{key:'removeSource',value:function(e){var t=this._sources[e];(0,s.assert)('Source \''+e+'\' has not been added to this coordinator.',!!t),(0,s.assert)('A coordinator\'s sources can not be changed while it is active.',!this._activated),delete this._sources[e]}},{key:'getSource',value:function(e){return this._sources[e]}},{key:'addStrategy',value:function(e){var t=e.name;(0,s.assert)('A strategy named \''+t+'\' has already been added to this coordinator.',!this._strategies[t]),(0,s.assert)('A coordinator\'s strategies can not be changed while it is active.',!this._activated),this._strategies[t]=e}},{key:'removeStrategy',value:function(e){var t=this._strategies[e];(0,s.assert)('Strategy \''+e+'\' has not been added to this coordinator.',!!t),(0,s.assert)('A coordinator\'s strategies can not be changed while it is active.',!this._activated),delete this._strategies[e]}},{key:'getStrategy',value:function(e){return this._strategies[e]}},{key:'activate',value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._activated||(void 0===t.logLevel&&(t.logLevel=this._defaultActivationOptions.logLevel),this._currentActivationOptions=t,this._activated=this.strategies.reduce(function(r,a){return r.then(function(){return a.activate(e,t)})},o['default'].Promise.resolve())),this._activated}},{key:'deactivate',value:function(){var e=this;return this._activated?this._activated.then(function(){return e.strategies.reverse().reduce(function(e,t){return e.then(function(){return t.deactivate()})},o['default'].Promise.resolve())}).then(function(){e._activated=null}):o['default'].Promise.resolve()}},{key:'sources',get:function(){return(0,s.objectValues)(this._sources)}},{key:'sourceNames',get:function(){return Object.keys(this._sources)}},{key:'strategies',get:function(){return(0,s.objectValues)(this._strategies)}},{key:'strategyNames',get:function(){return Object.keys(this._strategies)}},{key:'activated',get:function(){return this._activated}}]),e}();t['default']=l},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(0),o=function(){function e(t){babelHelpers.classCallCheck(this,e),this._schema=t.schema,this._keyMap=t.keyMap}return babelHelpers.createClass(e,[{key:'resourceKey',value:function(){return'id'}},{key:'resourceType',value:function(e){return(0,a.dasherize)(this.schema.pluralize(e))}},{key:'resourceRelationship',value:function(e,t){return(0,a.dasherize)(t)}},{key:'resourceAttribute',value:function(e,t){return(0,a.dasherize)(t)}},{key:'resourceIdentity',value:function(e){return{type:this.resourceType(e.type),id:this.resourceId(e.type,e.id)}}},{key:'resourceIds',value:function(e,t){var r=this;return t.map(function(t){return r.resourceId(e,t)})}},{key:'resourceId',value:function(e,t){var r=this.resourceKey(e);return'id'===r?t:this.keyMap.idToKey(e,r,t)}},{key:'recordId',value:function(e,t){var r=this.resourceKey(e);if('id'===r)return t;var a=this.keyMap.keyToId(e,r,t);return a?a:this._generateNewId(e,r,t)}},{key:'recordType',value:function(e){return(0,a.camelize)(this.schema.singularize(e))}},{key:'recordIdentity',value:function(e){var t=this.recordType(e.type),r=this.recordId(t,e.id);return{type:t,id:r}}},{key:'recordAttribute',value:function(e,t){return(0,a.camelize)(t)}},{key:'recordRelationship',value:function(e,t){return(0,a.camelize)(t)}},{key:'serializeDocument',value:function(e){return{data:(0,a.isArray)(e)?this.serializeRecords(e):this.serializeRecord(e)}}},{key:'serializeRecords',value:function(e){var t=this;return e.map(function(e){return t.serializeRecord(e)})}},{key:'serializeRecord',value:function(e){var t={type:this.resourceType(e.type)};return this.serializeId(t,e),this.serializeAttributes(t,e),this.serializeRelationships(t,e),t}},{key:'serializeId',value:function(e,t){var r=this.resourceId(t.type,t.id);void 0!==r&&(e.id=r)}},{key:'serializeAttributes',value:function(e,t){var r=this;t.attributes&&Object.keys(t.attributes).forEach(function(a){r.serializeAttribute(e,t,a)})}},{key:'serializeAttribute',value:function(e,t,r){var o=t.attributes[r];void 0!==o&&(0,a.deepSet)(e,['attributes',this.resourceAttribute(t.type,r)],o)}},{key:'serializeRelationships',value:function(e,t){var r=this;t.relationships&&Object.keys(t.relationships).forEach(function(a){r.serializeRelationship(e,t,a)})}},{key:'serializeRelationship',value:function(e,t,r){var o=this,s=t.relationships[r].data;if(void 0!==s){var i=(0,a.isArray)(s)?s.map(function(e){return o.resourceIdentity(e)}):null===s?null:this.resourceIdentity(s);var l=this.resourceRelationship(t.type,r);(0,a.deepSet)(e,['relationships',l,'data'],i)}}},{key:'deserializeDocument',value:function(e){var t=e.data,r;return r=(0,a.isArray)(t)?{data:t.map(this.deserializeResource,this)}:{data:this.deserializeResource(t)},e.included&&(r.included=e.included.map(this.deserializeResource,this)),r}},{key:'deserializeResource',value:function(e){var t=this.recordType(e.type),r=this.resourceKey(t),a;if('id'===r)a={type:t,id:e.id};else{var o,s;e.id?(s=babelHelpers.defineProperty({},r,e.id),o=this.keyMap.idFromKeys(t,s)||this.schema.generateId(t)):o=this.schema.generateId(t),a={type:t,id:o},s&&(a.keys=s)}return this.deserializeAttributes(a,e),this.deserializeRelationships(a,e),this.keyMap&&this.keyMap.pushRecord(a),a}},{key:'deserializeAttributes',value:function(e,t){var r=this;t.attributes&&Object.keys(t.attributes).forEach(function(a){var o=r.recordAttribute(e.type,a);if(r.schema.hasAttribute(e.type,o)){var s=t.attributes[a];r.deserializeAttribute(e,o,s)}})}},{key:'deserializeAttribute',value:function(e,t,r){e.attributes=e.attributes||{},e.attributes[t]=r}},{key:'deserializeRelationships',value:function(e,t){var r=this;t.relationships&&Object.keys(t.relationships).forEach(function(a){var o=r.recordRelationship(e.type,a);if(r.schema.hasRelationship(e.type,o)){var s=t.relationships[a];r.deserializeRelationship(e,o,s)}})}},{key:'deserializeRelationship',value:function(e,t,r){var o=this,s=r.data;if(void 0!==s){var i;i=null===s?null:(0,a.isArray)(s)?s.map(function(e){return o.recordIdentity(e)}):this.recordIdentity(s),e.relationships=e.relationships||{},e.relationships[t]={data:i}}}},{key:'_generateNewId',value:function(e,t,r){var a=this.schema.generateId(e);return this.keyMap.pushRecord({type:e,id:a,keys:babelHelpers.defineProperty({},t,r)}),a}},{key:'schema',get:function(){return this._schema}},{key:'keyMap',get:function(){return this._keyMap}}]),e}();t['default']=o},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.buildFetchSettings=function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=['filter','include','page','sort'],o=0,s;o<r.length;o++)s=r[o],e[s]&&(0,a.deepSet)(t,['params',s],e[s]);return e.timeout&&(t.timeout=e.timeout),t};var a=r(0)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(31),o=babelHelpers.interopRequireDefault(a),s=r(26),i=new o['default']({host:''});i.coordinator.addStrategy(new s.EventLoggingStrategy),i.coordinator.activate(),window.interceptClient=i,t['default']=i},function(e,t,r){'use strict';function a(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'===('undefined'==typeof t?'undefined':babelHelpers['typeof'](t))||'function'==typeof t)?t:e}function o(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof t?'undefined':babelHelpers['typeof'](t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(t,'__esModule',{value:!0}),t.OrbitClient=void 0;var i=r(1),l=babelHelpers.interopRequireDefault(i),d=r(51),n=babelHelpers.interopRequireDefault(d),p=r(26),c=babelHelpers.interopRequireDefault(p),u=r(64),y=babelHelpers.interopRequireDefault(u),h=r(71),f=babelHelpers.interopRequireDefault(h),_=r(73),m=babelHelpers.interopRequireDefault(_);l['default'].fetch=window.fetch.bind(window);var g=t.OrbitClient=function e(t){s(this,e),this.schema=t.schema,this.strategies=t.strategies||[];var r=new n['default']({schema:m['default']});this.store=r;var a=t.sources||[r],o=new c['default']({sources:a});this.strategies.forEach(function(e){o.addStrategy(e)}),this.coordinator=o},v=function(e){function t(e){s(this,t);var r=Object.assign({schema:m['default'],namespace:'jsonapi'},e),o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r)),i=new y['default']({schema:r.schema,name:'remote',namespace:r.namespace,host:r.host});return o.coordinator.addSource(i),o.coordinator.addStrategy(new p.RequestStrategy({source:'store',on:'beforeQuery',target:'remote',action:'pull',blocking:!0})),o.coordinator.addStrategy(new p.RequestStrategy({source:'store',on:'beforeUpdate',target:'remote',action:'push',blocking:!1})),o.coordinator.addStrategy(new p.SyncStrategy({source:'remote',target:'store',blocking:!0})),o}return o(t,e),t}(g);t['default']=v},function(e){'use strict';var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(r){'object'===('undefined'==typeof window?'undefined':babelHelpers['typeof'](window))&&(t=window)}e.exports=t},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.every=function(e,t){for(var r=-1,a=e.length;++r<a;)if(!t(e[r],r))return!1;return!0},t.some=function(e,t){for(var r=-1,a=e.length;++r<a;)if(t(e[r],r))return!0;return!1},t.firstResult=function(e,t){for(var r=-1,a=e.length;++r<a;){var o=t(e[r],r);if(o)return o}}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.assert=function(e,t){if(!t)throw new Error('Assertion failed: '+e)}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.deprecate=function(e,t){if('function'==typeof t){if(t())return;}else if(t)return;console.warn(e)}},function(e,t){'use strict';function r(e,t){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;var o=Object.prototype.toString.call(e);if(o!==Object.prototype.toString.call(t))return!1;switch(o){case'[object String]':return e==t+'';case'[object Number]':return e==+e?0==e?1/e==1/t:e==+t:t!=+t;case'[object Date]':case'[object Boolean]':return+e==+t;case'[object RegExp]':return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase;}if('object'!=('undefined'==typeof e?'undefined':babelHelpers['typeof'](e))||'object'!=('undefined'==typeof t?'undefined':babelHelpers['typeof'](t)))return!1;if('[object Array]'===o&&e.length!==t.length)return!1;for(var s in t)if(t.hasOwnProperty(s)&&!r(e[s],t[s]))return!1;for(s in e)if(e.hasOwnProperty(s)&&!r(e[s],t[s]))return!1;return!0}Object.defineProperty(t,'__esModule',{value:!0}),t.eq=r},function(e,t){'use strict';function r(e){if(e===void 0||null===e||'object'!==('undefined'==typeof e?'undefined':babelHelpers['typeof'](e)))return e;var t=Object.prototype.toString.call(e),a;if('[object Date]'===t)a=new Date,a.setTime(e.getTime());else if('[object RegExp]'===t)a=e.constructor(e);else if('[object Array]'===t){a=[];for(var o=0,s=e.length;o<s;o++)e.hasOwnProperty(o)&&a.push(r(e[o]))}else{var i;for(var l in a={},e)e.hasOwnProperty(l)&&(i=e[l],'object'===('undefined'==typeof i?'undefined':babelHelpers['typeof'](i))&&(i=r(i)),a[l]=i)}return a}function a(e){return'[object Array]'===Object.prototype.toString.call(e)}function o(e){return e===void 0||null===e}Object.defineProperty(t,'__esModule',{value:!0}),t.clone=r,t.expose=function(e,t){var r;r=2<arguments.length?Array.prototype.slice.call(arguments,2):Object.keys(t),r.forEach(function(r){e[r]='function'==typeof t[r]?function(){return t[r].apply(t,arguments)}:t[r]})},t.extend=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.forEach(function(t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}),e},t.isArray=a,t.toArray=function(e){return o(e)?[]:a(e)?e:[e]},t.isObject=function(e){return null!==e&&'object'===('undefined'==typeof e?'undefined':babelHelpers['typeof'](e))},t.isNone=o,t.merge=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.forEach(function(t){Object.keys(t).forEach(function(r){if(t.hasOwnProperty(r)){var a=t[r];void 0===a&&void 0!==e[r]||(e[r]=a)}})}),e},t.deepGet=function(e,t){for(var r=-1,a=e;++r<t.length;)if(a=a[t[r]],!a)return a;return a},t.deepSet=function(e,t,r){for(var a=e,o=t.pop(),s=void 0,d=0,i=t.length;d<i;d++)s=t[d],void 0===a[s]&&(a[s]='number'==typeof s?[]:{}),a=a[s];return a[o]!==r&&(a[o]=r,!0)},t.objectValues=function(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}},function(e,t){'use strict';function r(e){return e.replace(/([a-z\d])([A-Z])/g,'$1_$2').toLowerCase()}Object.defineProperty(t,'__esModule',{value:!0}),t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.camelize=function(e){return e.replace(/(\-|\_|\.|\s)+(.)?/g,function(e,t,r){return r?r.toUpperCase():''}).replace(/(^|\/)([A-Z])/g,function(e){return e.toLowerCase()})},t.decamelize=r,t.dasherize=function(e){return r(e).replace(/[ _]/g,'-')},t.underscore=function(e){return e.replace(/([a-z\d])([A-Z]+)/g,'$1_$2').replace(/\-|\s+/g,'_').toLowerCase()}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.uuid=function(){var e=0|4294967295*Math.random(),t=0|4294967295*Math.random(),a=0|4294967295*Math.random(),o=0|4294967295*Math.random();return r[255&e]+r[255&e>>8]+r[255&e>>16]+r[255&e>>24]+'-'+r[255&t]+r[255&t>>8]+'-'+r[64|15&t>>16]+r[255&t>>24]+'-'+r[128|63&a]+r[255&a>>8]+'-'+r[255&a>>16]+r[255&a>>24]+r[255&o]+r[255&o>>8]+r[255&o>>16]+r[255&o>>24]};/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/for(var r=[],a=0;256>a;a++)r[a]=(16>a?'0':'')+a.toString(16)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(4),o=babelHelpers.interopRequireDefault(a),s=r(14),i=babelHelpers.interopRequireDefault(s),l=r(6),d=babelHelpers.interopRequireDefault(l),n=r(0),p=function(){function e(t){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};babelHelpers.classCallCheck(this,e),(0,n.assert)('TaskQueue requires Orbit.Promise to be defined',o['default'].Promise),this._performer=t,this._name=a.name,this._bucket=a.bucket,this.autoProcess=void 0===a.autoProcess||a.autoProcess,this._bucket&&(0,n.assert)('TaskQueue requires a name if it has a bucket',!!this._name),this._reify().then(function(){0<r.length&&r.autoProcess&&r.process()})}return babelHelpers.createClass(e,[{key:'push',value:function(e){var t=this,r=new i['default'](this._performer,e);return this._reified.then(function(){return t._tasks.push(e),t._processors.push(r),t._persist()}).then(function(){return t.autoProcess?t.process().then(function(){return r.settle()}):r.settle()})}},{key:'retry',value:function(){var e=this;return this._reified.then(function(){return e._cancel(),e.currentProcessor.reset(),e._persist()}).then(function(){return e.process()})}},{key:'skip',value:function(){var e=this;return this._reified.then(function(){return e._cancel(),e._tasks.shift(),e._processors.shift(),e._persist()}).then(function(){return e.process()})}},{key:'clear',value:function(){var e=this;return this._reified.then(function(){return e._cancel(),e._tasks=[],e._processors=[],e._persist()}).then(function(){return e.process()})}},{key:'shift',value:function(){var e=this,t;return this._reified.then(function(){return e._cancel(),t=e._tasks.shift(),e._processors.shift(),e._persist()}).then(function(){return t})}},{key:'unshift',value:function(e){var t=this;return this._reified.then(function(){return t._cancel(),t._tasks.unshift(e),t._processors.unshift(new i['default'](t._performer,e)),t._persist()})}},{key:'process',value:function(){var e=this;return this._reified.then(function(){var t=e._resolution;return t||(0===e._tasks.length?(t=o['default'].Promise.resolve(),e._complete()):(e._error=null,e._resolution=t=new o['default'].Promise(function(t,r){e._resolve=t,e._reject=r}),e._settleEach(t))),t})}},{key:'_complete',value:function(){this._resolve&&this._resolve(),this._resolve=null,this._reject=null,this._error=null,this._resolution=null,this.emit('complete')}},{key:'_fail',value:function(t,r){this._reject&&this._reject(r),this._resolve=null,this._reject=null,this._error=r,this._resolution=null,this.emit('fail',t,r)}},{key:'_cancel',value:function(){this._error=null,this._resolution=null}},{key:'_settleEach',value:function(t){var r=this;if(0===this._tasks.length)this._complete();else{var a=this._tasks[0],e=this._processors[0];this.emit('beforeTask',a),e.process().then(function(){t===r._resolution&&(r._tasks.shift(),r._processors.shift(),r._persist().then(function(){r.emit('task',a),r._settleEach(t)}))})['catch'](function(o){t===r._resolution&&r._fail(a,o)})}}},{key:'_reify',value:function(){var e=this;return this._tasks=[],this._processors=[],this._reified=this._bucket?this._bucket.getItem(this._name).then(function(t){t&&(e._tasks=t,e._processors=t.map(function(t){return new i['default'](e._performer,t)}))}):o['default'].Promise.resolve(),this._reified}},{key:'_persist',value:function(){return this.emit('change'),this._bucket?this._bucket.setItem(this._name,this._tasks):o['default'].Promise.resolve()}},{key:'name',get:function(){return this._name}},{key:'performer',get:function(){return this._performer}},{key:'bucket',get:function(){return this._bucket}},{key:'length',get:function(){return this._tasks?this._tasks.length:0}},{key:'entries',get:function(){return this._tasks}},{key:'current',get:function(){return this._tasks&&this._tasks[0]}},{key:'currentProcessor',get:function(){return this._processors&&this._processors[0]}},{key:'error',get:function(){return this._error}},{key:'empty',get:function(){return 0===this.length}},{key:'processing',get:function(){var e=this.currentProcessor;return void 0!==e&&e.started&&!e.settled}},{key:'reified',get:function(){return this._reified}}]),e}();p=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([d['default']],p),t['default']=p},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.Bucket=void 0;var a=r(4),o=babelHelpers.interopRequireDefault(a),s=r(6),i=babelHelpers.interopRequireDefault(s),l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),void 0===t.version&&(t.version=1),t.namespace=t.namespace||'orbit-bucket',this._applySettings(t)}return babelHelpers.createClass(e,[{key:'upgrade',value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.version&&(t.version=this._version+1),this._applySettings(t).then(function(){return e.emit('upgrade',e._version)})}},{key:'_applySettings',value:function(e){return e.name&&(this._name=e.name),e.namespace&&(this._namespace=e.namespace),this._version=e.version,o['default'].Promise.resolve()}},{key:'name',get:function(){return this._name}},{key:'namespace',get:function(){return this._namespace}},{key:'version',get:function(){return this._version}}]),e}();t.Bucket=l=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([i['default']],l),t.Bucket=l},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(0),o=r(4),s=babelHelpers.interopRequireDefault(o),i=r(6),l=babelHelpers.interopRequireDefault(i),d=r(16),n=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),this._name=t.name,this._bucket=t.bucket,this._bucket&&(0,a.assert)('Log requires a name if it has a bucket',!!this._name),this._reify(t.data)}return babelHelpers.createClass(e,[{key:'append',value:function(){for(var e=this,t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.reified.then(function(){return Array.prototype.push.apply(e._data,r),e._persist()}).then(function(){e.emit('append',r)})}},{key:'before',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this._data.indexOf(e);if(-1===r)throw new d.NotLoggedException(e);var a=r+t;if(0>a||a>=this._data.length)throw new d.OutOfRangeException(a);return this._data.slice(0,a)}},{key:'after',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=this._data.indexOf(e);if(-1===r)throw new d.NotLoggedException(e);var a=r+1+t;if(0>a||a>this._data.length)throw new d.OutOfRangeException(a);return this._data.slice(a)}},{key:'truncate',value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a;return this.reified.then(function(){var o=t._data.indexOf(e);if(-1===o)throw new d.NotLoggedException(e);var s=o+r;if(0>s||s>t._data.length)throw new d.OutOfRangeException(s);return s===t._data.length?(a=t._data,t._data=[]):(a=t._data.slice(0,s),t._data=t._data.slice(s)),t._persist()}).then(function(){t.emit('truncate',e,r,a)})}},{key:'rollback',value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a;return this.reified.then(function(){var o=t._data.indexOf(e);if(-1===o)throw new d.NotLoggedException(e);var s=o+1+r;if(0>s||s>t._data.length)throw new d.OutOfRangeException(s);return a=t._data.slice(s),t._data=t._data.slice(0,s),t._persist()}).then(function(){t.emit('rollback',e,r,a)})}},{key:'clear',value:function(){var e=this,t;return this.reified.then(function(){return t=e._data,e._data=[],e._persist()}).then(function(){return e.emit('clear',t)})}},{key:'contains',value:function(e){return-1<this._data.indexOf(e)}},{key:'_persist',value:function(){return this.emit('change'),this.bucket?this._bucket.setItem(this.name,this._data):s['default'].Promise.resolve()}},{key:'_reify',value:function(e){var t=this;!e&&this._bucket?this.reified=this._bucket.getItem(this._name).then(function(e){return t._initData(e)}):(this._initData(e),this.reified=s['default'].Promise.resolve())}},{key:'_initData',value:function(e){this._data=e?e:[]}},{key:'name',get:function(){return this._name}},{key:'bucket',get:function(){return this._bucket}},{key:'head',get:function(){return this._data[this._data.length-1]}},{key:'entries',get:function(){return this._data}},{key:'length',get:function(){return this._data.length}}]),e}();n=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([l['default']],n),t['default']=n},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(0),o=function(){function e(){babelHelpers.classCallCheck(this,e),this.reset()}return babelHelpers.createClass(e,[{key:'reset',value:function(){this._idsToKeys={},this._keysToIds={}}},{key:'idToKey',value:function(e,t,r){return(0,a.deepGet)(this._idsToKeys,[e,t,r])}},{key:'keyToId',value:function(e,t,r){return(0,a.deepGet)(this._keysToIds,[e,t,r])}},{key:'pushRecord',value:function(e){var t=this,r=e.type,o=e.id,s=e.keys;s&&o&&Object.keys(s).forEach(function(e){var i=s[e];i&&((0,a.deepSet)(t._idsToKeys,[r,e,o],i),(0,a.deepSet)(t._keysToIds,[r,e,i],o))})}},{key:'idFromKeys',value:function(e,t){var r=this,o=Object.keys(t);return(0,a.firstResult)(o,function(a){var o=t[a];if(o)return r.keyToId(e,a,o)})}}]),e}();t['default']=o},function(e,t,r){'use strict';function a(e){e._deleted=!0}function s(e){return!0===e._deleted}function o(e,t,r){(0,u.equalRecordIdentities)(e.record,t.record)&&('removeRecord'===t.op?(a(e),'addRecord'===e.op&&a(t)):!s(t)&&(r||'replaceAttribute'===t.op)&&(i(e.op)&&i(t.op)?'replaceAttribute'===e.op&&'replaceAttribute'===t.op&&e.attribute===t.attribute?a(e):'replaceRelatedRecord'===e.op&&'replaceRelatedRecord'===t.op&&e.relationship===t.relationship?a(e):'replaceRelatedRecords'===e.op&&'replaceRelatedRecords'===t.op&&e.relationship===t.relationship?a(e):('replaceAttribute'===e.op?(l(e.record,e.attribute,e.value),delete e.attribute,delete e.value):'replaceRelatedRecord'===e.op?(d(e.record,e.relationship,e.relatedRecord),delete e.relationship,delete e.relatedRecord):'replaceRelatedRecords'===e.op&&(n(e.record,e.relationship,e.relatedRecords),delete e.relationship,delete e.relatedRecords),'replaceAttribute'===t.op?l(e.record,t.attribute,t.value):'replaceRelatedRecord'===t.op?d(e.record,t.relationship,t.relatedRecord):'replaceRelatedRecords'===t.op&&n(e.record,t.relationship,t.relatedRecords),e.op='replaceRecord',a(t)):('addRecord'===e.op||'replaceRecord'===e.op)&&i(t.op)?('replaceAttribute'===t.op?l(e.record,t.attribute,t.value):'replaceRelatedRecord'===t.op?d(e.record,t.relationship,t.relatedRecord):'replaceRelatedRecords'===t.op&&n(e.record,t.relationship,t.relatedRecords),a(t)):'addToRelatedRecords'===t.op?'addRecord'===e.op?(p(e.record,t.relationship,t.relatedRecord),a(t)):'replaceRecord'===e.op&&e.record.relationships&&e.record.relationships[t.relationship]&&e.record.relationships[t.relationship].data&&(p(e.record,t.relationship,t.relatedRecord),a(t)):'removeFromRelatedRecords'===t.op&&('addToRelatedRecords'===e.op&&e.relationship===t.relationship&&(0,u.equalRecordIdentities)(e.relatedRecord,t.relatedRecord)?(a(e),a(t)):('addRecord'===e.op||'replaceRecord'===e.op)&&e.record.relationships&&e.record.relationships[t.relationship]&&e.record.relationships[t.relationship].data&&(c(e.record,t.relationship,t.relatedRecord),a(t)))))}function i(e){return'replaceAttribute'===e||'replaceRelatedRecord'===e||'replaceRelatedRecords'===e}function l(e,t,r){e.attributes=e.attributes||{},e.attributes[t]=r}function d(e,t,r){(0,y.deepSet)(e,['relationships',t,'data'],(0,u.cloneRecordIdentity)(r))}function n(e,t,r){(0,y.deepSet)(e,['relationships',t,'data'],r.map(u.cloneRecordIdentity))}function p(e,t,r){var a=(0,y.deepGet)(e,['relationships',t,'data'])||[];a.push((0,u.cloneRecordIdentity)(r)),(0,y.deepSet)(e,['relationships',t,'data'],a)}function c(e,t,a){var o=(0,y.deepGet)(e,['relationships',t,'data']);if(o)for(var s=0,i=o.length,l;s<i;s++)if(l=o[s],(0,u.equalRecordIdentities)(l,a)){o.splice(s,1);break}}Object.defineProperty(t,'__esModule',{value:!0}),t.coalesceRecordOperations=function(e){for(var t=0,r=e.length;t<r;t++)for(var a=e[t],i=!0,l=t+1,d;l<r&&(d=e[l],o(a,d,i),!s(a));l++)s(d)||(i=!1);return e.filter(function(e){return!s(e)})},t.recordDiffs=function(e,t){var r=[];if(e&&t){var a=(0,u.cloneRecordIdentity)(e);t.attributes&&Object.keys(t.attributes).forEach(function(o){var s=t.attributes[o];if(e.attributes===void 0||!(0,y.eq)(e.attributes[o],s)){r.push({op:'replaceAttribute',record:a,attribute:o,value:s})}}),t.keys&&Object.keys(t.keys).forEach(function(o){var s=t.keys[o];if(e.keys===void 0||!(0,y.eq)(e.keys[o],s)){r.push({op:'replaceKey',record:a,key:o,value:s})}})}return r};var u=r(18),y=r(0)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(3),o=babelHelpers.interopRequireDefault(a),s=r(17),i=r(2),l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e),void 0===t.version&&(t.version=1),void 0===t.models&&(t.models={}),this._applySettings(t)}return babelHelpers.createClass(e,[{key:'upgrade',value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};void 0===e.version&&(e.version=this._version+1),this._applySettings(e),this.emit('upgrade',this._version)}},{key:'_applySettings',value:function(e){this._version=e.version,e.generateId&&(this.generateId=e.generateId),e.pluralize&&(this.pluralize=e.pluralize),e.singularize&&(this.singularize=e.singularize),e.models&&(this._models=e.models)}},{key:'generateId',value:function(){return o['default'].uuid()}},{key:'pluralize',value:function(e){return e+'s'}},{key:'singularize',value:function(e){return e.lastIndexOf('s')===e.length-1?e.substr(0,e.length-1):e}},{key:'initializeRecord',value:function(e){void 0===e.id&&(e.id=this.generateId(e.type))}},{key:'getModel',value:function(e){var t=this.models[e];if(t)return t;throw new s.ModelNotFound(e)}},{key:'hasAttribute',value:function(e,t){var r=this.getModel(e);return r.attributes&&r.attributes[t]}},{key:'hasRelationship',value:function(e,t){var r=this.getModel(e);return r.relationships&&r.relationships[t]}},{key:'version',get:function(){return this._version}},{key:'models',get:function(){return this._models}}]),e}();l=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([i.evented],l),t['default']=l},function(e,t,r){'use strict';function a(e){return!!e[d]}Object.defineProperty(t,'__esModule',{value:!0}),t.PULLABLE=void 0,t.isPullable=a,t['default']=function(e){var t=e.prototype;a(t)||((0,o.assert)('Pullable interface can only be applied to a Source',t instanceof i.Source),t[d]=!0,t.pull=function(e,t,r){var a=(0,l.buildQuery)(e,t,r,this.queryBuilder);return this._enqueueRequest('pull',a)},t.__pull__=function(e){var t=this;return(0,s.fulfillInSeries)(this,'beforePull',e).then(function(){return t._pull(e)}).then(function(e){return t._transformed(e)}).then(function(r){return(0,s.settleInSeries)(t,'pull',e,r).then(function(){return r})})['catch'](function(r){return(0,s.settleInSeries)(t,'pullFail',e,r).then(function(){throw r})})})};var o=r(0),s=r(2),i=r(5),l=r(10),d=t.PULLABLE='__pullable__'},function(e,t,r){'use strict';function a(e){return!!e[p]}Object.defineProperty(t,'__esModule',{value:!0}),t.PUSHABLE=void 0,t.isPushable=a,t['default']=function(e){var t=e.prototype;a(t)||((0,i.assert)('Pushable interface can only be applied to a Source',t instanceof d.Source),t[p]=!0,t.push=function(e,t,r){var a=(0,n.buildTransform)(e,t,r,this.transformBuilder);return this.transformLog.contains(a.id)?s['default'].Promise.resolve([]):this._enqueueRequest('push',a)},t.__push__=function(e){var t=this;return this.transformLog.contains(e.id)?s['default'].Promise.resolve([]):(0,l.fulfillInSeries)(this,'beforePush',e).then(function(){return t.transformLog.contains(e.id)?s['default'].Promise.resolve([]):t._push(e).then(function(r){return t._transformed(r).then(function(){return(0,l.settleInSeries)(t,'push',e,r)}).then(function(){return r})})})['catch'](function(r){return(0,l.settleInSeries)(t,'pushFail',e,r).then(function(){throw r})})})};var o=r(3),s=babelHelpers.interopRequireDefault(o),i=r(0),l=r(2),d=r(5),n=r(11),p=t.PUSHABLE='__pushable__'},function(e,t,r){'use strict';function a(e){return!!e[d]}Object.defineProperty(t,'__esModule',{value:!0}),t.QUERYABLE=void 0,t.isQueryable=a,t['default']=function(e){var t=e.prototype;a(t)||((0,o.assert)('Queryable interface can only be applied to a Source',t instanceof l.Source),t[d]=!0,t.query=function(e,t,r){var a=(0,i.buildQuery)(e,t,r,this.queryBuilder);return this._enqueueRequest('query',a)},t.__query__=function(e){var t=this;return(0,s.fulfillInSeries)(this,'beforeQuery',e).then(function(){return t._query(e)}).then(function(r){return(0,s.settleInSeries)(t,'query',e,r).then(function(){return r})})['catch'](function(r){return(0,s.settleInSeries)(t,'queryFail',e,r).then(function(){throw r})})})};var o=r(0),s=r(2),i=r(10),l=r(5),d=t.QUERYABLE='__queryable__'},function(e,t,r){'use strict';function a(e){return!!e[n]}Object.defineProperty(t,'__esModule',{value:!0}),t.SYNCABLE=void 0,t.isSyncable=a,t['default']=function(e){var t=e.prototype;a(t)||((0,i.assert)('Syncable interface can only be applied to a Source',t instanceof d.Source),t[n]=!0,t.sync=function(e){var t=this;if((0,i.isArray)(e)){return e.reduce(function(e,r){return e.then(function(){return t.sync(r)})},s['default'].Promise.resolve())}var r=e;return this.transformLog.contains(r.id)?s['default'].Promise.resolve():this._enqueueSync('sync',r)},t.__sync__=function(e){var t=this;return this.transformLog.contains(e.id)?s['default'].Promise.resolve():(0,l.fulfillInSeries)(this,'beforeSync',e).then(function(){return t.transformLog.contains(e.id)?s['default'].Promise.resolve():t._sync(e).then(function(){return t._transformed([e])}).then(function(){return(0,l.settleInSeries)(t,'sync',e)})})['catch'](function(r){return(0,l.settleInSeries)(t,'syncFail',e,r).then(function(){throw r})})})};var o=r(3),s=babelHelpers.interopRequireDefault(o),i=r(0),l=r(2),d=r(5),n=t.SYNCABLE='__syncable__'},function(e,t,r){'use strict';function a(e){return!!e[p]}Object.defineProperty(t,'__esModule',{value:!0}),t.UPDATABLE=void 0,t.isUpdatable=a,t['default']=function(e){var t=e.prototype;a(t)||((0,i.assert)('Updatable interface can only be applied to a Source',t instanceof d.Source),t[p]=!0,t.update=function(e,t,r){var a=(0,n.buildTransform)(e,t,r,this.transformBuilder);return this.transformLog.contains(a.id)?s['default'].Promise.resolve():this._enqueueRequest('update',a)},t.__update__=function(e){var t=this;return this.transformLog.contains(e.id)?s['default'].Promise.resolve():(0,l.fulfillInSeries)(this,'beforeUpdate',e).then(function(){return t.transformLog.contains(e.id)?s['default'].Promise.resolve():t._update(e).then(function(r){return t._transformed([e]).then(function(){return(0,l.settleInSeries)(t,'update',e,r)}).then(function(){return r})})})['catch'](function(r){return(0,l.settleInSeries)(t,'updateFail',e,r).then(function(){throw r})})})};var o=r(3),s=babelHelpers.interopRequireDefault(o),i=r(0),l=r(2),d=r(5),n=r(11),p=t.UPDATABLE='__updatable__'},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(52);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}});var o=r(21);Object.defineProperty(t,'Cache',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(o)['default']}});var s=r(7);Object.defineProperty(t,'OperationProcessor',{enumerable:!0,get:function(){return s.OperationProcessor}});var i=r(22);Object.defineProperty(t,'CacheIntegrityProcessor',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(i)['default']}});var l=r(23);Object.defineProperty(t,'SchemaConsistencyProcessor',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(l)['default']}});var d=r(25);Object.defineProperty(t,'SchemaValidationProcessor',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(d)['default']}})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(1),o=babelHelpers.interopRequireDefault(a),s=r(0),i=r(21),l=babelHelpers.interopRequireDefault(i),d=n=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,t),(0,s.assert)('Store\'s `schema` must be specified in `settings.schema` constructor argument',!!e.schema);var r=e.keyMap,a=e.schema;e.name=e.name||'store';var o=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));o._transforms={},o._transformInverses={},o.transformLog.on('clear',o._logCleared,o),o.transformLog.on('truncate',o._logTruncated,o),o.transformLog.on('rollback',o._logRolledback,o);var i=e.cacheSettings||{};return i.schema=a,i.keyMap=r,i.queryBuilder=i.queryBuilder||o.queryBuilder,i.transformBuilder=i.transformBuilder||o.transformBuilder,e.base&&(o._base=e.base,o._forkPoint=o._base.transformLog.head,i.base=o._base.cache),o._cache=new l['default'](i),o}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'upgrade',value:function(){return this._cache.upgrade(),o['default'].Promise.resolve()}},{key:'_sync',value:function(e){return this._applyTransform(e),o['default'].Promise.resolve()}},{key:'_update',value:function(e){var t=this._applyTransform(e);return o['default'].Promise.resolve(1===t.length?t[0]:t)}},{key:'_query',value:function(e){return o['default'].Promise.resolve(this._cache.query(e))}},{key:'fork',value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.schema=this._schema,e.cacheSettings=e.cacheSettings||{},e.keyMap=this._keyMap,e.queryBuilder=this.queryBuilder,e.transformBuilder=this.transformBuilder,e.base=this,new n(e)}},{key:'merge',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r;r=t.sinceTransformId?e.transformsSince(t.sinceTransformId):e.allTransforms();var o=[],s;return r.forEach(function(e){Array.prototype.push.apply(o,e.operations)}),!1!==t.coalesce&&(o=(0,a.coalesceRecordOperations)(o)),s=(0,a.buildTransform)(o,t.transformOptions),this.update(s)}},{key:'rollback',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.transformLog.rollback(e,t)}},{key:'transformsSince',value:function(e){var t=this;return this.transformLog.after(e).map(function(e){return t._transforms[e]})}},{key:'allTransforms',value:function(){var e=this;return this.transformLog.entries.map(function(t){return e._transforms[t]})}},{key:'getTransform',value:function(e){return this._transforms[e]}},{key:'getInverseOperations',value:function(e){return this._transformInverses[e]}},{key:'_applyTransform',value:function(e){var t=this.cache.patch(e.operations);return this._transforms[e.id]=e,this._transformInverses[e.id]=t.inverse,t.data}},{key:'_clearTransformFromHistory',value:function(e){delete this._transforms[e],delete this._transformInverses[e]}},{key:'_logCleared',value:function(){this._transforms={},this._transformInverses={}}},{key:'_logTruncated',value:function(e,t,r){var a=this;r.forEach(function(e){return a._clearTransformFromHistory(e)})}},{key:'_logRolledback',value:function(e,t,r){var a=this;r.reverse().forEach(function(e){var t=a._transformInverses[e];t&&a.cache.patch(t),a._clearTransformFromHistory(e)})}},{key:'cache',get:function(){return this._cache}},{key:'base',get:function(){return this._base}},{key:'forkPoint',get:function(){return this._forkPoint}}]),t}(a.Source);d=n=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([a.syncable,a.queryable,a.updatable],d),t['default']=d;var n},function(e,t,r){'use strict';function a(e,t){return e.filter(function(e){for(var r=0,a=t.length;r<a;r++)if(!o(e,t[r]))return!1;return!0})}function o(e,t){if('attribute'===t.kind){var r=(0,l.deepGet)(e,['attributes',t.attribute]),a=t.value;switch(t.op){case'equal':return r===a;case'gt':return r>a;case'gte':return r>=a;case'lt':return r<a;case'lte':return r<=a;default:throw new d.QueryExpressionParseError('Filter operation ${filter.op} not recognized for Store.',t);}}return!1}function s(e,t){var r=new Map;e.forEach(function(e){r.set(e,t.map(function(t){if('attribute'===t.kind)return(0,l.deepGet)(e,['attributes',t.attribute]);throw new d.QueryExpressionParseError('Sort specifier ${sortSpecifier.kind} not recognized for Store.',t)}))});var a=t.map(function(e){return'descending'===e.order?-1:1});return e.sort(function(e,o){for(var s=r.get(e),d=r.get(o),n=0;n<t.length;n++){if(s[n]<d[n])return-a[n];if(s[n]>d[n])return a[n];if((0,l.isNone)(s[n])&&!(0,l.isNone)(d[n]))return a[n];if((0,l.isNone)(d[n])&&!(0,l.isNone)(s[n]))return-a[n]}return 0})}function i(e,t){if(t.limit!==void 0){var r=t.offset===void 0?0:t.offset,a=t.limit;return e.slice(r,r+a)}throw new d.QueryExpressionParseError('Pagination options not recognized for Store. Please specify `offset` and `limit`.',t)}Object.defineProperty(t,'__esModule',{value:!0}),t.QueryOperators=void 0;var l=r(0),d=r(1),n=t.QueryOperators={findRecord:function(e,t){var r=t.record,a=r.type,o=r.id,s=e.records(a).get(o);if(!s)throw new d.RecordNotFoundException(a,o);return s},findRecords:function(e,t){var r=Array.from(e.records(t.type).values());return t.filter&&(r=a(r,t.filter)),t.sort&&(r=s(r,t.sort)),t.page&&(r=i(r,t.page)),r},findRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=r.type,s=r.id,i=e.records(o).get(s),d=i&&(0,l.deepGet)(i,['relationships',a,'data']);return d?d.map(function(t){return e.records(t.type).get(t.id)}):[]},findRelatedRecord:function(e,t){var a=t.record,o=t.relationship,s=a.type,i=a.id,d=e.records(s).get(i),n=d&&(0,l.deepGet)(d,['relationships',o,'data']);if(!n)return null;var p=n;return e.records(p.type).get(p.id)}}},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(1),o=r(0);t['default']={addRecord:function(e,t){var r=t.record,a=e.records(r.type);return a.set(r.id,r),e.keyMap&&e.keyMap.pushRecord(r),r},replaceRecord:function(e,t){var r=t.record,o=e.records(r.type),s=o.get(r.id),i=(0,a.mergeRecords)(s,r);return o.set(i.id,i),e.keyMap&&e.keyMap.pushRecord(i),i},removeRecord:function(e,t){var r=t.record,a=r.type,o=r.id,s=e.records(a),i=s.get(o);return i?(s.remove(o),i):null},replaceKey:function(e,t){var r=t.record,a=r.type,s=r.id,i=e.records(a),l=i.get(s);return l=l?(0,o.clone)(l):{type:a,id:s},(0,o.deepSet)(l,['keys',t.key],t.value),i.set(s,l),e.keyMap&&e.keyMap.pushRecord(l),l},replaceAttribute:function(e,t){var r=t.record,a=r.type,s=r.id,i=e.records(a),l=i.get(s);return l=l?(0,o.clone)(l):{type:a,id:s},(0,o.deepSet)(l,['attributes',t.attribute],t.value),i.set(s,l),l},addToRelatedRecords:function(e,t){var r=t.record,a=r.type,s=r.id,i=e.records(a),l=i.get(s);l=l?(0,o.clone)(l):{type:a,id:s};var d=(0,o.deepGet)(l,['relationships',t.relationship,'data'])||[];return d.push(t.relatedRecord),(0,o.deepSet)(l,['relationships',t.relationship,'data'],d),i.set(s,l),l},removeFromRelatedRecords:function(e,t){var r=t.record,s=r.type,i=r.id,l=e.records(s),d=l.get(i);if(d){d=(0,o.clone)(d);var n=(0,o.deepGet)(d,['relationships',t.relationship,'data']);return n&&(n=n.filter(function(e){return!(0,a.equalRecordIdentities)(e,t.relatedRecord)}),(0,o.deepSet)(d,['relationships',t.relationship,'data'],n)&&l.set(i,d)),d}return null},replaceRelatedRecords:function(e,t){var r=t.record,a=r.type,s=r.id,i=e.records(a),l=i.get(s);return l=l?(0,o.clone)(l):{type:a,id:s},(0,o.deepSet)(l,['relationships',t.relationship,'data'],t.relatedRecords)&&i.set(s,l),l},replaceRelatedRecord:function(e,t){var r=t.record,a=r.type,s=r.id,i=e.records(a),l=i.get(s);return l=l?(0,o.clone)(l):{type:a,id:s},(0,o.deepSet)(l,['relationships',t.relationship,'data'],t.relatedRecord)&&i.set(s,l),l}}},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(0);t['default']={addRecord:function(e,t){var r=t.record,o=r.type,s=r.id,i=e.records(o).get(s);return void 0===i?{op:'removeRecord',record:{type:o,id:s}}:(0,a.eq)(i,t.record)?void 0:{op:'replaceRecord',record:i}},replaceRecord:function(e,t){var r=t.record,o=r.type,s=r.id,i=e.records(o).get(s);if(void 0===i)return{op:'removeRecord',record:{type:o,id:s}};var l={type:o,id:s},d=!1;if(['attributes','keys'].forEach(function(e){r[e]&&Object.keys(r[e]).forEach(function(t){var o=r[e][t],s=(0,a.deepGet)(i,[e,t]);(0,a.eq)(o,s)||(d=!0,(0,a.deepSet)(l,[e,t],void 0===s?null:s))})}),r.relationships&&Object.keys(r.relationships).forEach(function(o){var s=(0,a.deepGet)(i,['relationships',o]),n=r.relationships[o],p=n&&n.data,c;c=(0,a.isArray)(p)?e.relationships.relatedRecordsMatch(t.record,o,p):(0,a.eq)(n,s),c||(d=!0,(0,a.deepSet)(l,['relationships',o],void 0===s?null:s))}),d)return{op:'replaceRecord',record:l}},removeRecord:function(e,t){var r=t.record,a=r.type,o=r.id,s=e.records(a).get(o);if(s!==void 0)return{op:'replaceRecord',record:s}},replaceKey:function(e,t){var r=t.record,o=r.type,s=r.id,i=e.records(o).get(s),l=i&&(0,a.deepGet)(i,['keys',t.key]);if(!(0,a.eq)(l,t.value))return{op:'replaceKey',record:{type:o,id:s},key:t.key,value:l}},replaceAttribute:function(e,t){var r=t.record,o=r.type,s=r.id,i=t.attribute,l=e.records(o).get(s),d=l&&(0,a.deepGet)(l,['attributes',i]);if(!(0,a.eq)(d,t.value))return{op:'replaceAttribute',record:{type:o,id:s},attribute:i,value:d}},addToRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecord;if(!e.relationships.relationshipExists(r,a,o))return{op:'removeFromRelatedRecords',record:r,relationship:a,relatedRecord:o}},removeFromRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecord;if(e.relationships.relationshipExists(r,a,o))return{op:'addToRelatedRecords',record:r,relationship:a,relatedRecord:o}},replaceRelatedRecords:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecords;if(!e.relationships.relatedRecordsMatch(r,a,o))return{op:'replaceRelatedRecords',record:r,relationship:a,relatedRecords:e.relationships.relatedRecords(r,a)}},replaceRelatedRecord:function(e,t){var r=t.record,a=t.relationship,o=t.relatedRecord;if(!e.relationships.relationshipExists(r,a,o))return{op:'replaceRelatedRecord',record:r,relationship:a,relatedRecord:e.relationships.relatedRecord(r,a)||null}}}},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(57),o=babelHelpers.interopRequireDefault(a),s=function(){function e(t){babelHelpers.classCallCheck(this,e),this._data=t?t.data:new o['default']}return babelHelpers.createClass(e,[{key:'get',value:function(e){return this._data.get(e)}},{key:'set',value:function(e,t){this._data=this._data.set(e,t)}},{key:'remove',value:function(e){this._data=this._data.remove(e)}},{key:'has',value:function(e){return void 0!==this.get(e)}},{key:'keys',value:function(){return this._data.keys()}},{key:'values',value:function(){return this._data.values()}},{key:'size',get:function(){return this._data.size}},{key:'data',get:function(){return this._data}}]),e}();t['default']=s},function(e,t){'use strict';function r(e){return e&&'undefined'!=typeof Symbol&&e.constructor===Symbol?'symbol':'undefined'==typeof e?'undefined':babelHelpers['typeof'](e)}function a(e){return function(){return e}}function o(e){var t='undefined'==typeof e?'undefined':r(e);if('number'===t)return e;'string'!==t&&(e+='');for(var a=0,o=0,s=e.length,i;o<s;++o)i=e.charCodeAt(o),a=0|(a<<5)-a+i;return a}function s(e){return e-=1431655765&e>>1,e=(858993459&e)+(858993459&e>>2),e=252645135&e+(e>>4),e+=e>>8,e+=e>>16,127&e}function i(e,t){return t>>>e&ae}function l(e){return 1<<e}function d(e,t){return s(e&t-1)}function n(e,t,r,a){var o=a;if(!e){var s=a.length;o=Array(s);for(var l=0;l<s;++l)o[l]=a[l]}return o[t]=r,o}function p(e,t,r){var a=r.length,o=0,s=0,i=r;if(e)o=s=t;else{for(i=Array(a-1);o<t;)i[s++]=r[o++];++o}for(;o<a;)i[s++]=r[o++];return i}function c(e,t,r,a){var o=a.length;if(e){for(var s=o;s>=t;)a[s--]=a[s];return a[t]=r,a}for(var l=0,i=0,d=Array(o+1);l<t;)d[i++]=a[l++];for(d[t]=r;l<o;)d[++i]=a[l++];return d}function u(e){return e===ce||e&&e.__hamt_isEmpty}function y(e,t,r,a){return{type:le,edit:e,hash:t,key:r,value:a,_modify:k}}function h(e,t,r){return{type:de,edit:e,hash:t,children:r,_modify:E}}function _(e,t,r){return{type:ne,edit:e,mask:t,children:r,_modify:S}}function m(e,t,r){return{type:pe,edit:e,size:t,children:r,_modify:C}}function f(e){return e===ce||e.type===le||e.type===de}function g(e,t,r,a,o){for(var s=[],l=a,d=0,n=0;l;++n)1&l&&(s[n]=o[d++]),l>>>=1;return s[t]=r,m(e,d+1,s)}function v(e,t,r,a){for(var o=Array(t-1),s=0,l=0,d=0,i=a.length;d<i;++d)if(d!==r){var n=a[d];n&&!u(n)&&(o[s++]=n,l|=1<<d)}return _(e,l,o)}function R(e,t,r,a,o,s){if(r===o)return h(e,r,[s,a]);var d=i(t,r),n=i(t,o);return _(e,l(d)|l(n),d===n?[R(e,t+te,r,a,o,s)]:d<n?[a,s]:[s,a])}function b(e,t,r,a,o,s,l,d){for(var c=o.length,u=0,i;u<c;++u)if(i=o[u],r(l,i.key)){var h=i.value,f=s(h);return f===h?o:f===ie?(--d.value,p(e,u,o)):n(e,u,y(t,a,l,f),o)}var _=s();return _===ie?o:(++d.value,n(e,c,y(t,a,l,_),o))}function P(e,t){return e===t.edit}function k(e,t,r,a,o,s,i){if(t(s,this.key)){var l=a(this.value);return l===this.value?this:l===ie?(--i.value,ce):P(e,this)?(this.value=l,this):y(e,o,s,l)}var d=a();return d===ie?this:(++i.value,R(e,r,this.hash,this,o,y(e,o,s,d)))}function E(e,t,r,a,o,s,i){if(o===this.hash){var l=P(e,this),d=b(l,e,t,this.hash,this.children,a,s,i);return d===this.children?this:1<d.length?h(e,this.hash,d):d[0]}var n=a();return n===ie?this:(++i.value,R(e,r,this.hash,this,o,y(e,o,s,n)))}function S(e,t,r,a,o,s,y){var h=this.mask,m=this.children,v=i(r,o),R=l(v),b=d(h,R),k=h&R,E=k?m[b]:ce,S=E._modify(e,t,r+te,a,o,s,y);if(E===S)return this;var C=P(e,this),O=h,q;if(k&&u(S)){if(O&=~R,!O)return ce;if(2>=m.length&&f(m[1^b]))return m[1^b];q=p(C,b,m)}else if(!k&&!u(S)){if(m.length>=oe)return g(e,v,S,h,m);O|=R,q=c(C,b,S,m)}else q=n(C,b,S,m);return C?(this.mask=O,this.children=q,this):_(e,O,q)}function C(e,t,r,a,o,s,l){var d=this.size,p=this.children,c=i(r,o),y=p[c],h=(y||ce)._modify(e,t,r+te,a,o,s,l);if(y===h)return this;var f=P(e,this),_;if(u(y)&&!u(h))++d,_=n(f,c,h,p);else if(!u(y)&&u(h)){if(--d,d<=se)return v(e,d,c,p);_=n(f,c,ce,p)}else _=n(f,c,h,p);return f?(this.size=d,this.children=_,this):m(e,d,_)}function O(e,t,r,a){for(var o=a._root,s=0,n=a._config.keyEq;;)switch(o.type){case le:return n(r,o.key)?o.value:e;case de:{if(t===o.hash)for(var p=o.children,c=0,u=p.length,y;c<u;++c)if(y=p[c],n(r,y.key))return y.value;return e}case ne:{var h=i(s,t),f=l(h);if(o.mask&f){o=o.children[d(o.mask,f)],s+=te;break}return e}case pe:{if(o=o.children[i(s,t)],o){s+=te;break}return e}default:return e;}}function q(e,t,r){return O(e,r._config.hash(t),t,r)}function M(e,t,r){return O(void 0,e,t,r)}function x(e,t,r){return O(ie,e,t,r)!==ie}function I(e,t){return x(t._config.hash(e),e,t)}function A(e,t){return e===t}function T(e){return e&&!!u(e._root)}function L(e,t,r,a){var o={value:a._size},s=a._root._modify(a._editable?a._edit:NaN,a._config.keyEq,0,e,t,r,o);return a.setTree(s,o.value)}function j(e,t,r){return L(e,r._config.hash(t),t,r)}function D(e,t,r,o){return L(a(r),e,t,o)}function z(e,t,r){return D(r._config.hash(e),e,t,r)}function F(e,t,r){return L(ue,e,t,r)}function B(e,t){return F(t._config.hash(e),e,t)}function N(e){return new fe(e._editable+1,e._edit+1,e._config,e._root,e._size)}function w(e){return e._editable=e._editable&&e._editable-1,e}function U(e,t){var r=N(t);return e(r),w(r)}function Q(e){return e&&H(e[0],e[1],e[2],e[3],e[4])}function H(e,t,r,a,o){for(;r<e;){var s=t[r++];if(s&&!u(s))return G(s,a,[e,t,r,a,o])}return Q(o)}function G(e,t,r){switch(e.type){case le:return{value:t(e),rest:r};case de:case pe:case ne:var a=e.children;return H(a.length,a,0,t,r);default:return Q(r);}}function K(e,t){return new he(G(e._root,t))}function V(e){return[e.key,e.value]}function $(e){return K(e,V)}function Y(e){return e.key}function J(e){return K(e,Y)}function W(e){return e.value}function X(e){return K(e,W)}function Z(e,t,r){var a=r._root;if(a.type===le)return e(t,a.value,a.key);for(var o=[a.children],s;s=o.pop();)for(var l=0,i=s.length,d;l<i;)d=s[l++],d&&d.type&&(d.type===le?t=e(t,d.value,d.key):o.push(d.children));return t}function ee(e,t){return Z(function(r,a,o){return e(a,o,t)},null,t)}Object.defineProperty(t,'__esModule',{value:!0});var te=5,re=32,ae=re-1,oe=re/2,se=re/4,ie={},le=1,de=2,ne=3,pe=4,ce={__hamt_isEmpty:!0,_modify:function(e,t,r,a,o,s,i){var l=a();return l===ie?ce:(++i.value,y(e,o,s,l))}};var ue=a(ie);var ye={done:!0};var he=t.HAMTMapIterator=function(){function e(t){babelHelpers.classCallCheck(this,e),this[Symbol.iterator]=function(){return this},this.v=t}return babelHelpers.createClass(e,[{key:'next',value:function(){if(!this.v)return ye;var e=this.v;return this.v=Q(e.rest),e}}]),e}(),fe=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ce,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;babelHelpers.classCallCheck(this,e),this.isEmpty=function(){return T(this)},this[Symbol.iterator]=function(){return $(this)},this._editable=t,this._edit=r,this._config={keyEq:a&&a.keyEq||A,hash:a&&a.hash||o},this._root=s,this._size=i}return babelHelpers.createClass(e,[{key:'setTree',value:function(t,r){return this._editable?(this._root=t,this._size=r,this):t===this._root?this:new e(this._editable,this._edit,this._config,t,r)}},{key:'tryGetHash',value:function(e,t,r){return O(e,t,r,this)}},{key:'tryGet',value:function(e,t){return q(e,t,this)}},{key:'getHash',value:function(e,t){return M(e,t,this)}},{key:'get',value:function(e,t){return q(t,e,this)}},{key:'hasHash',value:function(e,t){return x(e,t,this)}},{key:'has',value:function(e){return I(e,this)}},{key:'modifyHash',value:function(e,t,r){return L(r,e,t,this)}},{key:'modify',value:function(e,t){return j(t,e,this)}},{key:'setHash',value:function(e,t,r){return D(e,t,r,this)}},{key:'set',value:function(e,t){return z(e,t,this)}},{key:'deleteHash',value:function(e,t){return F(e,t,this)}},{key:'removeHash',value:function(e,t){return F(e,t,this)}},{key:'remove',value:function(e){return B(e,this)}},{key:'beginMutation',value:function(){return N(this)}},{key:'endMutation',value:function(){return w(this)}},{key:'mutate',value:function(e){return U(e,this)}},{key:'entries',value:function(){return $(this)}},{key:'keys',value:function(){return J(this)}},{key:'values',value:function(){return X(this)}},{key:'fold',value:function(e,t){return Z(e,t,this)}},{key:'forEach',value:function(e){return ee(e,this)}},{key:'size',get:function(){return this._size}}]),e}();t['default']=fe},function(e,t,r){'use strict';function a(e){var t={};return e&&Object.keys(e).forEach(function(r){var a=e[r];t[r]=a instanceof d['default']?new d['default'](a):a}),t}Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var o=r(0),s=r(1),i=r(12),l=r(24),d=babelHelpers.interopRequireDefault(l),n=function(){function e(t,r){babelHelpers.classCallCheck(this,e),this._cache=t,this.reset(r)}return babelHelpers.createClass(e,[{key:'reset',value:function(e){var t={};Object.keys(this._cache.schema.models).forEach(function(r){var a=e&&e._relationships[r];t[r]=new i.ImmutableMap(a)}),this._relationships=t}},{key:'upgrade',value:function(){var e=this;Object.keys(this._cache.schema.models).forEach(function(t){e._relationships[t]||(e._relationships[t]=new i.ImmutableMap)})}},{key:'relationshipExists',value:function(e,t,r){var a=this._relationships[e.type].get(e.id);if(a){var o=a[t];if(o)return o instanceof d['default']?o.has(r):(0,s.equalRecordIdentities)(r,o)}return!r}},{key:'relatedRecord',value:function(e,t){var r=this._relationships[e.type].get(e.id);if(r)return r[t]}},{key:'relatedRecords',value:function(e,t){var r=this._relationships[e.type].get(e.id),a=r&&r[t];if(a)return Array.from(a.values)}},{key:'relatedRecordsMap',value:function(e,t){var r=this._relationships[e.type].get(e.id);if(r)return r[t]}},{key:'relatedRecordsMatch',value:function(e,t,r){var a=this.relatedRecordsMap(e,t);if(a){var o=new d['default'];return r.forEach(function(e){return o.add(e)}),a.equals(o)}return 0===r.length}},{key:'addRecord',value:function(e){if(e.relationships){var t={};Object.keys(e.relationships).forEach(function(r){var a=e.relationships[r];if(void 0!==a.data)if((0,o.isArray)(a.data)){var s=t[r]=new d['default'];a.data.forEach(function(e){return s.add(e)})}else t[r]=a.data}),this._relationships[e.type].set(e.id,t)}}},{key:'replaceRecord',value:function(e){this.addRecord(e)}},{key:'clearRecord',value:function(e){this._relationships[e.type].remove(e.id)}},{key:'addToRelatedRecords',value:function(e,t,r){var o=this._relationships[e.type].get(e.id),s=o?a(o):{},i=s[t];i||(i=s[t]=new d['default']),i.add(r),this._relationships[e.type].set(e.id,s)}},{key:'removeFromRelatedRecords',value:function(e,t,r){var o=this._relationships[e.type].get(e.id);if(o&&o[t]){var s=a(o),i=s[t];i.remove(r),this._relationships[e.type].set(e.id,s)}}},{key:'replaceRelatedRecords',value:function(e,t,r){var o=this._relationships[e.type].get(e.id),s=o?a(o):{},i=s[t];i||(i=s[t]=new d['default']),r.forEach(function(e){return i.add(e)}),this._relationships[e.type].set(e.id,s)}},{key:'replaceRelatedRecord',value:function(e,t,r){var o=this._relationships[e.type].get(e.id);if(o&&o[t]||r){var s=o?a(o):{};s[t]=r,this._relationships[e.type].set(e.id,s)}}}]),e}();t['default']=n},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t['default']=void 0;var a=r(0),o=r(1),s=r(12),i=function(){function e(t,r){babelHelpers.classCallCheck(this,e),this._cache=t,this.reset(r)}return babelHelpers.createClass(e,[{key:'reset',value:function(e){var t={};Object.keys(this._cache.schema.models).forEach(function(r){var a=e&&e._relationships[r];t[r]=new s.ImmutableMap(a)}),this._relationships=t}},{key:'upgrade',value:function(){var e=this;Object.keys(this._cache.schema.models).forEach(function(t){e._relationships[t]||(e._relationships[t]=new s.ImmutableMap)})}},{key:'all',value:function(e){return this._relationships[e.type].get(e.id)||[]}},{key:'recordAdded',value:function(e){var t=this,r=e.relationships,s=(0,o.cloneRecordIdentity)(e);r&&Object.keys(r).forEach(function(e){var o=r[e]&&r[e].data;if(o)if((0,a.isArray)(o)){o.forEach(function(r){t.add(r,{record:s,relationship:e})})}else{t.add(o,{record:s,relationship:e})}})}},{key:'recordRemoved',value:function(e){var t=this,r=this._cache.records(e.type).get(e.id),o=r&&r.relationships;o&&Object.keys(o).forEach(function(r){var s=o[r]&&o[r].data;if(s)if((0,a.isArray)(s)){s.forEach(function(a){t.remove(a,{record:e,relationship:r})})}else{t.remove(s,{record:e,relationship:r})}}),this._relationships[e.type].remove(e.id)}},{key:'relatedRecordAdded',value:function(e,t,r){if(r){var a=this._cache.schema.getModel(e.type).relationships[t];if(a.inverse){var s=(0,o.cloneRecordIdentity)(e);this.add(r,{record:s,relationship:t})}}}},{key:'relatedRecordsAdded',value:function(e,t,r){var a=this;if(r&&0<r.length){var s=this._cache.schema.getModel(e.type).relationships[t];if(s.inverse){var i=(0,o.cloneRecordIdentity)(e);r.forEach(function(e){a.add(e,{record:i,relationship:t})})}}}},{key:'relatedRecordRemoved',value:function(e,t,r){var o=this._cache.schema.getModel(e.type).relationships[t];if(o.inverse){if(void 0===r){var s=this._cache.records(e.type).get(e.id);r=s&&(0,a.deepGet)(s,['relationships',t,'data'])}r&&this.remove(r,{record:e,relationship:t})}}},{key:'relatedRecordsRemoved',value:function(e,t,r){var o=this,s=this._cache.schema.getModel(e.type).relationships[t];if(s.inverse){if(void 0===r){var i=this._cache.records(e.type).get(e.id);r=i&&(0,a.deepGet)(i,['relationships',t,'data'])}r&&r.forEach(function(r){return o.remove(r,{record:e,relationship:t})})}}},{key:'add',value:function(e,t){var r=this._relationships[e.type].get(e.id);r=r?(0,a.clone)(r):[],r.push(t),this._relationships[e.type].set(e.id,r)}},{key:'remove',value:function(e,t){var r=this._relationships[e.type].get(e.id);if(r){var a=r.filter(function(e){return e.record.type!==t.record.type||e.record.id!==t.record.id||e.relationship!==t.relationship});this._relationships[e.type].set(e.id,a)}}}]),e}();t['default']=i},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.LogTruncationStrategy=void 0;var a=r(8),o=r(1),l=babelHelpers.interopRequireDefault(o),s=t.LogTruncationStrategy=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return babelHelpers.classCallCheck(this,t),e.name=e.name||'log-truncation',babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'activate',value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'activate',this).call(this,e,a).then(function(){return r._reifySources()}).then(function(){r._transformListeners={},r._sources.forEach(function(e){return r._activateSource(e)})})}},{key:'deactivate',value:function(){var e=this;return babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'deactivate',this).call(this).then(function(){e._sources.forEach(function(t){return e._deactivateSource(t)}),e._transformListeners=null})}},{key:'_reifySources',value:function(){return this._sources.reduce(function(e,t){return e.then(function(){return t.transformLog.reified})},l['default'].Promise.resolve())}},{key:'_review',value:function(e,t){var r=this._sources,a=!0;if(1<r.length)for(var o=0,i;o<r.length;o++)if(i=r[o],i!==e&&!i.transformLog.contains(t)){a=!1;break}return a?this._truncateSources(t,0):l['default'].Promise.resolve()}},{key:'_truncateSources',value:function(e,t){return this._sources.reduce(function(r,a){return r.then(function(){return a.transformLog.truncate(e,t)})},l['default'].Promise.resolve())}},{key:'_activateSource',value:function(e){var t=this,r=this._transformListeners[e.name]=function(r){return t._review(e,r.id)};e.on('transform',r)}},{key:'_deactivateSource',value:function(e){var t=this._transformListeners[e.name];e.off('transform',t),delete this._transformListeners[e.name]}}]),t}(a.Strategy)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.EventLoggingStrategy=void 0;var a=r(27),o=r(8),s=r(1),i=r(0),l=t.EventLoggingStrategy=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,t),e.name=e.name||'event-logging';var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._events=e.events,r._interfaces=e.interfaces,r._logPrefix=e.logPrefix||'[source-event]',r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'activate',value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'activate',this).call(this,e,a).then(function(){r._eventListeners={},r._sources.forEach(function(e){return r._activateSource(e)})})}},{key:'deactivate',value:function(){var e=this;return babelHelpers.get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'deactivate',this).call(this).then(function(){e._sources.forEach(function(t){return e._deactivateSource(t)}),e._eventListeners=null})}},{key:'_activateSource',value:function(e){var t=this;this._sourceEvents(e).forEach(function(r){t._addListener(e,r)})}},{key:'_deactivateSource',value:function(e){var t=this;this._sourceEvents(e).forEach(function(r){t._removeListener(e,r)})}},{key:'_sourceEvents',value:function(e){var t=this;if(this._events)return this._events;var r=[],a=this._interfaces||this._sourceInterfaces(e);return a.forEach(function(e){Array.prototype.push.apply(r,t._interfaceEvents(e))}),r}},{key:'_sourceInterfaces',value:function(e){var t=['transformable'];return(0,s.isPullable)(e)&&t.push('pullable'),(0,s.isPushable)(e)&&t.push('pushable'),(0,s.isQueryable)(e)&&t.push('queryable'),(0,s.isSyncable)(e)&&t.push('syncable'),(0,s.isUpdatable)(e)&&t.push('updatable'),t}},{key:'_interfaceEvents',value:function(e){if(this._logLevel===a.LogLevel.Info)switch(e){case'pullable':return['beforePull','pull','pullFail'];case'pushable':return['beforePush','push','pushFail'];case'queryable':return['beforeQuery','query','queryFail'];case'updatable':return['beforeUpdate','update','updateFail'];case'syncable':return['beforeSync','sync','syncFail'];case'transformable':return['transform'];}else if(this._logLevel>a.LogLevel.None)switch(e){case'pullable':return['pullFail'];case'pushable':return['pushFail'];case'queryable':return['queryFail'];case'syncable':return['syncFail'];case'updatable':return['updateFail'];}}},{key:'_addListener',value:function(e,t){var r=this._generateListener(e,t);(0,i.deepSet)(this._eventListeners,[e.name,t],r),e.on(t,r,this)}},{key:'_removeListener',value:function(e,t){var r=(0,i.deepGet)(this._eventListeners,[e.name,t]);e.off(t,r,this),this._eventListeners[e.name][t]=null}},{key:'_generateListener',value:function(e,t){var r=this;return function(){for(var a=arguments.length,o=Array(a),s=0,i;s<a;s++)o[s]=arguments[s];(i=console).log.apply(i,[r._logPrefix,e.name,t].concat(o))}}}]),t}(o.Strategy)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.RequestStrategy=void 0;var a=r(13),o=t.RequestStrategy=function(e){function t(e){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return babelHelpers.inherits(t,e),t}(a.ConnectionStrategy)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.SyncStrategy=void 0;var a=r(13),o=r(0),s=t.SyncStrategy=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=e;return(0,o.assert)('A `source` must be specified for a SyncStrategy',!!r.source),(0,o.assert)('A `target` must be specified for a SyncStrategy',!!r.target),(0,o.assert)('`source` should be a Source name specified as a string','string'==typeof r.source),(0,o.assert)('`target` should be a Source name specified as a string','string'==typeof r.target),r.on=r.on||'transform',r.action=r.action||'sync',babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r))}return babelHelpers.inherits(t,e),t}(a.ConnectionStrategy)},function(e,t,r){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function o(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'===('undefined'==typeof t?'undefined':babelHelpers['typeof'](t))||'function'==typeof t)?t:e}function s(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof t?'undefined':babelHelpers['typeof'](t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,'__esModule',{value:!0}),t.DrupalSerializerClass=void 0;var i=r(65),l=babelHelpers.interopRequireDefault(i),d=function(){function e(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=t.DrupalSerializerClass=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),d(t,[{key:'resourceRelationship',value:function(e,t){return t}},{key:'resourceAttribute',value:function(e,t){return t}},{key:'recordType',value:function(e){return e}},{key:'recordAttribute',value:function(e,t){return t}},{key:'recordRelationship',value:function(e,t){return t}}]),t}(i.JSONAPISerializer),p=function(e){function t(e){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Object.assign({},e,{SerializerClass:n})))}return s(t,e),d(t,[{key:'resourcePath',value:function(e,t){var r=e.split('--');if(t){var a=this.serializer.resourceId(e,t);a&&r.push(a)}return r.join('/')}}]),t}(l['default']);t['default']=p},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(66);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(a)['default']}});var o=r(28);Object.defineProperty(t,'JSONAPISerializer',{enumerable:!0,get:function(){return babelHelpers.interopRequireDefault(o)['default']}})},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(1),o=babelHelpers.interopRequireDefault(a),s=r(0),i=r(28),l=babelHelpers.interopRequireDefault(i),d=r(67),n=r(68),p=r(69),c=r(70);'undefined'!=typeof o['default'].globals.fetch&&o['default'].fetch===void 0&&(o['default'].fetch=o['default'].globals.fetch);var u=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,t),(0,s.assert)('JSONAPISource\'s `schema` must be specified in `settings.schema` constructor argument',!!e.schema),(0,s.assert)('JSONAPISource requires Orbit.Promise be defined',o['default'].Promise),(0,s.assert)('JSONAPISource requires Orbit.fetch be defined',o['default'].fetch),e.name=e.name||'jsonapi';var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.namespace=e.namespace,r.host=e.host,r.defaultFetchHeaders=e.defaultFetchHeaders||{Accept:'application/vnd.api+json'},r.defaultFetchTimeout=e.defaultFetchTimeout||5e3,r.maxRequestsPerTransform=e.maxRequestsPerTransform;var a=e.SerializerClass||l['default'];return r.serializer=new a({schema:e.schema,keyMap:e.keyMap}),r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:'_push',value:function(e){var t=this,r=(0,p.getTransformRequests)(this,e);return this.maxRequestsPerTransform&&r.length>this.maxRequestsPerTransform?o['default'].Promise.resolve().then(function(){throw new a.TransformNotAllowed('This transform requires '+r.length+' requests, which exceeds the specified limit of '+t.maxRequestsPerTransform+' requests per transform.',e)}):this._processRequests(r,p.TransformRequestProcessors).then(function(t){return t.unshift(e),t})}},{key:'_pull',value:function(e){var t=n.PullOperators[e.expression.op];if(!t)throw new Error('JSONAPISource does not support the `${query.expression.op}` operator for queries.');return t(this,e)}},{key:'fetch',value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r.headers=r.headers||this.defaultFetchHeaders;var i=r.headers,l=r.method||'GET',n=r.timeout||this.defaultFetchTimeout;return r.timeout&&delete r.timeout,r.json&&((0,s.assert)('`json` and `body` can\'t both be set for fetch requests.',!r.body),r.body=JSON.stringify(r.json),delete r.json),r.body&&'GET'!==l&&(i['Content-Type']=i['Content-Type']||'application/vnd.api+json; charset=utf-8'),r.params&&(e+=-1===e.indexOf('?')?'?':'&',e+=(0,d.encodeQueryParams)(r.params),delete r.params),n?new o['default'].Promise(function(s,i){var l=o['default'].globals.setTimeout(function(){d=!0,i(new a.NetworkError('No fetch response within '+n+'ms.'))},n),d;o['default'].fetch(e,r)['catch'](function(r){if(o['default'].globals.clearTimeout(l),!d)return t.handleFetchError(r)}).then(function(e){if(o['default'].globals.clearTimeout(l),!d)return t.handleFetchResponse(e)}).then(s,i)}):o['default'].fetch(e,r)['catch'](function(r){return t.handleFetchError(r)}).then(function(e){return t.handleFetchResponse(e)})}},{key:'handleFetchResponse',value:function(e){var t=this;if(201===e.status){if(this.responseHasContent(e))return e.json();throw new c.InvalidServerResponse('Server responses with a '+e.status+' status should return content with a Content-Type that includes \'application/vnd.api+json\'.')}else{if(!(200<=e.status&&300>e.status))return this.responseHasContent(e)?e.json().then(function(r){return t.handleFetchResponseError(e,r)}):this.handleFetchResponseError(e);if(this.responseHasContent(e))return e.json()}return o['default'].Promise.resolve()}},{key:'handleFetchResponseError',value:function(e,t){var r;return r=400<=e.status&&500>e.status?new a.ClientError(e.statusText):new a.ServerError(e.statusText),r.response=e,r.data=t,o['default'].Promise.reject(r)}},{key:'handleFetchError',value:function(t){var e=new a.NetworkError(t);return o['default'].Promise.reject(e)}},{key:'responseHasContent',value:function(e){var t=e.headers.get('Content-Type');return t&&-1<t.indexOf('application/vnd.api+json')}},{key:'resourceNamespace',value:function(){return this.namespace}},{key:'resourceHost',value:function(){return this.host}},{key:'resourcePath',value:function(e,t){var r=[this.serializer.resourceType(e)];if(t){var a=this.serializer.resourceId(e,t);a&&r.push(a)}return r.join('/')}},{key:'resourceURL',value:function(e,t){var r=this.resourceHost(e),a=this.resourceNamespace(e),o=[];return r&&o.push(r),a&&o.push(a),o.push(this.resourcePath(e,t)),r||o.unshift(''),o.join('/')}},{key:'resourceRelationshipURL',value:function(e,t,r){return this.resourceURL(e,t)+'/relationships/'+this.serializer.resourceRelationship(e,r)}},{key:'relatedResourceURL',value:function(e,t,r){return this.resourceURL(e,t)+'/'+this.serializer.resourceRelationship(e,r)}},{key:'_processRequests',value:function(e,t){var r=this,a=[],s=o['default'].Promise.resolve();return e.forEach(function(e){var o=t[e.op];s=s.then(function(){return o(r,e).then(function(e){e&&Array.prototype.push.apply(a,e)})})}),s.then(function(){return a})}}]),t}(a.Source);u=function(e,t,a,o){var s=arguments.length,l=3>s?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o,r;if('object'===('undefined'==typeof Reflect?'undefined':babelHelpers['typeof'](Reflect))&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var d=e.length-1;0<=d;d--)(r=e[d])&&(l=(3>s?r(l):3<s?r(t,a,l):r(t,a))||l);return 3<s&&l&&Object.defineProperty(t,a,l),l}([a.pullable,a.pushable],u),t['default']=u},function(e,t){'use strict';function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a=[];return Object.keys(e).forEach(function(o){if(e.hasOwnProperty(o)){var s=t.slice();s.push(o),'object'===babelHelpers['typeof'](e[o])?Array.prototype.push.apply(a,r(e[o],s)):a.push({path:s,val:e[o]})}}),a}Object.defineProperty(t,'__esModule',{value:!0}),t.encodeQueryParams=function(e){return r(e).map(function(e){if(1===e.path.length)e.path=e.path[0];else{var t=e.path[0],r=e.path.slice(1);e.path=t+'['+r.join('][')+']'}return e}).map(function(e){return encodeURIComponent(e.path)+'='+encodeURIComponent(e.val)}).join('&')}},function(e,t,r){'use strict';function a(e,t){var r=e.serializer.deserializeDocument(t),a=(0,l.toArray)(r.data);r.included&&Array.prototype.push.apply(a,r.included);var o=a.map(function(e){return{op:'replaceRecord',record:e}});return[(0,d.buildTransform)(o)]}function o(e,t){var r={},a=(0,l.deepGet)(t,['options','sources',e.name])||{};return a.include&&(r.include=a.include.join(',')),a.timeout&&(r.timeout=a.timeout),r}function s(e,t){var r={};return t.forEach(function(t){if('attribute'===t.kind&&'equal'===t.op){var a=t,o=e.serializer.resourceAttribute(null,a.attribute);r[o]=a.value}else throw new d.QueryExpressionParseError('Filter operation ${specifier.op} not recognized for JSONAPISource.',t)}),r}function i(e,t){return t.map(function(t){if('attribute'===t.kind){var r=e.serializer.resourceAttribute(null,t.attribute);return('descending'===t.order?'-':'')+r}throw new d.QueryExpressionParseError('Sort specifier ${sortSpecifier.kind} not recognized for JSONAPISource.',t)}).join(',')}Object.defineProperty(t,'__esModule',{value:!0}),t.PullOperators=void 0;var l=r(0),d=r(1),n=r(29),p=t.PullOperators={findRecord:function(e,t){var r=t.expression,s=r.record,i=o(e,t),l=(0,n.buildFetchSettings)(i);return e.fetch(e.resourceURL(s.type,s.id),l).then(function(t){return a(e,t)})},findRecords:function(e,t){var r=t.expression,d=r.type,p={};r.filter&&(p.filter=s(e,r.filter)),r.sort&&(p.sort=i(e,r.sort)),r.page&&(p.page=r.page),p=(0,l.merge)(p,o(e,t));var c=(0,n.buildFetchSettings)(p);return e.fetch(e.resourceURL(d),c).then(function(t){return a(e,t)})},findRelatedRecord:function(e,t){var r=t.expression,s=r.record,i=r.relationship,l=o(e,t),d=(0,n.buildFetchSettings)(l);return e.fetch(e.relatedResourceURL(s.type,s.id,i),d).then(function(t){return a(e,t)})},findRelatedRecords:function(e,t){var r=t.expression,s=r.record,i=r.relationship,l=o(e,t),d=(0,n.buildFetchSettings)(l);return e.fetch(e.relatedResourceURL(s.type,s.id,i),d).then(function(t){return a(e,t)})}}},function(e,t,r){'use strict';function a(e,t,r){(0,l.deepSet)(e,['attributes',t],r)}function o(e,t,r){(0,l.deepSet)(e,['relationships',t,'data'],r?(0,i.cloneRecordIdentity)(r):null)}function s(e,t,r){(0,l.deepSet)(e,['relationships',t,'data'],r.map(function(e){return(0,i.cloneRecordIdentity)(e)}))}Object.defineProperty(t,'__esModule',{value:!0}),t.TransformRequestProcessors=void 0,t.getTransformRequests=function(e,t){var r=t.operations,l=[],d=t.options&&t.options.sources&&t.options.sources[e.name]||{},n;return t.operations.forEach(function(e){var t=!0,r;n&&(0,i.equalRecordIdentities)(n.record,e.record)&&('removeRecord'===e.op?(t=!1,'removeRecord'!==n.op&&(n=null,l.pop())):'addRecord'===n.op||'replaceRecord'===n.op?'replaceAttribute'===e.op?(t=!1,a(n.record,e.attribute,e.value)):'replaceRelatedRecord'===e.op?(t=!1,o(n.record,e.relationship,e.relatedRecord)):'replaceRelatedRecords'===e.op&&(t=!1,s(n.record,e.relationship,e.relatedRecords)):'addToRelatedRecords'===n.op&&'addToRelatedRecords'===e.op&&n.relationship===e.relationship&&(t=!1,n.relatedRecords.push((0,i.cloneRecordIdentity)(e.relatedRecord)))),t&&(r=p[e.op](e)),r&&(d.include&&(r.include=d.include.join(',')),d.timeout&&(r.timeout=d.timeout),l.push(r),n=r)}),l};var i=r(1),l=r(0),d=r(29),n=t.TransformRequestProcessors={addRecord:function(e,t){var r=e.serializer,a=t.record,o=r.serializeDocument(a),s=(0,d.buildFetchSettings)(t,{method:'POST',json:o});return e.fetch(e.resourceURL(a.type),s).then(function(e){var t=r.deserializeDocument(e),o=t.data,s=(0,i.recordDiffs)(a,o);if(0<s.length)return[(0,i.buildTransform)(s)]})},removeRecord:function(e,t){var r=t.record,a=r.type,o=r.id,s=(0,d.buildFetchSettings)(t,{method:'DELETE'});return e.fetch(e.resourceURL(a,o),s).then(function(){return[]})},replaceRecord:function(e,t){var r=t.record,a=r.type,o=r.id,s=e.serializer.serializeDocument(r),i=(0,d.buildFetchSettings)(t,{method:'PATCH',json:s});return e.fetch(e.resourceURL(a,o),i).then(function(){return[]})},addToRelatedRecords:function(e,t){var r=t.record,a=r.type,o=r.id,s=t.relationship,i={data:t.relatedRecords.map(function(t){return e.serializer.resourceIdentity(t)})},l=(0,d.buildFetchSettings)(t,{method:'POST',json:i});return e.fetch(e.resourceRelationshipURL(a,o,s),l).then(function(){return[]})},removeFromRelatedRecords:function(e,t){var r=t.record,a=r.type,o=r.id,s=t.relationship,i={data:t.relatedRecords.map(function(t){return e.serializer.resourceIdentity(t)})},l=(0,d.buildFetchSettings)(t,{method:'DELETE',json:i});return e.fetch(e.resourceRelationshipURL(a,o,s),l).then(function(){return[]})},replaceRelatedRecord:function(e,t){var r=t.record,a=r.type,o=r.id,s=t.relationship,i=t.relatedRecord,l={data:i?e.serializer.resourceIdentity(i):null},n=(0,d.buildFetchSettings)(t,{method:'PATCH',json:l});return e.fetch(e.resourceRelationshipURL(a,o,s),n).then(function(){return[]})},replaceRelatedRecords:function(e,t){var r=t.record,a=r.type,o=r.id,s=t.relationship,i=t.relatedRecords,l={data:i.map(function(t){return e.serializer.resourceIdentity(t)})},n=(0,d.buildFetchSettings)(t,{method:'PATCH',json:l});return e.fetch(e.resourceRelationshipURL(a,o,s),n).then(function(){return[]})}},p={addRecord:function(e){return{op:'addRecord',record:(0,l.clone)(e.record)}},removeRecord:function(e){return{op:'removeRecord',record:(0,i.cloneRecordIdentity)(e.record)}},replaceAttribute:function(e){var t=(0,i.cloneRecordIdentity)(e.record);return a(t,e.attribute,e.value),{op:'replaceRecord',record:t}},replaceRecord:function(e){return{op:'replaceRecord',record:(0,l.clone)(e.record)}},addToRelatedRecords:function(e){return{op:'addToRelatedRecords',record:(0,i.cloneRecordIdentity)(e.record),relationship:e.relationship,relatedRecords:[(0,i.cloneRecordIdentity)(e.relatedRecord)]}},removeFromRelatedRecords:function(e){return{op:'removeFromRelatedRecords',record:(0,i.cloneRecordIdentity)(e.record),relationship:e.relationship,relatedRecords:[(0,i.cloneRecordIdentity)(e.relatedRecord)]}},replaceRelatedRecord:function(e){var t={type:e.record.type,id:e.record.id};return(0,l.deepSet)(t,['relationships',e.relationship,'data'],e.relatedRecord),{op:'replaceRecord',record:t}},replaceRelatedRecords:function(e){var t=(0,i.cloneRecordIdentity)(e.record);return(0,l.deepSet)(t,['relationships',e.relationship,'data'],e.relatedRecords),{op:'replaceRecord',record:t}}}},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.InvalidServerResponse=void 0;var a=r(2),o=t.InvalidServerResponse=function(e){function t(e){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,'Invalid server response: '+e));return r.response=e,r}return babelHelpers.inherits(t,e),t}(a.Exception)},function(e,t,r){'use strict';r(72),e.exports=self.fetch.bind(self)},function(){'use strict';(function(e){function t(e){if('string'!=typeof e&&(e+=''),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError('Invalid character in header field name');return e.toLowerCase()}function r(e){return'string'!=typeof e&&(e+=''),e}function a(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function s(e){return e.bodyUsed?Promise.reject(new TypeError('Already read')):void(e.bodyUsed=!0)}function i(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function l(e){var t=new FileReader,r=i(t);return t.readAsArrayBuffer(e),r}function d(e){var t=new FileReader,r=i(t);return t.readAsText(e),r}function n(e){for(var t=new Uint8Array(e),r=Array(t.length),a=0;a<t.length;a++)r[a]=String.fromCharCode(t[a]);return r.join('')}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function c(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,!e)this._bodyText='';else if('string'==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(m.arrayBuffer&&m.blob&&v(e))this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(m.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||R(e)))this._bodyArrayBuffer=p(e);else throw new Error('unsupported BodyInit type');this.headers.get('content-type')||('string'==typeof e?this.headers.set('content-type','text/plain;charset=UTF-8'):this._bodyBlob&&this._bodyBlob.type?this.headers.set('content-type',this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set('content-type','application/x-www-form-urlencoded;charset=UTF-8'))},m.blob&&(this.blob=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error('could not read FormData body as blob');else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?s(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return d(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(n(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error('could not read FormData body as text');else return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(e){var t=e.toUpperCase();return-1<b.indexOf(t)?t:e}function y(e,t){t=t||{};var r=t.body;if(e instanceof y){if(e.bodyUsed)throw new TypeError('Already read');this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=e+'';if(this.credentials=t.credentials||this.credentials||'omit',(t.headers||!this.headers)&&(this.headers=new o(t.headers)),this.method=u(t.method||this.method||'GET'),this.mode=t.mode||this.mode||null,this.referrer=null,('GET'===this.method||'HEAD'===this.method)&&r)throw new TypeError('Body not allowed for GET or HEAD requests');this._initBody(r)}function h(e){var t=new FormData;return e.trim().split('&').forEach(function(e){if(e){var r=e.split('='),a=r.shift().replace(/\+/g,' '),o=r.join('=').replace(/\+/g,' ');t.append(decodeURIComponent(a),decodeURIComponent(o))}}),t}function f(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var r=e.split(':'),a=r.shift().trim();if(a){var o=r.join(':').trim();t.append(a,o)}}),t}function _(e,t){t||(t={}),this.type='default',this.status='status'in t?t.status:200,this.ok=200<=this.status&&300>this.status,this.statusText='statusText'in t?t.statusText:'OK',this.headers=new o(t.headers),this.url=t.url||'',this._initBody(e)}if(!e.fetch){var m={searchParams:'URLSearchParams'in e,iterable:'Symbol'in e&&'iterator'in Symbol,blob:'FileReader'in e&&'Blob'in e&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:'FormData'in e,arrayBuffer:'ArrayBuffer'in e};if(m.arrayBuffer)var g=['[object Int8Array]','[object Uint8Array]','[object Uint8ClampedArray]','[object Int16Array]','[object Uint16Array]','[object Int32Array]','[object Uint32Array]','[object Float32Array]','[object Float64Array]'],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},R=ArrayBuffer.isView||function(e){return e&&-1<g.indexOf(Object.prototype.toString.call(e))};o.prototype.append=function(e,a){e=t(e),a=r(a);var o=this.map[e];this.map[e]=o?o+','+a:a},o.prototype['delete']=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,a){this.map[t(e)]=r(a)},o.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),a(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),a(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),a(e)},m.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var b=['DELETE','GET','HEAD','OPTIONS','POST','PUT'];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},c.call(y.prototype),c.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:''});return e.type='error',e};var k=[301,302,303,307,308];_.redirect=function(e,t){if(-1===k.indexOf(t))throw new RangeError('Invalid status code');return new _(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=y,e.Response=_,e.fetch=function(e,t){return new Promise(function(r,a){var o=new y(e,t),s=new XMLHttpRequest;s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:f(s.getAllResponseHeaders()||'')};e.url='responseURL'in s?s.responseURL:e.headers.get('X-Request-URL');var t='response'in s?s.response:s.responseText;r(new _(t,e))},s.onerror=function(){a(new TypeError('Network request failed'))},s.ontimeout=function(){a(new TypeError('Network request failed'))},s.open(o.method,o.url,!0),'include'===o.credentials&&(s.withCredentials=!0),'responseType'in s&&m.blob&&(s.responseType='blob'),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send('undefined'==typeof o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}})('undefined'==typeof self?void 0:self)},function(e,t,r){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=r(1),o=r(74),s=babelHelpers.interopRequireDefault(o),i=new a.Schema(s['default']);t['default']=i},function(e){e.exports={models:{"evaluation_criteria--evaluation_criteria":{attributes:{id:{type:'integer'},uuid:{type:'string'},text:{type:'string'},evaluation:{type:'integer'},status:{type:'boolean'},created:{type:'number'},changed:{type:'number'}},relationships:{user_id:{type:'hasOne',model:'user--user'}}},"file--file":{attributes:{fid:{type:'integer'},uuid:{type:'string'},filename:{type:'string'},uri:{type:'uri'},filemime:{type:'string'},filesize:{type:'integer'},status:{type:'boolean'},created:{type:'number'},changed:{type:'number'},url:{type:'string'}},relationships:{uid:{type:'hasOne',model:'user--user'}}},"event_recurrence--event_recurrence":{attributes:{id:{type:'integer'},uuid:{type:'string'},created:{type:'number'},changed:{type:'number'}},relationships:{user_id:{type:'hasOne',model:'user--user'}}},"media--file":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'},field_media_file:{type:'hasOne',model:'file--file'}}},"media--image":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'},field_media_caption:{type:'object'},field_media_credit:{type:'object'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'},field_media_image:{type:'hasOne',model:'file--file'}}},"media--slideshow":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'},field_media_slideshow:{type:'hasMany',model:'media--image'}}},"media--web_video":{attributes:{mid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},name:{type:'string'},created:{type:'number'},changed:{type:'number'},path:{type:'object'},field_media_caption:{type:'object'},field_media_video_embed_field:{type:'string'}},relationships:{thumbnail:{type:'hasOne',model:'file--file'},uid:{type:'hasOne',model:'user--user'}}},"node--equipment":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_duration_min:{type:'string'},field_text_content:{type:'object'}},relationships:{uid:{type:'hasOne',model:'user--user'},field_equipment_type:{type:'hasOne',model:'taxonomy_term--equipment_type'},field_image_primary:{type:'hasOne',model:'media--image'}}},"node--event":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_capacity_max:{type:'integer'},field_date_time:{type:'object'},field_event_is_template:{type:'boolean'},field_has_waitlist:{type:'boolean'},field_must_register:{type:'boolean'},field_reservation_period:{type:'object'},field_text_content:{type:'object'},field_text_intro:{type:'object'},field_text_teaser:{type:'string'}},relationships:{uid:{type:'hasOne',model:'user--user'},field_event_audience:{type:'hasMany',model:'taxonomy_term--audience'},field_event_recurrence:{type:'hasOne',model:'event_recurrence--event_recurrence'},field_event_series:{type:'hasOne',model:'node--event_series'},field_event_subject_heading:{type:'hasMany',model:'taxonomy_term--lc_subject'},field_event_tags:{type:'hasMany',model:'taxonomy_term--tag'},field_event_type:{type:'hasMany',model:'taxonomy_term--event_type'},field_image_primary:{type:'hasOne',model:'media--image'},field_location:{type:'hasOne',model:'node--location'},field_room:{type:'hasOne',model:'node--room'}}},"node--event_series":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'}},relationships:{type:{type:'hasOne',model:'node_type--node_type'},uid:{type:'hasOne',model:'user--user'}}},"node--location":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_address:{type:'object'},field_affiliated:{type:'boolean'},field_contact_number:{type:'string'},field_location_hours:{type:'array'},field_map_link:{type:'object'},field_text_content:{type:'object'},field_text_intro:{type:'object'}},relationships:{type:{type:'hasOne',model:'node_type--node_type'},uid:{type:'hasOne',model:'user--user'},field_image_primary:{type:'hasOne',model:'media--image'}}},"node--room":{attributes:{nid:{type:'integer'},uuid:{type:'string'},status:{type:'boolean'},title:{type:'string'},created:{type:'number'},changed:{type:'number'},promote:{type:'boolean'},sticky:{type:'boolean'},path:{type:'object'},field_capacity_max:{type:'integer'},field_capacity_min:{type:'integer'},field_room_fees:{type:'object'},field_room_standard_equipment:{type:'array'},field_staff_use_only:{type:'boolean'},field_text_content:{type:'object'},field_text_intro:{type:'object'},field_text_teaser:{type:'string'}},relationships:{uid:{type:'hasOne',model:'user--user'},field_image_primary:{type:'hasOne',model:'media--image'},field_location:{type:'hasOne',model:'node--location'},field_room_type:{type:'hasOne',model:'taxonomy_term--room_type'}}},"taxonomy_term--audience":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--audience'}}},"taxonomy_term--equipment_type":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--equipment_type'}}},"taxonomy_term--evaluation_criteria":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'},field_evaluation:{type:'integer'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--evaluation_criteria'}}},"taxonomy_term--event_type":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'},field_examples:{type:'string'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--event_type'}}},"taxonomy_term--lc_subject":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--lc_subject'}}},"taxonomy_term--meeting_purpose":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--meeting_purpose'}}},"taxonomy_term--population_segment":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--population_segment'}}},"taxonomy_term--room_type":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--room_type'}}},"taxonomy_term--tag":{attributes:{tid:{type:'integer'},uuid:{type:'string'},name:{type:'string'},description:{type:'object'},weight:{type:'integer'},changed:{type:'number'},path:{type:'object'}},relationships:{parent:{type:'hasMany',model:'taxonomy_term--tag'}}},"user--user":{attributes:{uid:{type:'integer'},uuid:{type:'string'},preferred_langcode:{type:'object'},preferred_admin_langcode:{type:'object'},name:{type:'string'},pass:{type:'object'},mail:{type:'string'},timezone:{type:'string'},status:{type:'boolean'},created:{type:'number'},changed:{type:'number'},access:{type:'number'},login:{type:'number'},init:{type:'string'},path:{type:'object'}},relationships:{roles:{type:'hasMany',model:'user_role--user_role'}}},"node_type--node_type":{attributes:{uuid:{type:'string'},name:{type:'string'},type:{type:'string'}}},"user_role--user_role":{attributes:{uuid:{type:'string'},name:{type:'string'}}}}}}])});